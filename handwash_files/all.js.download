/*!
     * jQuery Tiny Pub/Sub - v0.6 - 1/10/2011
     * http://benalman.com/
     *
     * Copyright (c) 2010 "Cowboy" Ben Alman
     * Dual licensed under the MIT and GPL licenses.
     * http://benalman.com/about/license/
     */

//Modernizr is available under the MIT license

/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.3.0
 */

/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash include="debounce"`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */

/*! grunt-grunticon Stylesheet Loader - v2.1.6 | https://github.com/filamentgroup/grunticon | (c) 2015 Scott Jehl, Filament Group, Inc. | MIT license. */

/*!
 * jQuery-ajaxTransport-XDomainRequest - v1.0.4 - 2015-03-05
 * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest
 * Copyright (c) 2015 Jason Moon (@JSONMOON)
 * Licensed MIT (/blob/master/LICENSE.txt)
 */

define("module/bootstrappedJquery",["jquery"],function(e){return e.ajaxSetup({cache:!0}),e}),define("vendor/events/pubsub",["jquery"],function(e){var t=e({});e.eventHistory=[],e.on=function(n,o){function i(){return o.apply(this,Array.prototype.slice.call(arguments,1))}i.guid=o.guid=o.guid||(e.guid?e.guid++:e.event.guid++),t.on(n,i)},e.off=function(){t.off.apply(t,arguments)},e.emit=function(){e.eventHistory.push(arguments[0]),t.trigger.apply(t,arguments)}}),define("module/globalPubsub",["module/bootstrappedJquery","vendor/events/pubsub"],function(e){return e}),define("module/bootstrap",["config","module/bootstrappedJquery","module/globalPubsub"],function(e,t,n){return{pubsub:n,$:t,config:e,window:window}}),define("module/translator",[],function(){function e(e,o){if(!e)throw n.TRANSLATION_UNDEFINED;if(!t(e))throw n.TRANSLATION_NOT_AN_OBJECT;this.translation=e,this.locale=o||"en-GB"}var t=function(e){return"[object Object]"===Object.prototype.toString.call(e)},n={TRANSLATION_UNDEFINED:"Translator Error : Translator expects a translation object as its first parameter",TRANSLATION_NOT_AN_OBJECT:"Translator Error : Translator expects an object literal as its first parameter"};return e.prototype.get=function(e){return this.translation[e]?this.translation[e]:null},e.prototype.getLocale=function(){return this.locale},e}),define("translator",["module/translator","config","translation"],function(e,t,n){return new e(n,t.locale)}),define("module/ajaxForm/ajaxForm",["module/bootstrap","config","translator"],function(e,t,n){var o=e.$,i=function(){this.errorMessage=n.get("thereWasAProblem");var t=this;e.pubsub.on("ajaxForm:submit",function(e,n){t.submit(e,n)})};return i.prototype.submit=function(t,n){e.pubsub.emit("ajaxForm:renderWait"),o.ajax({url:n+".json",dataType:"json",type:"POST",data:t,success:function(t){var n=t.body;switch(t.reply){case"success":e.pubsub.emit("ajaxForm:success",[n]);break;case"feedback":e.pubsub.emit("ajaxForm:feedback",[n]);break;default:e.pubsub.emit("ajaxForm:error",[n])}},error:o.proxy(function(t){e.pubsub.emit("ajaxForm:error",[this.errorMessage,t])},this)})},i}),define("module/ajaxForm/ajaxFormView",["module/bootstrap","translator"],function(e,t){function n(n){this.translator=t,this.elm=e.$(n),this.url=this.elm.attr("action"),this.fields=e.$("input, textarea",this.elm),this.attach()}return n.prototype={attach:function(){var t=this;this.elm.on("submit",function(e){e.preventDefault(),t.send()});var n=function(t){var n=e.$(t).parent(),o=""!==e.$(t).val();n.toggleClass("input-has-content",o)},o=function(t){var o=t.target;if(e.$(o).prop("nodeName").match(/(INPUT|TEXTAREA)/)){var i="focus"===t.type.toLowerCase()?"add":"remove";e.$(o).parent().toggleClass("input-has-focus",i),n(o)}};return this.fields.on("focus",o),this.fields.on("blur",o),this.fields.on("keyup",function(t){var o=t.target;e.$(o).prop("nodeName").match(/(INPUT|TEXTAREA)/)&&n(o)}),e.pubsub.on("ajaxForm:success",function(n){t.elm.removeClass("feedback"),t.elm.addClass("successful-submit"),t.elm.before('<div id="successMsg"><p>'+n+'</p><button><span class="cta">'+t.translator.get("sendAnotherComment")+"</span></button></div>"),e.$("#successMsg button").on("click",function(){e.pubsub.emit("ajaxForm:showForm")})}),e.pubsub.on("ajaxForm:feedback",function(o){e.$("p.feedback",this.elm).remove(),t.elm.addClass("feedback"),e.pubsub.emit("ajaxForm:stopWait"),e.$(t.fields).each(function(t,i){var s=e.$(i).attr("name"),a=e.$(i).val().trim();void 0!==o[s]&&(e.$(i).val(a),e.$(i).parent().addClass("invalid"),n(i),e.$(i.parentNode).append('<p class="feedback">'+o[i.name]+"</p>"))})}),e.pubsub.on("ajaxForm:error",function(n,o){t.elm.removeClass("feedback"),t.elm.addClass("error"),e.pubsub.emit("ajaxForm:stopWait"),t.elm.before('<div id="errorMsg"><p>'+n+"</p><button><span>"+t.translator.get("retry")+"</span></button>"),e.$("#errorMsg button").on("click",function(){t.send()})}),e.pubsub.on("ajaxForm:showForm",function(){e.$("#"+t.elm.attr("id")+" fieldset p").remove(),t.fields.each(function(t,o){e.$(o).val(""),n(o)}),t.elm.removeClass("successful-submit").removeClass("error"),e.$("#successMsg, #errorMsg").remove()}),e.pubsub.on("ajaxForm:stopWait",function(){t.elm.removeClass("wait"),e.$(".spin",t.elm).remove()}),e.pubsub.on("ajaxForm:renderWait",function(){t.elm.addClass("wait"),e.$("fieldset",t.elm).removeClass("invalid"),e.$("#successMsg, #errorMsg").remove(),t.elm.append('<div class="spin"></div>')}),this},send:function(){var t=[];this.fields.each(function(n,o){var i=e.$(o);t.push(i.attr("name")+"="+i.val())}),e.pubsub.emit("ajaxForm:submit",[t.join("&"),this.url])}},n}),define("module/featureDetector",["config"],function(e){function t(e){var t=/forceTouchSupport=(on|off)/.exec(window.location.search);return!(!t||!t[1])&&t[1]===e}function n(e,t){return o.hasOwnProperty(t)||(o[t]=l[e+t]?l[e+t]():void 0),o[t]}var o={},i=/OS ([0-9])/,s=document.documentElement,a="modernizr",r=document.createElement(a),c=r.style,l={isIos:function(){return/(iPod|iPad|iPhone)/.test(navigator.userAgent)},isIosVersion:function(e){var t=i.exec(navigator.userAgent);return!(!t||!t[1])&&Number(t[1])>=e},isIos4:function(){return this.isIosVersion(4)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isAndroidMobile2:function(){return this.isAndroid()&&/Mobile/i.test(navigator.userAgent)&&/Android 2./.test(navigator.userAgent)},isAndroidMobile22:function(){return this.isAndroid()&&/Mobile/i.test(navigator.userAgent)&&/2.2/.test(navigator.userAgent)},isIE10:function(){return/MSIE 10/.test(navigator.userAgent)},isWindowsPhone:function(){return/Windows Phone/.test(navigator.userAgent)},isChrome:function(){return/Chrome/.test(navigator.userAgent)},canUseHistoryApi:function(){return window.history&&window.history.pushState},isContinuousPlayEnabled:function(){return!!document.getElementById("gnlContinuousPlayEnabled")||!!document.getElementById("continuous-play-enabled")},isShowingDesktopAds:function(){return!!document.getElementById("advert-post-script-load")},isOrbFig:function(){return"undefined"!=typeof orb&&"function"==typeof orb.fig},isCollectingGNLAnalytics:function(){return!!document.getElementById("gnlAnalyticsEnabled")},isDisplayingGnlAds:function(){return!!document.getElementById("gnlAdsEnabled")},isFromUK:function(){var e=void 0!==orb.fig.geo&&"function"==typeof orb.fig.geo.isUK;return this.isOrbFig()&&e?orb.fig.geo.isUK():void 0},canPlayProgressiveDownload:function(){return!("topcat"!==e.configuration.cms||this.isDesktop()||!0===e.asset.isLiveAvStream||this.isIos()&&"audio"!==e.asset.mediaType)},_contains:function(e,t){return!!~(""+e).indexOf(t)},_injectElementWithStyles:function(e,t,n,o){var i,r,c,l,u=document.createElement("div"),d=document.body,h=d||document.createElement("body");if(parseInt(n,10))for(;n--;)c=document.createElement("div"),c.id=o?o[n]:a+(n+1),u.appendChild(c);return i=["&#173;",'<style id="s',a,'">',e,"</style>"].join(""),u.id=a,(d?u:h).innerHTML+=i,h.appendChild(u),d||(h.style.background="",h.style.overflow="hidden",l=s.style.overflow,s.style.overflow="hidden",s.appendChild(h)),r=t(u,e),d?u.parentNode.removeChild(u):(h.parentNode.removeChild(h),s.style.overflow=l),!!r},_testProps:function(e,t){for(var n in e){var o=e[n];if(!this._contains(o,"-")&&void 0!==c[o])return"pfx"!==t||o}return!1},_testPropsAll:function(e,t,n){var o="Webkit Moz O ms",i=o.split(" "),s=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+i.join(s+" ")+s).split(" ");return this._testProps(a,t)},canCssColumn:function(){return!!this._testPropsAll("columnCount")},canCssTransition:function(){return!!this._testPropsAll("transition")},whichTransitionEnd:function(){var e=document.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var n in t)if(void 0!==e.style[n])return t[n]},canCssTransform:function(){return!!this._testPropsAll("transform")},canCssPreserve3d:function(){if(!this.canCssTransform())return!1;var e=!!this._testPropsAll("transformStyle");return e&&this._injectElementWithStyles("#modernizr { transform-style: preserve-3d; -webkit-transform-style: preserve-3d; -moz-transform-style: preserve-3d; -o-transform-style: preserve-3d; }",function(t,n){if(!window.getComputedStyle)return!1;var o=window.getComputedStyle(t),i="preserve-3d"===o.getPropertyValue("-webkit-transform-style"),s="preserve-3d"===o.getPropertyValue("-moz-transform-style"),a="preserve-3d"===o.getPropertyValue("-o-transform-style"),r="preserve-3d"===o.getPropertyValue("transform-style");e=r||a||s||i}),e},canCssTransform3d:function(){var e=!!this._testPropsAll("perspective");return e&&"webkitPerspective"in s.style&&this._injectElementWithStyles("@media (transform-3d), (-webkit-transform-3d) { #modernizr{ left: 9px; position: absolute; height: 3px; }}",function(t,n){e=9===t.offsetLeft&&3===t.offsetHeight}),e},canTouchEvents:function(){return"ontouchstart"in window},canSVG:function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},isDesktop:function(){return this.isLargeScreen()&&!this.isTouchDevice()},isTouchDevice:function(){return!t("off")&&!!(t("on")||this.canTouchEvents()||window.navigator.msMaxTouchPoints>0||window.DocumentTouch&&document instanceof DocumentTouch)},isLargeScreen:function(){return(window.innerWidth>0?window.innerWidth:screen.width)>1024},_isWsChannelPage:function(){return e.isChannelPage&&"topcat"===e.configuration.cms},isApple:function(){return/(Macintosh|Mac_PowerPC)/.test(navigator.userAgent)||this.isIos()},isWindows:function(){return/(Windows)/.test(navigator.userAgent)},isSafari:function(){return/(Safari)/.test(navigator.userAgent)&&!/(Chrome)/.test(navigator.userAgent)},isIE:function(){return/(MSIE|WOW64|IEMobile)/.test(navigator.userAgent)},isFirefox:function(){return/(Firefox)/.test(navigator.userAgent)},isFacebookBrowser:function(){return/(FBAN|FBAV)/.test(navigator.userAgent)},isAndroidBrowser:function(){return/(Android|Mobile)/.test(navigator.userAgent)}};return{can:function(e){return n("can",e)},is:function(e){return n("is",e)},which:function(e){return n("which",e)},__cacheClear:function(){o={}}}}),define("module/deviceInspector",["module/bootstrap","module/featureDetector"],function(e,t){function n(){b.$(g).on("resize",i)}function o(){var e=v.documentElement.clientWidth,t=v.documentElement.clientHeight;return e>t?e:t}function i(e){var t=r(),n=c();t!==m&&l(t),n!==f&&u(n)}function s(){return v.documentElement.clientWidth}function a(){return t.is("TouchDevice")}function r(){var e=s(),t="group1";return e>=y&&e<w?t="group2":e>=w&&e<_?t="group3":e>=_&&(t="group4"),t}function c(){var e,t=o(),n=s();return(n<k||n>=k&&t<x)&&(e="smart"),n>=k&&t>=x&&(e="tablet"),s()>=C&&!a()&&(e="wide"),e}function l(e){m=e,b.pubsub.emit("deviceGroup",[m])}function u(e){f=e,b.pubsub.emit("deviceType",[f])}function d(){return m}function h(){return f}function p(t,o){return g=t||window,b=o||e,m="group1",f="smart",v=g.document,l(r()),u(c()),n(),{getType:h,getGroup:d}}var m,f,g,v,b,y=400,w=600,_=1008,k=600,C=1008,x=720;return{init:p}}),define("deviceInspector",["module/deviceInspector"],function(e){return e.init()}),define("module/alternativeJsStrategy/processJsDependencies",[],function(){var e=function(e,t){require([e],function(e){e&&e.reProcess&&e.reProcess("#"+t)})};return function(t,n){for(var o in t)e(t[o],n)}}),define("module/polyfill/bind",[],function(){Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,o=function(){},i=function(){return n.apply(this instanceof o&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return o.prototype=this.prototype,i.prototype=new o,i})}),define("module/alternativeJsStrategy/postLoadHandlers/base",["module/bootstrap","module/alternativeJsStrategy/processJsDependencies","module/polyfill/bind"],function(e,t){var n=function(e){e&&(this.elementId=e.getAttribute("id"),this.element=e)};return n.prototype.load=function(){e.$.ajax({url:this.url,dataType:"json",success:this.processSuccessfulResponse.bind(this)})},n.prototype.processJsDependencies=function(e){t(e,this.elementId)},n}),define("module/alternativeJsStrategy/postLoadHandlers/single",["module/bootstrap","module/alternativeJsStrategy/postLoadHandlers/base","module/polyfill/bind"],function(e,t){var n=function(e,n){1===e.getElementsByClassName("show-more-container").length?this.hasShowMoreButton=!0:this.postLoaded=!0,this.url=n,t.call(this,e)};return n.prototype=new t,n.prototype.loadIfShouldBeShown=function(){this.load()},n.prototype.addShowMoreButton=function(){require(["module/alternativeJsStrategy/moreButton"],function(e){new e(this.elementId,this.url)}.bind(this))},n.prototype.processSuccessfulResponse=function(t){if(t.html)for(this.element.innerHTML=t.html;this.element.attributes.length>0;)this.element.removeAttribute(this.element.attributes[0].name);t.moreContentUrl&&!this.hasShowMoreButton&&(this.url=t.moreContentUrl,this.addShowMoreButton()),this.processJsDependencies(t.jsDependencies),e.pubsub.emit("component:postloaded",this.element)},n}),define("module/alternativeJsStrategy/postLoadHandlers/legacySingle",["config","module/alternativeJsStrategy/postLoadHandlers/base","module/bootstrap"],function(e,t,n){var o=function(o,i,s){var a,r,c={};if(i.opts){if(i.opts.bespoke_old_post_load){for(var l in i.opts.js_dependencies)i.opts.js_dependencies[l]="module/"+i.opts.js_dependencies[l];return void(this.bespokeJsOnly=i.opts.js_dependencies)}i.opts.loading_strategy&&(this.postLoaded=this.isPostLoaded(i),i.opts.loading_strategy="include_content"),i.opts.bespoke_post_load_handler&&(this.bespokePostLoadHandler=i.opts.bespoke_post_load_handler)}"remote-portlet"===i.type&&"on"===i.opts.js&&(i.selector="#"+i.id,this.remotePortletMeta=i),c.id=i.id,c.opts=i.opts,i.template&&(c.template=i.template),i.deviceGroups&&(this.visibleDeviceGroups=i.deviceGroups,c.deviceGroups=i.deviceGroups,this.shouldShow(s)?this.isToggleable=!0:this.delayedLoading=!0),a=i.type||i.name,r={batch:{}},r.batch[a]=c,this.url=e.pathPrefix+(e.languageVariant?"/"+e.languageVariant:"")+"/components?alternativeJsLoading=true&"+n.$.param(r),t.call(this,o)};return o.prototype=new t,o.prototype.loadRemotePortletDependency=function(e){var t=e.opts.js_dependency?e.opts.js_dependency:e.opts.id;require(["module/components/"+t],function(t){t.init(e)})},o.prototype.isPostLoaded=function(e){return"post_load"===e.opts.loading_strategy},o.prototype.addShowMoreButton=function(){require(["module/components/moreButton"],function(e){new e(this.elementId,this.url)}.bind(this))},o.prototype.processSuccessfulResponse=function(e){if(this.bespokePostLoadHandler)return void require([this.bespokePostLoadHandler],function(t){t.handleSuccess(this,e);for(var o in e)n.pubsub.emit("component:postloaded",document.getElementById(o))}.bind(this));for(var t in e)this.element.outerHTML=e[t].html,n.pubsub.emit("component:postloaded",document.getElementById(this.elementId)),this.remotePortletMeta?this.loadRemotePortletDependency(this.remotePortletMeta):this.processJsDependencies(e[t].jsDependencies)},o.prototype.shouldShow=function(e){return!this.visibleDeviceGroups||this.visibleDeviceGroups&&-1!==this.visibleDeviceGroups.indexOf(e)},o.prototype.loadIfShouldBeShown=function(e){this.shouldShow(e)&&this.load()},o.prototype.updateDeviceGroupVisibility=function(e){var t="#"+this.elementId;this.shouldShow(e)?n.$(t).removeClass("hidden"):n.$(t).addClass("hidden")},o.prototype.loadIfShouldBeVisible=function(e){return!!this.shouldShow(e)&&(this.load(),!0)},o}),define("module/alternativeJsStrategy/postLoadHandlers/batch",["module/bootstrap","module/alternativeJsStrategy/postLoadHandlers/base"],function(e,t){var n=function(e,n){this.url=n,t.call(this,e),this.load()};return n.prototype=new t,n.prototype.processSuccessfulResponse=function(t){for(var n in t){var o=document.getElementById(n);o&&(o.outerHTML=t[n].html),this.processJsDependencies(t[n].jsDependencies),e.pubsub.emit("component:postloaded",document.getElementById(n))}},n}),define("module/alternativeJsStrategy/loaderFactory",["module/alternativeJsStrategy/postLoadHandlers/single","module/alternativeJsStrategy/postLoadHandlers/legacySingle","module/alternativeJsStrategy/postLoadHandlers/batch"],function(e,t,n){return{build:function(o,i){return o.hasAttribute("data-post-load-url")?new e(o,o.getAttribute("data-post-load-url")):o.hasAttribute("data-comp-meta")?new t(o,JSON.parse(o.getAttribute("data-comp-meta")),i):o.hasAttribute("data-batch-load-url")?new n(o,o.getAttribute("data-batch-load-url")):void 0}}}),define("module/alternativeJsStrategy/controller",["deviceInspector","module/alternativeJsStrategy/loaderFactory","module/bootstrap","module/polyfill/bind"],function(e,t,n){var o=function(){function e(e){var t=/device--(?:feature|smart|tablet|wide)/,o=document.body.className.split(" "),i=o.length,s=-1;for(/^group\d$/.test(e)&&(t=/device--group/);++s<i;)t.test(o[s])&&n.$("body").removeClass(o[s])}function t(t){o!==t&&(o=t,e(t),n.$("body").addClass("device--"+t))}var o;return n.pubsub.on("deviceGroup",function(e){t(e)}),n.pubsub.on("deviceType",function(e){t(e)}),{setBodyClass:t}}();({toggleableComponents:[],delayedLoaders:[],currentDeviceGroup:"",toggleComponents:function(){for(var e,t=this.toggleableComponents.length;t--;)e=this.toggleableComponents[t],e.updateDeviceGroupVisibility(this.currentDeviceGroup)},checkLoadDelayedComponents:function(){for(var e,t=this.delayedLoaders.length,n=0;n<t;)e=this.delayedLoaders[n],e.loadIfShouldBeVisible(this.currentDeviceGroup)?(this.toggleableComponents.push(e),this.delayedLoaders.splice(n,1),t--):n++},initialiseLoaders:function(){for(var e=document.querySelectorAll("[data-comp-meta], [data-post-load-url], [data-batch-load-url], [data-post-load-mvt-meta]"),n=e.length;n--;){var o=t.build(e[n],this.currentDeviceGroup);o.isToggleable&&this.toggleableComponents.push(o),o.delayedLoading&&this.delayedLoaders.push(o),o.bespokeJsOnly&&require(o.bespokeJsOnly),o.remotePortletMeta&&!o.postLoaded&&o.loadRemotePortletDependency(o.remotePortletMeta),o.hasShowMoreButton?o.addShowMoreButton():o.postLoaded&&o.loadIfShouldBeShown(this.currentDeviceGroup)}},init:function(){o.setBodyClass(e.getGroup()),o.setBodyClass(e.getType()),this.currentDeviceGroup=e.getGroup(),n.pubsub.on("deviceGroup",function(e){this.currentDeviceGroup=e,this.checkLoadDelayedComponents(),this.toggleComponents()}.bind(this)),this.initialiseLoaders()}}).init()}),define("module/request",["module/bootstrap"],function(e){"use strict";var t=e.$,n=function(e){this.options=this.setOptions(e),this.url=this.options.url,this.options.getUpdatesOnInit&&this.getUpdates()};return n.prototype={setOptions:function(e){return t.extend({url:void 0,getUpdatesOnInit:!1,dataType:"jsonp",success:t.noop,error:t.noop,pending:t.noop,complete:t.noop},e)},getUpdates:function(){if(!this.url)throw new Error("url is not set");var e={url:this.url,dataType:this.options.dataType};"jsonp"===this.options.dataType&&(e.jsonpCallback="callback");var n=t.ajax(e);"pending"===n.state()&&this.options.pending(),n.done(t.proxy(function(e){this.options.success(e)},this)).fail(t.proxy(function(e){this.options.error(e)},this)).always(t.proxy(function(){this.options.complete()},this))},setUrl:function(e){this.url=e},getUrl:function(){return this.url}},n}),define("module/stream/endpoint",["module/request"],function(e){return function(t,n,o,i){var s=function(e,t){n.trigger(o+e,t)},a=!1,r={url:t,success:function(e){a=!1,e.html&&e.jsDependencies&&s(":html-with-js",e),e.updates&&s(":updates",e.updates),e.endpoints&&s(":endpoints",e.endpoints),e.endpoints&&e.endpoints[o]?c.setUrl(e.endpoints[o]):s(":noupdates")},error:function(e){a=!1,s(":error",e)},pending:function(){s(":requesting")}};"json"===i&&(r.dataType="json");var c=new e(r);return{request:function(){a||(c.getUpdates(),a=!0)},setUrl:function(e){c.setUrl(e)}}}}),define("module/stream/show_more_button",["module/bootstrap","translator"],function(e,t){var n=e.$,o=['<button class="show-more">','<span class="show-more__inner">','<span class="show-more__label">{{label}}</span>','<span class="show-more__spinner"></span>',"</span>","</button>"].join(""),i={loading:"show-more--loading"},s=function(e){return e?{normal:t.get("moreInfo"),loading:t.get("loading")}:{normal:t.get("streamShowMoreButton"),loading:t.get("loading")}};return function(e){var t=s(e),a=n(o.replace("{{label}}",t.normal)),r=a.find(".show-more__label"),c=n({});return a.on("click",function(e){c.trigger("click")}),{appendTo:function(e){a.appendTo(e)},element:a[0],remove:function(){a.detach()},on:function(e,t){c.on(e,t)},setNormal:function(){r.text(t.normal),a.removeClass(i.loading)},setLoading:function(){r.text(t.loading),a.addClass(i.loading)}}}}),define("module/alternativeJsStrategy/moreButton",["module/bootstrap","module/featureDetector","module/stream/endpoint","module/alternativeJsStrategy/processJsDependencies","module/stream/show_more_button"],function(e,t,n,o,i){t.can("CssTransition")&&e.$("body").addClass("css-anim");var s=function(t,o){var s=document.getElementById(t),a=e.$({});this.contentContainer=s.querySelector(".show-more-container"),this.$contentContainer=e.$(this.contentContainer),this.elementId=t,this.endpoint=new n(o,a,"more-button","json"),this.button=new i(!0),a.on("more-button:requesting",this.handleRequesting.bind(this)),a.on("more-button:html-with-js",this.handleNewContent.bind(this)),a.on("more-button:noupdates",this.button.remove.bind(this)),a.on("more-button:error",this.button.remove.bind(this)),this.button.on("click",this.handleShowMoreClick.bind(this)),this.button.appendTo(s)};return s.prototype.handleShowMoreClick=function(){this.endpoint.request()},s.prototype.handleRequesting=function(){this.button.setLoading()},s.prototype.handleNewContent=function(e,t){var n=document.createElement("div");n.innerHTML=t.html;var i=n.querySelector("a");this.$contentContainer.append(n.childNodes),i.focus(),t.moreContentUrl?(this.endpoint.setUrl(t.moreContentUrl),this.button.setNormal()):this.button.remove(),o(t.jsDependencies,this.elementId)},s}),define("module/assortedUtils",[],function(){function e(e){var t;try{t=JSON.parse(e)}catch(e){}return t}function t(e,t,n){for(var o=0;o<e.length;o++)t.call(n,e[o],o)}function n(e){function t(){}return t.prototype=e,new t}function o(e,n){t(n,function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})}function i(e,t){return Object.keys(t).forEach(function(n){t[n]&&"object"==typeof t[n]&&!Array.isArray(t[n])?i(e[n],t[n]):e[n]=t[n]}),e}function s(e){return null===e||void 0===e}return{forEach:t,jsonParse:e,objectCreate:n,mergeObject:o,deepCopy:i,isNullOrUndefined:s}}),define("module/cookieUtils",[],function(){function e(){}return e.prototype.readCookie=function(e){var t,n,o=window.bbccookies.get().split(";");for(n in o)if(o.hasOwnProperty(n)&&(t=o[n].replace(/^\s+/g,""),0===t.indexOf(e)))return t.substring((e+"=").length,t.length);return""},e.prototype.setCookie=function(e,t,n){var o=window.location.hostname,i="";o.match(/bbc.com$/)?i=".bbc.com":o.match(/bbc.co.uk$/)&&(i=".bbc.co.uk");var s=new Date;s.setDate(s.getDate()+n);var a=e+"="+t+"; expires="+s.toGMTString()+"; path=/; domain=";window.bbccookies.set(a+i)},e.prototype.appendToCookie=function(e,t,n){var o=this.readCookie(e),i=o+t;this.setCookie(e,i,n)},e.prototype.removeFromCookie=function(e,t,n){var o=this.readCookie(e),i=o.replace(t,"");this.setCookie(e,i,n)},e.prototype.removeAllFromCookie=function(e,t){this.setCookie(e,"",t)},e.prototype.isAllowed=function(e){return window.bbccookies.isAllowed(e)},e.prototype.cookiesEnabled=function(){return window.bbccookies.cookiesEnabled()},e.prototype.readPolicy=function(e){return window.bbccookies.readPolicy(e)},new e}),define("module/bannerUtils",["module/cookieUtils"],function(e){function t(e){this.cookieName=e.cookieName,this.cookieExpiryInDays=e.cookieExpiryInDays,this.optInValue=e.optInValue,this.optOutValue=e.optOutValue,this.surveyTakenValue=e.surveyTakenValue,this.dismissedValue=e.dismissedValue}var n;return t.prototype.isOptedOut=function(){return e.readCookie(this.cookieName).indexOf(this.optOutValue)>-1},t.prototype.isOptedIn=function(){return e.readCookie(this.cookieName).indexOf(this.optInValue)>-1},t.prototype.isDismissed=function(){return e.readCookie(this.cookieName).indexOf(this.dismissedValue)>-1},t.prototype.isSurveyTaken=function(){return e.readCookie(this.cookieName).indexOf(this.surveyTakenValue)>-1},t.prototype.optIn=function(){this.isOptedIn()||e.appendToCookie(this.cookieName,this.optInValue,this.cookieExpiryInDays),this.isOptedOut()&&e.removeFromCookie(this.cookieName,this.optOutValue,this.cookieExpiryInDays)},t.prototype.optOut=function(){this.isOptedOut()||e.appendToCookie(this.cookieName,this.optOutValue,this.cookieExpiryInDays),this.isOptedIn()&&e.removeFromCookie(this.cookieName,this.optInValue,this.cookieExpiryInDays)},t.prototype.setSurveyTakenCookie=function(){e.appendToCookie(this.cookieName,this.surveyTakenValue,this.cookieExpiryInDays)},t.prototype.setBannerDismissedCookie=function(){e.appendToCookie(this.cookieName,this.dismissedValue,this.cookieExpiryInDays)},t.prototype.overrideDesktopCookie=function(t,n){e.setCookie(t,n,this.cookieExpiryInDays)},t.prototype.getBannerDismissedClass=function(){return this.isDismissed(this.cookieName,this.dismissedValue)?"":"news-banner--fixed"},t.prototype.getSurveyTakenClass=function(){return this.isSurveyTaken(this.cookieName,this.surveyTakenValue)?"news-banner__survey--hidden":""},t.prototype.removeFixedModifierFromBanner=function(){var e=$("#news-banner");e.hasClass("news-banner--fixed")&&e.removeClass("news-banner--fixed")},t.prototype.addOrbFooterPadding=function(){this.isDismissed(this.cookieName,this.dismissedValue)||(n=$("#orb-footer"),n.addClass("news-banner__orb-spacing"))},t.prototype.removeOrbFooterPadding=function(){n.hasClass("news-banner__orb-spacing")&&n.removeClass("news-banner__orb-spacing")},t.prototype.displayBanner=function(){var e=$("#news-banner__outer-container").detach();e=e.html().replace("{{explainerSurveyDisplay}}",this.getSurveyTakenClass()).replace("{{isExplainerBannerFixed}}",this.getBannerDismissedClass()),$("#page").append(e),this.addOrbFooterPadding()},t}),define("module/components/mediaPlayer/eventDelegator",["module/bootstrappedJquery"],function(e){function t(e,t,n){e.bind(t,function(o){var i=n?o:e;s.trigger(t,i),a.push({event:t,params:[void 0,i]})})}function n(e){t(e,"initialised"),t(e,"playing"),t(e,"pause"),t(e,"ended"),t(e,"error",!0)}function o(e,t){for(var n=0;n<a.length;n++)a[n].event===e&&t.apply(this,a[n].params)}function i(e,t,n){s.on(e,t),n&&o(e,t)}var s=e({}),a=[];return{addPlayer:n,subscribe:i}}),define("module/components/mediaPlayer/view",["module/assortedUtils","module/bootstrappedJquery"],function(e,t){function n(){return document.querySelectorAll(".js-media-player-unprocessed")}function o(){return document.querySelector(".media-player")}function i(e,t){e.setAttribute("id",t)}function s(e){t(e).removeClass("js-media-player-unprocessed")}function a(e){var n=document.querySelector(e+" .media-player");t(n).addClass("js-media-player-unprocessed")}function r(e){return d(e.getAttribute("data-playable"))}function c(e){return e?e.offsetWidth:null}function l(e){t(e).addClass(h)}function u(e){t(e).removeClass(h)}var d=e.jsonParse,h="media-player--hidden";return{findFirstMediaPlaceholder:o,findUnprocessedMediaPlaceholders:n,getPlayableForPlaceholder:r,hidePlayers:l,markPlaceholderAsProcessed:s,activatePlaceholder:a,setPlaceholderId:i,getPlaceholderWidth:c,showPlayers:u}}),define("module/components/mediaPlayer/flashPlayerHandler",["module/components/mediaPlayer/view"],function(e){function t(t){a||"smp-flash"!==t.name()||(a=!0),i&&(i=!1,s?e.showPlayers():e.hidePlayers())}function n(t){a?e.hidePlayers(t):(i=!0,s=!1)}function o(t){a?e.showPlayers(t):(i=!0,s=!0)}var i,s,a=!1;return{handleNewPlayer:t,hide:n,show:o}}),define("module/components/mediaPlayer/pluginData",["module/featureDetector"],function(e){return[{loadedCallback:function(e,t){e.addEventListeners(t.instance)},path:"bbcdotcom/av/emp/analytics",shouldLoad:function(){return e.is("CollectingGNLAnalytics")||e.is("DisplayingGnlAds")}},{loadedCallback:function(e,t){e.addSmpPlugin(t.domId,t.instance)},path:"bbcdotcom/av/emp/adverts",shouldLoad:function(){return e.is("DisplayingGnlAds")}}]}),function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function t(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function o(e){M=e}function i(e){V=e}function s(){return function(){D(r)}}function a(){return function(){setTimeout(r,1)}}function r(){for(var e=0;e<j;e+=2){(0,G[e])(G[e+1]),G[e]=void 0,G[e+1]=void 0}j=0}function c(){}function l(){return new TypeError("You cannot resolve a promise with itself")}function u(){return new TypeError("A promises callback cannot return that same promise.")}function d(e){try{return e.then}catch(e){return Y.error=e,Y}}function h(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}function p(e,t,n){V(function(e){var o=!1,i=h(n,t,function(n){o||(o=!0,t!==n?g(e,n):b(e,n))},function(t){o||(o=!0,y(e,t))},"Settle: "+(e._label||" unknown promise"));!o&&i&&(o=!0,y(e,i))},e)}function m(e,t){t._state===K?b(e,t._result):t._state===X?y(e,t._result):w(t,void 0,function(t){g(e,t)},function(t){y(e,t)})}function f(e,n){if(n.constructor===e.constructor)m(e,n);else{var o=d(n);o===Y?y(e,Y.error):void 0===o?b(e,n):t(o)?p(e,n,o):b(e,n)}}function g(t,n){t===n?y(t,l()):e(n)?f(t,n):b(t,n)}function v(e){e._onerror&&e._onerror(e._result),_(e)}function b(e,t){e._state===J&&(e._result=t,e._state=K,0!==e._subscribers.length&&V(_,e))}function y(e,t){e._state===J&&(e._state=X,e._result=t,V(v,e))}function w(e,t,n,o){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+K]=n,i[s+X]=o,0===s&&e._state&&V(_,e)}function _(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o,i,s=e._result,a=0;a<t.length;a+=3)o=t[a],i=t[a+n],o?x(n,o,i,s):i(s);e._subscribers.length=0}}function k(){this.error=null}function C(e,t){try{return e(t)}catch(e){return Z.error=e,Z}}function x(e,n,o,i){var s,a,r,c,l=t(o);if(l){if(s=C(o,i),s===Z?(c=!0,a=s.error,s=null):r=!0,n===s)return void y(n,u())}else s=i,r=!0;n._state!==J||(l&&r?g(n,s):c?y(n,a):e===K?b(n,s):e===X&&y(n,s))}function S(e,t){try{t(function(t){g(e,t)},function(t){y(e,t)})}catch(t){y(e,t)}}function T(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(c),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?b(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&b(n.promise,n._result))):y(n.promise,n._validationError())}function P(e){return new Q(this,e).promise}function E(e){function t(e){g(i,e)}function n(e){y(i,e)}var o=this,i=new o(c);if(!O(e))return y(i,new TypeError("You must pass an array to race.")),i;for(var s=e.length,a=0;i._state===J&&a<s;a++)w(o.resolve(e[a]),void 0,t,n);return i}function I(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(c);return g(n,e),n}function A(e){var t=this,n=new t(c);return y(n,e),n}function L(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function B(e){this._id=ie++,this._state=void 0,this._result=void 0,this._subscribers=[],c!==e&&(t(e)||L(),this instanceof B||N(),S(this,e))}function $(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise
;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=se)}var R;R=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var D,M,H,O=R,j=0,V=function(e,t){G[j]=e,G[j+1]=t,2===(j+=2)&&(M?M(r):H())},U="undefined"!=typeof window?window:void 0,F=U||{},W=F.MutationObserver||F.WebKitMutationObserver,q="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),z="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,G=new Array(1e3);H=q?function(){var e=process.nextTick,t=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&"0"===t[1]&&"10"===t[2]&&(e=setImmediate),function(){e(r)}}():W?function(){var e=0,t=new W(r),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():z?function(){var e=new MessageChannel;return e.port1.onmessage=r,function(){e.port2.postMessage(0)}}():void 0===U&&"function"==typeof require?function(){try{var e=require,t=e("vertx");return D=t.runOnLoop||t.runOnContext,s()}catch(e){return a()}}():a();var J=void 0,K=1,X=2,Y=new k,Z=new k;T.prototype._validateInput=function(e){return O(e)},T.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},T.prototype._init=function(){this._result=new Array(this.length)};var Q=T;T.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,o=e._input,i=0;n._state===J&&i<t;i++)e._eachEntry(o[i],i)},T.prototype._eachEntry=function(e,t){var o=this,i=o._instanceConstructor;n(e)?e.constructor===i&&e._state!==J?(e._onerror=null,o._settledAt(e._state,t,e._result)):o._willSettleAt(i.resolve(e),t):(o._remaining--,o._result[t]=e)},T.prototype._settledAt=function(e,t,n){var o=this,i=o.promise;i._state===J&&(o._remaining--,e===X?y(i,n):o._result[t]=n),0===o._remaining&&b(i,o._result)},T.prototype._willSettleAt=function(e,t){var n=this;w(e,void 0,function(e){n._settledAt(K,t,e)},function(e){n._settledAt(X,t,e)})};var ee=P,te=E,ne=I,oe=A,ie=0,se=B;B.all=ee,B.race=te,B.resolve=ne,B.reject=oe,B._setScheduler=o,B._setAsap=i,B._asap=V,B.prototype={constructor:B,then:function(e,t){var n=this,o=n._state;if(o===K&&!e||o===X&&!t)return this;var i=new this.constructor(c),s=n._result;if(o){var a=arguments[o-1];V(function(){x(o,i,a,s)})}else w(n,i,e,t);return i},catch:function(e){return this.then(null,e)}};var ae=$,re={Promise:se,polyfill:ae};"function"==typeof define&&define.amd?define("vendor/polyfill/promise",[],function(){return re}):"undefined"!=typeof module&&module.exports?module.exports=re:void 0!==this&&(this.ES6Promise=re),ae()}.call(this),define("module/components/mediaPlayer/pluginLoader",["module/bootstrappedJquery","module/components/mediaPlayer/pluginData","require","vendor/polyfill/promise"],function(e,t,n,o){function i(e,t,n,o,i){try{i&&t.loadedCallback(i,e)}catch(e){o(e)}n()}function s(e){return function(t){return e(t)}}function a(e,t,n,o){return function(s){return i(e,t,n,o,s)}}function r(e,t){return new l(function(o,i){if(!t.shouldLoad())return void o();n([t.path],a(e,t,o,i),s(i))})}function c(e){return t.reduce(function(t,n){var o=r(e,n);return t.then(function(){return o}).catch(function(e){console.error(e)})},l.resolve(null))}var l=o.Promise;return c}),define("module/stats/comscoreContextID",[],function(){function e(){}var t=null;return e.prototype.ECHO_PROFILE_WS="world_service",e.prototype.readCookie=function(e){var t,n,o=window.bbccookies.get().split(";");for(n in o)if(o.hasOwnProperty(n)&&(t=o[n].replace(/^\s+/g,""),0===t.indexOf(e)))return t.substring((e+"=").length,t.length);return null},e.prototype.getUserTrackingCookieValue=function(){return!t&&this.isDotCom()&&(t=this.readCookie("ckpf_sscid")),t},e.prototype.hasUserTrackingCookie=function(){return null!==this.getUserTrackingCookieValue()},e.prototype.isDotCom=function(){return/\.bbc\.com$/.test(window.location.hostname)},e.prototype.isSecure=function(e){return"https:"===window.location.protocol},e.prototype.getC2Value=function(){return 19999701},e.prototype.getSiteValue=function(){return"bbc"},e.prototype.getTestSiteValue=function(){return"bbc-global-test"},e.prototype.getLegacyVisitorAlias=function(){return this.readCookie("s_vi")},e.prototype.getBaseUrl=function(){return this.hasUserTrackingCookie()?this.getScorecardBaseUrl():this.getSscBaseUrl()},e.prototype.getSscBaseUrl=function(){return this.isSecure()?"https://ssc.api.bbc.com/":"http://ssc.api.bbc.com/"},e.prototype.getScorecardBaseUrl=function(){return this.isSecure()?"https://sb.scorecardresearch.com/b":"http://b.scorecardresearch.com/b"},new e}),define("module/stats/comscoreConfig",[],function(){return{hidden:[{name:"facebook",type:"twite",selector:"twite__channel-click--facebook"},{name:"twitter",type:"twite",selector:"twite__channel-click--twitter"},{name:"email",type:"twite",selector:"twite__channel-click--email"},{name:"linkedin",type:"twite",selector:"twite__channel-click--linkedin"},{name:"whatsapp",type:"twite",selector:"twite__channel-click--whatsapp"},{name:"googleplus",type:"twite",selector:"twite__channel-click--googleplus"},{name:"messengerdesktop",type:"twite",selector:"twite__channel-click--messengerdesktop"},{name:"messengermobile",type:"twite",selector:"twite__channel-click--messengermobile"},{name:"vkontakte",type:"twite",selector:"twite__channel-click--vkontakte"},{name:"odnoklassniki",type:"twite",selector:"twite__channel-click--odnoklassniki"},{name:"line",type:"twite",selector:"twite__channel-click--line"},{name:"hatena",type:"twite",selector:"twite__channel-click--hatena"},{name:"mixi",type:"twite",selector:"twite__channel-click--mixi"},{name:"moimir",type:"twite",selector:"twite__channel-click--moimir"},{name:"meneame",type:"twite",selector:"twite__channel-click--meneame"},{name:"balatarin",type:"twite",selector:"twite__channel-click--balatarin"},{name:"livejournal",type:"twite",selector:"twite__channel-click--livejournal"},{name:"renren",type:"twite",selector:"twite__channel-click--renren"},{name:"kaixin",type:"twite",selector:"twite__channel-click--kaixin"},{name:"weibo",type:"twite",selector:"twite__channel-click--weibo"},{name:"qq",type:"twite",selector:"twite__channel-click--qq"},{name:"douban",type:"twite",selector:"twite__channel-click--douban"},{name:"plurk",type:"twite",selector:"twite__channel-click--plurk"},{name:"extractedfacebook",type:"extractedtwite",selector:"twite__channel-click-extracted--facebook"},{name:"extractedtwitter",type:"extractedtwite",selector:"twite__channel-click-extracted--twitter"},{name:"extractedemail",type:"extractedtwite",selector:"twite__channel-click-extracted--email"},{name:"extractedmessengerdesktop",type:"extractedtwite",selector:"twite__channel-click-extracted--messengerdesktop"},{name:"extractedmessengermobile",type:"extractedtwite",selector:"twite__channel-click-extracted--messengermobile"}]}}),define("module/stats/comscore",["module/stats/comscoreContextID","module/bootstrap","module/assortedUtils","deviceInspector","module/stats/comscoreConfig"],function(e,t,n,o,i){"use strict";function s(e){this.config=e,this.comscoreConfig=i,this.asset=e.asset,this.url=document.location.href}function a(e){return e.replace(/(^-)|(-$)/g,"")}function r(e){return e.replace(/^www\./,"")}function c(e){return e.replace(/[^a-z0-9-._]/g,"-")}function l(e){return e.replace(/-{2,}/g,"-")}var u=t.$,d=n.mergeObject,h=n.isNullOrUndefined,p=0;return s.IMPLEMENTATION_VERSION="1.0.0.0",s.B_CODE_VER="bbc_v1-0",s.EVENT_TYPE_PAGE_VIEW="2",s.BUSINESS_UNIT_WS="ws",s.BUSINESS_UNIT_NONE=null,s.PROJECT_SOURCE_WS="ws",s.PROJECT_SOURCE_NONE=null,s.ASSET_HEADLINE_NONE=null,s.VIRTUAL_SITE_NONE=null,s.prototype.sendPageViewBeacon=function(){this.processConfig(),this.sendBeacon(this.getBeaconUrl(this.getPageViewBeacon()))},s.prototype.sendClickBeacon=function(e){this.sendBeacon(this.getBeaconUrl(this.getClickBeacon(e)))},s.prototype.sendBeacon=function(e){var t=document.createElement("img");t.src=e,t.style.display="none",t.className="comscore-tracking-beacon",t.alt="",document.body.appendChild(t)},s.prototype.getBeaconUrl=function(t){t=this.filterBeaconValues(t);var n=t.c9;return delete t.c9,e.getBaseUrl(t)+"?"+u.param(t)+"&c9="+n},s.prototype.filterBeaconValues=function(e){var t={};for(var n in e)h(e[n])||(t[n]=e[n]);return t},s.prototype.getPageViewBeacon=function(){var e=this.getPayload(),t=this.getBaseBeacon(),n=this.getSessionLabels(),o=this.getSocialEmbedLabels();return d(e,[t,n,o]),e},s.prototype.getPayload=function(){var e=u("#comscore-payload");return e.length<1||void 0===e.data("payload")?[]:e.data("payload")},s.prototype.getBaseBeacon=function(){return{ns_alias:e.getUserTrackingCookieValue(),b_code_ver:s.B_CODE_VER,b_s_vi:e.getLegacyVisitorAlias(),ns_search_term:this.getSearchTerm(),ns_search_result:this.getSearchResults(),c9:this.getReferrer(),ns__t:this.getTimestamp(),b_vp:this.getViewportWidth(),b_vph:this.getViewportHeight(),b_sr:this.getScreenRes(),b_ad_enabled:this.getAdvertisingEnabled()}},s.prototype.getClickBeacon=function(e){var t=this.getPageViewBeacon();return d(t,[{ns_type:"hidden",c1:1,b_link:this.getBLink("click",e)}]),t},s.prototype.getSessionLabels=function(){var e={b_vs_un:this.getBusinessUnit(),b_vs_ls:this.config.service,b_synd_partner:this.getSyndicationPartner()};if(this.isEmbedUrl()){var t=this.getPartnerUrl();null!==t&&this.addSessionLabelsForPartner(e,t)}return e},s.prototype.getSocialEmbedLabels=function(){var e=document.getElementsByClassName("social-embed-post"),t="";if(e.length>0){for(var n=0;n<e.length;n++)t+=0!==n?"|":"",t+=e[n].className.replace("social-embed-post social-embed-","");return{b_embed_count:e.length,b_embed_list:t}}return{}},s.prototype.addSessionLabelsForPartner=function(e,t){var n=r(t.hostname),o=decodeURIComponent(t.pathname);if(e.b_synd_partner=n,o.length>1){var i=this.normalisePartnerUrl(n+o);i&&(e.b_wspartner_url=i)}},s.prototype.getPartnerUrl=function(){var e=this.url.match(/\?(.+&)?wspartner=([^&?]+)/);if(null!==e){var t=e[2],n=document.createElement("a");return n.setAttribute("href",decodeURIComponent(t)),n}return null},s.prototype.getViewportWidth=function(){return u(window).width()},s.prototype.getViewportHeight=function(){return u(window).height()},s.prototype.getScreenRes=function(){return window.screen.width+"x"+window.screen.height},s.prototype.getVirtualSite=function(){return"virtual_site"in this.config.comscoreAnalytics?this.config.comscoreAnalytics.virtual_site:s.VIRTUAL_SITE_NONE},s.prototype.getEventType=function(){return s.EVENT_TYPE_PAGE_VIEW},s.prototype.getBusinessUnit=function(){return this.config.isWorldService?s.BUSINESS_UNIT_WS:s.BUSINESS_UNIT_NONE},s.prototype.getProjectSource=function(){return this.config.isWorldService?s.PROJECT_SOURCE_WS:s.PROJECT_SOURCE_NONE},s.prototype.getPageName=function(){return window.location.pathname.replace("/","").replace(/\//g,".")},s.prototype.getSyndicationPartner=function(){return"bbc|rd|"+o.getGroup()},s.prototype.getSectionId=function(){if(this.asset.section)return this.asset.section.id},s.prototype.getAssetHeadline=function(){return this.asset.headline?this.asset.headline:s.ASSET_HEADLINE_NONE},s.prototype.getAssetByline=function(){if(this.asset.byline)return this.asset.byline.name},s.prototype.getArticleLength=function(){return"number"==typeof this.asset.length?this.asset.length:null},s.prototype.getAdvertisingEnabled=function(){return this.asset.options&&this.asset.options.allowAdvertising?1:0},s.prototype.getSearchTerm=function(){return this.config.search?this.config.search.term:null},s.prototype.getSearchResults=function(){return this.config.search?this.config.search.results:null},s.prototype.getReferrer=function(){return document.referrer},s.prototype.getC7=function(){return window.location.href},s.prototype.getTitle=function(){return document.title},s.prototype.getCustomPageUrl=function(){return window.location.pathname!==this.asset.asset_uri?window.location.pathname:null},s.prototype.getCharacterEncoding=function(){return document.querySelector("meta[charset]").getAttribute("charset")},s.prototype.getTimestamp=function(){return Math.floor(+new Date/1e3)},s.prototype.getTopics=function(){return this.asset.topicTags},s.prototype.getBLink=function(e,t){return this.getBLinkComponents(e,t).map(function(e){return h(e)?"na":e}).join("|")},s.prototype.getBLinkComponents=function(e,t){return[t.promoted_channel||null,t.channel_location||null,t.module_name||null,t.link_type||null,t.link_name||null,t.link_position||null,t.links_in_module||null,t.link_info||null,t.section_location||null,t.page_type_location||null,t.link_placement||null,t.destination||null,e]},s.prototype.normalisePartnerUrl=function(e){return e=e.toLowerCase(),e=c(e),e=l(e),e=a(e)},s.prototype.isEmbedUrl=function(){return-1!==this.url.indexOf("/embed?")},s.prototype.processConfig=function(){for(var e=this.comscoreConfig.hidden||{},t=0;t<e.length;t++){var n=e[t];document.getElementsByClassName(n.selector).length>0&&(p++,this.registerHiddenEventListeners(n))}},s.prototype.registerHiddenEventListeners=function(e){switch(e.type){case"twite":this.registerSingleHiddenEventListener(e,"twite__channel-link",this.shareToolLinkPosition(e));break;case"extractedtwite":this.registerSingleHiddenEventListener(e,"extracted__channel-link",this.shareToolLinkPosition(e))}},s.prototype.registerSingleHiddenEventListener=function(e,t,n){var o=this;n=n||0,document.getElementsByClassName(e.selector)[0].getElementsByClassName(t)[0].addEventListener("click",function(){o.onShareButtonClicked(e.name,n)},!1)},s.prototype.shareToolLinkPosition=function(e){for(var t=document.getElementsByClassName("sharetools")[0].getElementsByTagName("li")||0,n=1,o=0;o<t.length;o++)if(-1!==t[o].className.indexOf("twite__channel")){if(-1!==e.name.indexOf("extracted")){var i=e.name.replace("extracted","");if(-1!==t[o].className.indexOf("twite__channel-click-extracted--"+i))return n}else if(-1!==t[o].className.indexOf("twite__channel-click--"+e.name))return n;n++}},s.prototype.onShareButtonClicked=function(e,t){var n={module_name:"twite",link_type:"button",link_name:"share_"+e,link_position:t,links_in_module:p,link_info:"share",destination:this.url.replace("#share-tools","")};this.sendClickBeacon(n)},s}),define("module/components/mediaPlayer/comscoreSettings",["config","module/stats/comscore","module/stats/comscoreContextID"],function(e,t,n){function o(){if(!e.features2||!e.features2.comscore_analytics)return{};var o=new t(e);return{statsObject:{echoProfile:n.ECHO_PROFILE_WS,sessionLabels:o.getSessionLabels()}}}return{get:o}}),define("module/components/mediaPlayer/playlistSelector",["module/featureDetector"],function(e){function t(e){return e.progressiveDownloadUrl?e.progressiveDownloadUrl:e.streamingUrl}return{selectPlaylist:t}}),define("module/components/mediaPlayer/autoPlay",["deviceInspector"],function(e){function t(t){var n;return n=!(!t||!t.otherSettings)&&t.otherSettings.isAutoplayOnForAudience,"smart"!==e.getType()&&n}return{isEnabled:t}}),function(){function e(){}function t(e){return"function"==typeof e}function n(e){return!(!e||!s[typeof e])}function o(e,o,s){var a,r,c,l,u,d,h,p=0,g=!1,v=!0;if(!t(e))throw new TypeError;if(o=m(0,o)||0,!0===s){var b=!0;v=!1}else n(s)&&(b=s.leading,g="maxWait"in s&&(m(o,s.maxWait)||0),v="trailing"in s?s.trailing:v);var y=function(){var t=o-(f()-l);if(t<=0){r&&clearTimeout(r);var n=h;r=d=h=i,n&&(p=f(),c=e.apply(u,a),d||r||(a=u=null))}else d=setTimeout(y,t)},w=function(){d&&clearTimeout(d),r=d=h=i,(v||g!==o)&&(p=f(),c=e.apply(u,a),d||r||(a=u=null))};return function(){if(a=arguments,l=f(),u=this,h=v&&(d||!b),!1===g)var t=b&&!d;else{r||b||(p=l);var n=g-(l-p),i=n<=0;i?(r&&(r=clearTimeout(r)),p=l,c=e.apply(u,a)):r||(r=setTimeout(w,n))}return i&&d?d=clearTimeout(d):d||o===g||(d=setTimeout(y,o)),t&&(i=!0,c=e.apply(u,a)),!i||d||r||(a=u=null),c}}var i,s={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},a=s[typeof window]&&window||this,r=s[typeof exports]&&exports&&!exports.nodeType&&exports,c=s[typeof module]&&module&&!module.nodeType&&module,l=c&&c.exports===r&&r,u=s[typeof global]&&global;!u||u.global!==u&&u.window!==u||(a=u);var d=Object.prototype,h=d.toString,p=RegExp("^"+String(h).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),m=Math.max;t(/x/)&&(t=function(e){return"function"==typeof e&&"[object Function]"==h.call(e)});var f=function(e){return"function"==typeof e&&p.test(e)}(f=Date.now)&&f||function(){return(new Date).getTime()};e.debounce=o,e.isFunction=t,e.isObject=n,e.now=f,e.VERSION="2.4.1","function"==typeof define&&"object"==typeof define.amd&&define.amd?(a._=e,define("vendor/lo-dash/lo-dash",[],function(){return e})):r&&c?l?(c.exports=e)._=e:r._=e:a._=e}.call(this),define("module/imageenhancer",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){function n(e){return null===e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var o=function(t){function n(){a.resizeImages([a.imageReplaceNodelist,a.backgroundImageReplaceNodelist])}var o=e.$;"string"==typeof t&&o(t).each(function(e,t){o(t).addClass("js-image-replace")}),this.widths=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,624,625,660,695,736,768,772,800,834,872,904,936,950,976,1024,1536,2048],this.programmesWidths=[96,128,160,192,208,240,272,304,336,384,416,448,480,528,560,592,624,656,688,736,768,800,832,864,912,944,960,976,1024,1536,1920],this.isResizing=!1,this.imageReplaceNodelist=null,this.backgroundImageReplaceNodelist=null,this.upscale=!e.config.hasOwnProperty("imageUpscale")||e.config.imageUpscale,e.config.features2&&e.config.features2.hasOwnProperty("lazy_images")?this.lazyImages=e.config.features2.lazy_images:this.lazyImages=!0;var i=e.window.document.documentElement.clientHeight,s=i&&i>400?i/2:200;this.lazyBufferZone=e.config.hasOwnProperty("imageBuffer")?e.config.imageBuffer:s;var a=this;this.changeDivsToImgs(),e.pubsub.on("imageEnhancer:resize",n),e.pubsub.on("imageEnhancer:scroll",n),e.pubsub.on("component:loaded",function(){a.changeDivsToImgs(),a.initResizeImages()}),e.pubsub.on("component:postloaded",function(){a.changeDivsToImgs(),a.initResizeImages()}),setTimeout(function(){a.initResizeImages()},250)};return o.prototype={changeDivsToImgs:function(){$("div.js-delayed-image-load").each(function(e,t){t="number"!=typeof t?t:e;var o=t.getAttribute("data-width"),i=t.getAttribute("data-height"),s="";o>0&&i>0&&(s=' width="'+t.getAttribute("data-width")+'" height="'+t.getAttribute("data-height")+'"');var a=n(t.getAttribute("data-alt"));$(t).replaceWith('<img src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7" datasrc="'+t.getAttribute("data-src")+'" class="responsive-image__img responsive-image__img--loading js-image-replace" alt="'+a+'"'+s+" />")})},initResizeImages:function(){this.imageReplaceNodelist=$(".js-image-replace"),this.backgroundImageReplaceNodelist=$(".js-bg-image-replace"),this.resizeImages([this.imageReplaceNodelist,this.backgroundImageReplaceNodelist]),window.addEventListener?(window.addEventListener("resize",function(){e.pubsub.emit("imageEnhancer:resize")},!1),this.lazyImages&&this.addScrollEventListener()):window.attachEvent("resize",function(){e.pubsub.emit("imageEnhancer:resize")})},addScrollEventListener:function(){window.addEventListener("scroll",t.debounce(function(){e.pubsub.emit("imageEnhancer:scroll")},100),!1)},removeLoadingClass:function(){$(this).removeClass("responsive-image__img--loading")},resizeImages:function(e){if(!this.isResizing){this.isResizing=!0;for(var t=0,n=e.length;t<n;t++){var o=e[t];if(null!==o)for(var i=0,s=o.length;i<s;i++){var a=o[i];if(!a.getAttribute("class").match("no-replace")&&!(this.lazyImages&&this.isBelowFold($(window),$(a))||this.largerImageAlreadyEncountered(a))){!1===this.upscale&&!a.style.maxWidth&&a.hasAttribute("width")&&(a.style.maxWidth=a.getAttribute("width")+"px"),$(a).on("load",this.removeLoadingClass);var r=this.calcImgSrc(a.getAttribute("datasrc")||a.getAttribute("databgsrc")||a.src,a.clientWidth);a.src?r&&r!==a.src&&(a.setAttribute("src",r),a.setAttribute("data-highest-encountered-width",this.matchBestWidth(a.clientWidth))):r&&"url("+r+")"!==a.style.backgroundImage&&(a.style.backgroundImage="url("+r+")")}}this.isResizing=!1}}},largerImageAlreadyEncountered:function(e){return e.getAttribute("data-highest-encountered-width")>e.clientWidth},calcImgSrc:function(e,t){if(null==e)return!1;if(-1!==e.indexOf("cps-images-private"))return e;var n=e.match(/\/news\/(?:ws\/)?(\d*)/)||e;if(null===n||"string"==typeof n){var o=/\/images\/ic\/(\d+)x(\d+)/,i=e.match(o);if(null===i)return!1;var s=parseInt(i[1],10),a=parseInt(i[2],10),r=this.matchBestProgrammesWidth(t),c=r/s,l=Math.round(a*c),u="/images/ic/"+r+"x"+l;return e.replace(o,u)}var d=e.indexOf(n[1]),h=n[1].length;return e.substr(0,d)+this.matchBestWidth(t)+e.substr(d+h)},matchBestProgrammesWidth:function(e){return this.matchBestWidth(e,this.programmesWidths)},matchBestWidth:function(e,t){t=t||this.widths;for(var n=t.length,o=t[n-1];n--;)t[n]<o&&t[n]>=e&&(o=t[n]);return o},isBelowFold:function(e,t){var n=e.height()-1+e.scrollTop();return t.offset().top>n+this.lazyBufferZone}},o}),define("module/components/mediaPlayer/settingsBuilder",["module/components/mediaPlayer/comscoreSettings","module/components/mediaPlayer/playlistSelector","module/components/mediaPlayer/autoPlay","module/assortedUtils","module/featureDetector","module/imageenhancer","istats-1","module/bootstrap"],function(e,t,n,o,i,s,a,r){function c(o){var s=u(h),r=o.otherSettings||{};if(d.extend(!0,s,o.settings,e.get()),s.counterName||(s.counterName=a.getCountername()),s.autoplay=n.isEnabled(o),s.playlistObject){var c=s.playlistObject;r.advertisingAllowed&&i.is("DisplayingGnlAds")&&c.items.unshift({kind:"advert"}),c.holdingImageURL||(c.holdingImageURL=l(r.unProcessedImageUrl,r.placeholderWidth))}else if(r.playlist){var p=r.playlist;s.playlist=t.selectPlaylist(p),p.overrideHoldingImage&&(s.overrideHoldingImage=l(p.overrideHoldingImage,r.placeholderWidth))}return s}function l(e,t){return e}var u=(o.forEach,o.objectCreate),d=(o.mergeObject,new s,r.$),h={appName:"news",appType:"responsive",product:"news",responsive:!0,waitOnPluginLoad:!0,superResponsive:!0,ui:{subtitles:{enabled:!0,defaultOn:!0}}};return{fromPlayable:c}}),define("module/components/mediaPlayer/main",["module/assortedUtils","module/components/mediaPlayer/eventDelegator","module/components/mediaPlayer/flashPlayerHandler","module/components/mediaPlayer/pluginLoader","module/components/mediaPlayer/settingsBuilder","module/components/mediaPlayer/view","module/globalPubsub","vendor/polyfill/promise","require"],function(e,t,n,o,i,s,a,r,c){function l(){return new w(function(e){c(["bump-3"],function(t){e(t)})})}function u(e,n,s){var a,r=i.fromPlayable(s);l().then(function(i){return a=i(e).player(r),t.addPlayer(a),a.bind("fullscreenExit",function(t){e.style.paddingBottom="0",setTimeout(function(){e.style.paddingBottom="56.25%"},100)}),o({instance:a,domId:n})}).then(function(){a.load()})}function d(e){a.emit("player:initialised",[e])}function h(e,t){n.handleNewPlayer(t),d(t)}function p(){b("initialised",h)}function m(){y=s.findUnprocessedMediaPlaceholders();y&&(p(),_(y,function(e){k++;var t="media-player-"+k;s.markPlaceholderAsProcessed(e),s.setPlaceholderId(e,t);var n=s.getPlayableForPlaceholder(e);n&&(n.otherSettings.placeholderWidth=s.getPlaceholderWidth(e),u(e,t,n))}))}function f(e){s.activatePlaceholder(e)}function g(){n.hide(y)}function v(){n.show(y)}function b(e,n){t.subscribe(e,n)}var y,w=r.Promise,_=e.forEach,k=(e.jsonParse,0);return{hideFlashPlayers:g,processNewPlayers:m,showFlashPlayers:v,subscribeToPlayerEvent:b,activatePlaceholder:f}}),define("module/stats/statsBindingAdapter",["module/globalPubsub","module/components/mediaPlayer/main"],function(e,t){function n(e){return{opts:{mediaType:e.kind()},name:e.name()}}t.subscribeToPlayerEvent("playing",function(t,o){e.emit("video:play",[n(o)])},!0),t.subscribeToPlayerEvent("pause",function(t,o){e.emit("video:pause",[n(o)])},!0),t.subscribeToPlayerEvent("ended",function(t,o){e.emit("video:end",[n(o)])},!0),t.subscribeToPlayerEvent("initialised",function(t,o){e.emit("video:load",[n(o)])},!0)}),define("module/stats/statsSubscriber",["module/bootstrap","istats-1","module/stats/statsBindingAdapter"],function(e,t){function n(e,n){this.config=e||{},this.istats=n||t,this.pageviews=[],this.hidden=[],this.links=[],this.processConfig(),this.bindEvents()}return n.prototype={bindEvents:function(){var t=this;e.pubsub.on("component:loaded",function(e){t.handleComponentLoaded(e)}),e.pubsub.on("component:postloaded",function(e){void 0!==e&&t.handlePostLoadedComponent(e)})},handleComponentLoaded:function(e){this.linksContainsComponentName(e)&&this.registerTrackingLink(this.getLinkByName(e))},getLinkByName:function(e){for(var t=0,n=this.links.length;t<n;t++){var o=this.links[t];if(o.name===e)return o}},linksContainsComponentName:function(e){for(var t=0,n=this.links.length;t<n;t++){if(this.links[t].name===e)return!0}return!1},handlePostLoadedComponent:function(e){var t,n,o;for(o=this.findTrackingLinks(e),t=0;t<o.length;++t)null!==(n=this.findConfigLinkEntry(o[t]))&&(this.links.push(n),this.registerTrackingLink(n))},findTrackingLinks:function(t){var n=e.$(t).find("[data-entityid]");return void 0===n?[]:this.extractTrackingNames(n)},extractTrackingNames:function(t){var n,o,i,s;for(s=[],i=0;i<t.length;++i)n=e.$(t[i]).attr("data-entityid"),o=n.indexOf("#"),-1!==o&&(n=n.substr(0,o)),-1===s.indexOf(n)&&s.push(n);return s},findConfigLinkEntry:function(e){var t,n,o;for(n='[data-entityid*="'+e+'"]',t=0;t<this.config.links.length;++t)if(o=this.config.links[t],void 0!==o.selector&&o.selector===n)return o;return null},addPageviews:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.pageviews.push(n),this.registerPageview(n)}},addHidden:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.hidden.push(n),this.registerHiddenEvent(n)}},addTrackingLinks:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.links.push(n),this.registerTrackingLink(n)}},applyCountername:function(e,t){var n=this.istats.getCountername(),o=Array.prototype.slice.call(t);return o.unshift(n),e.apply(this,o)},applyLabels:function(e,t){return e.apply(this,t)},registerPageview:function(t){var n=this,o=t.on,i=t.countername;e.pubsub.on(o,function(){var e="function"==typeof i?n.applyCountername(i,arguments):i;n.istats.log("pageview",e)})},registerHiddenEvent:function(t){var n=this,o=t.on,i=t.action_type||"event",s=t.action_name,a=t.labels||{};e.pubsub.on(o,function(){var e=n.appendLabels(a,arguments);n.istats.log(i,s,e)})},registerTrackingLink:function(e){var t=e.type||"internal",n=e.name,o=e.selector,i=e.labels;if("[object Array]"===Object.prototype.toString.call(o))for(var s=0;s<o.length;s++)this.track(t,n,o[s],i);else this.track(t,n,o,i)},track:function(t,n,o,i){var s,a,r,c,l,u,d,h,p,m;for(d=e.$(o),r=0;r<d.length;++r){for(p=e.$(d[r]).find("a"),c=0;c<p.length;++c)h=p[c],m="story_slot=%d".replace("%d",c+1),i&&(i=this.appendLabels(i,arguments),m+="&"+e.$.param(i)),void 0===h.linktrack?h.linktrack="":h.linktrack+="&",h.linktrack+=m;l=n,s=e.$(d[r]).closest("[data-entityid]"),s&&s.length>0&&(a=s.data("entityid"),(u=a.replace(/.*#/,""))!==a&&(l+="-"+u)),this.istats.track(t,{region:d[r],linkLocation:l})}},processConfig:function(){var e=this.config.pageviews||{};this.addPageviews(e);var t=this.config.hidden||{};this.addHidden(t);var n=this.config.links||{};this.addTrackingLinks(n)},appendLabels:function(e,t){return"function"==typeof e?this.applyLabels(e,t):e}},n}),define("module/stats/statsConfig",[],function(){"use strict";var e=function(e){return void 0!==e.name?e.name:"rmp"};return{links:[{name:"us-election-2016-live",selector:'[data-entityid*="us_live_page"]'},{name:"us-election-2016-az",selector:".us2016-key-states__footer"},{name:"us-election-2016-banner",selector:[".us2016-banner__title",".us-banner-link--infull",".us-banner-link--how-to-win"]},{name:"us-election-2016-ticker",selector:".us2016-ticker__headline"},{name:"topic_link_top",selector:'[data-entityid="topic_link_top"]'},{name:"topic_link",selector:'[data-entityid="topic_link"]'},{name:"topic_link_leading",selector:'[data-entityid*="leading-topics-panel"]'},{name:"topic_link_bottom",selector:'[data-entityid="topic_link_bottom"]'},{name:"recommendation_learn_more",selector:'[data-entityid*="recommendation_learn_more"]'},{name:"world-news-tv-programmes",selector:'[data-entityid*="world-news-tv-programmes"]'},{name:"world-news-tv-contact-us",selector:'[data-entityid*="world-news-tv-contact-us"]'},{name:"world-news-tv-radio",selector:'[data-entityid*="world-news-tv-radio"]'},{name:"more-from-this-index-story",selector:'[data-entityid*="more-section-index"]'},{name:"more-from-this-index-section-label",selector:'[data-entityid*="more-from-this-index-section-label"]'},{name:"pullout-inner-link",selector:'[data-entityid*="pullout-inner-link"]'},{name:"hyper-puff-headline",selector:".fetch-hyperpuff"},{name:"pictures",selector:'[data-entityid*="pictures"]'},{name:"more-corresp",selector:'[data-entityid*="csp-hyperpuff"]'},{name:"headline",selector:'[data-entityid*="correspondent-byline"]'},{name:"latest-posts",selector:'[data-entityid*="latest-posts"]'},{name:"more-story",selector:'[data-entityid*="more-on-this-story"]'},{name:"experts",selector:'[data-entityid*="correspondent-promotion-now"]'},{name:"av-stories-live",selector:'[data-entityid*="av-stories-live-compact-tablet"]'},{name:"av-stories-live",selector:'[data-entityid*="av-stories-live-wide"]'},{name:"headlines-promo",selector:'[data-entityid*="headlines-promo-wide"]'},{name:"headlines-promo",selector:'[data-entityid*="headlines-promo-compact-tablet"]'},{name:"more-uk",selector:'[data-entityid*="more-uk"]'},{name:"more-news",selector:'[data-entityid*="more-news"]'},{name:"top-stories",selector:'[data-entityid*="container-top-stories"]'},{name:"canada-stories",selector:'[data-entityid*="canada-stories"]'},{name:"us-stories",selector:'[data-entityid*="us-stories"]'},{name:"top-stories",selector:'[data-entityid*="top-stories"]'},{name:"live-event-1",selector:'[data-entityid="live_event_1"]'},{name:"live-event-2",selector:'[data-entityid="live_event_2"]'},{name:"cluster1",selector:'[data-entityid*="cluster_1"]'},{name:"cluster2",selector:'[data-entityid*="cluster_2"]'},{name:"full-story",selector:'[data-entityid*="full-story"]'},{name:"must-see",selector:'[data-entityid*="must-see"]'},{name:"av",selector:'[data-entityid*="av-stories-now"]'},{name:"features-promo",selector:'[data-entityid*="lead-feature"]'},{name:"features",selector:'[data-entityid*="feature-main"]'},{name:"explainers",selector:'[data-entityid*="explainers"]'},{name:"the-reporters",selector:'[data-entityid*="the_reporters"]'},{name:"also-in-the-news",selector:'[data-entityid*="also_in_news"]'},{name:"navigation-brand",selector:"#brand"},{name:"breaking-news-banner-pal",selector:"#breaking-news-container"},{name:"story-body",selector:".story-body__link"},{name:"the-papers",selector:'[data-entityid*="latest-content"]'},{name:"features-and-analysis",selector:'[data-entityid*="features-and-analysis"]'},{name:"strapline",selector:'[data-entityid*="strapline"]'},{name:"more-from-this-index-headline",selector:'[data-entityid*="more-from-this-index-headline"]'},{name:"most-read",selector:'[data-entityid*="most-popular-read"]'},{name:"most-watched",selector:'[data-entityid*="most-popular-watched"]'},{name:"most-read-local",selector:".page--local .most-popular .panel-read"},{name:"most-watched-local",selector:".page--local .most-popular .panel-watched"},{name:"from-other-news-sites",selector:"#comp-from-other-news-sites",type:"external"},{name:"exrelinks-primary",selector:'[data-entityid*="exrelinks-primary"]',type:"external"},{name:"exrelinks-secondary",selector:'[data-entityid*="exrelinks-secondary"]',type:"external"
},{name:"topical-top-story",selector:[".hard-news-unit--topical .faux-block-link__overlay-link",".hard-news-unit--topical .hard-news-unit__headline"]},{name:"topical-related-content",selector:"#topical-stories .related-content-links"},{name:"travel-local",selector:".container--travel-weather .travel"},{name:"weather-local",selector:".container--travel-weather .weather"},{name:"local-live-internal",selector:"#comp-local-live"},{name:"local-live-external",selector:"#comp-local-live",type:"external"},{name:"local-stream-story-promo",selector:".comp-stream-story-promo__link"},{name:"narrow-navigation-primary",selector:".navigation--narrow__toplevel"},{name:"narrow-navigation-secondary",selector:".secondary-navigation--narrow"},{name:"wide-navigation-primary",selector:".navigation--wide"},{name:"wide-navigation-primary-overflow",selector:".js-navigation-panel-primary"},{name:"wide-navigation-secondary",selector:".navigation-wide-list--secondary"},{name:"wide-navigation-secondary-overflow",selector:".js-navigation-panel-secondary"},{name:"navigation-bottom",selector:".navigation--bottom"},{name:"england_nav_link",selector:'[data-entityid="england_nav_link"]'},{name:"nireland_nav_link",selector:'[data-entityid="nireland_nav_link"]'},{name:"scotland_nav_link",selector:'[data-entityid="scotland_nav_link"]'},{name:"wales_nav_link",selector:'[data-entityid="wales_nav_link"]'},{name:"connected-stream-internal",selector:["#comp-connected-stream .update .update__image","#comp-connected-stream .update .update__headline","#comp-connected-stream .update .update__body"]},{name:"connected-stream-external",selector:"#comp-connected-stream .update .update__body",type:"external"},{name:"election-2015-nation-navigation",selector:".mininav--election2015 .mininav__nation"},{name:"vocab-faq",selector:'[data-entityid*="vocab-faq"]'}],pageviews:[{on:"tabs:activate:mostread",countername:"news.popular.read.page"},{on:"tabs:activate:topstories",countername:"news.page"},{on:"tabs:activate:livetext",countername:function(e){return e.replace(/(\d+).*$/,"$1.page")}},{on:"tabs:activate:keypoints",countername:function(e){return e.replace(/(\d+).*$/,"$1.keypoints.page")}},{on:"map:asset:request:success",countername:function(e,t,n){return n.countername||e}}],hidden:[{on:"nav:header:open",action_name:"top_navigation_open"},{on:"nav:footer:open",action_name:"bottom_navigation_open"},{on:"locator:submitSearch",action_name:"news.locator"},{on:"locator:geoLocation",action_name:"news.locator"},{on:"video:load",action_type:"video",action_name:"load",labels:function(t){return{player_name:e(t)}}},{on:"video:play",action_type:"video",action_name:"play",labels:function(t){return{player_name:e(t)}}},{on:"video:pause",action_type:"video",action_name:"pause",labels:function(t){return{player_name:e(t)}}},{on:"video:end",action_type:"video",action_name:"end",labels:function(t){return{player_name:e(t)}}},{on:"tabs:activate:maprelated",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"related"}},{on:"tabs:activate:maptopstories",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"topstories"}},{on:"tabs:activate:mapmostwatched",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"mostwatched"}},{on:"map:index:toggle",action_type:"toggle",action_name:"map-index",labels:function(e,t){return{section:e,toggle:t}}},{on:"map:asset:summary",action_type:"toggle",action_name:"map-asset-summary",labels:function(e){return{toggle:e}}},{on:"map:index:topstories",action_type:"toggle",action_name:"map-index-topstories",labels:function(e){return{toggle:e}}},{on:"medianav:select",action_type:"select",action_name:"medianav",labels:function(e,t){return{headline:e.headline,live:e.video.live,index:t}}},{on:"gallery:picture:click",action_type:"click",action_name:"gallery-enhanced"},{on:"gallery:viewer:toggle",action_type:"toggle",action_name:"gallery-enhanced-back",labels:function(e){return{position:e}}},{on:"gallery:caption:toggle",action_type:"toggle",action_name:"gallery-enhanced-caption",labels:function(e){return{toggle:e}}},{on:"gallery:imageonly:toggle",action_type:"toggle",action_name:"gallery-enhanced-image-only",labels:function(e){return{toggle:e}}},{on:"gallery:paginate:click",action_type:"click",action_name:"gallery-enhanced-paginate",labels:function(e,t){return{visibility:e,position:t}}},{on:"stories:more:success",action_type:"select",action_name:"blog-morestories",labels:function(e,t){return{request_count:t.requestCount}}},{on:"stories:fullyloaded",action_type:"event",action_name:"blog-fullyloaded"},{on:"stats:nav:narrow:primary:visibility",action_type:"toggle",action_name:"nav-narrow-primary-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:secondary:visibility",action_type:"toggle",action_name:"nav-narrow-secondary-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:footer:visibility",action_type:"toggle",action_name:"nav-narrow-footer-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:top:primary:accordion:visibility",action_type:"toggle",action_name:"nav-narrow-top-primary-accordion-visibility",labels:function(e,t){return{visibility:e,link:t}}},{on:"stats:nav:narrow:bottom:primary:accordion:visibility",action_type:"toggle",action_name:"nav-narrow-bottom-primary-accordion-visibility",labels:function(e,t){return{visibility:e,link:t}}},{on:"stats:nav:wide:primary:overflow:visibility",action_type:"toggle",action_name:"nav-wide-primary-overflow-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:wide:secondary:overflow:visibility",action_type:"toggle",action_name:"nav-wide-secondary-overflow-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:click",action_type:"click",action_name:"nav-narrow-click",labels:function(e,t,n){return{link:e,url:t,strategy:n}}},{on:"stats:nav:wide:outsidePanel:click",action_type:"click",action_name:"nav-wide-outsidePanel-click",labels:function(e,t,n,o){return{link:e,url:t,strategy:n,withinMorePanel:o}}},{on:"stats:nav:wide:insidePanel:click",action_type:"click",action_name:"nav-wide-insidePanel-click",labels:function(e,t,n,o){return{link:e,url:t,strategy:n,withinMorePanel:o}}},{on:"banner:ticker:toggle",action_type:"toggle",action_name:"banner-ticker-click",labels:function(e){return{toggle:e}}},{on:"eucountry:toggle",action_type:"toggle",action_name:"eucountry-click",labels:function(e){return{toggle:e}}},{on:"euexplainer:toggle",action_type:"toggle",action_name:"euexplainer-click",labels:function(e){return{toggle:e}}},{on:"election:map:zoom",action_type:"zoom",action_name:"election-map-zoom",labels:function(e){return{zoom:e}}},{on:"scotref:map",action_type:"click",action_name:"scotref-map",labels:function(e){return{action:e}}},{on:"election:findaresult:change",action_type:"change",action_name:"election-findaresult-change",labels:function(e){return{url:e}}},{on:"stats:comments:open",action_type:"comments",action_name:"show_comments"},{on:"find-local:overlay:done",action_type:"done",action_name:"Locator"},{on:"stream:refresh",action_type:"click",action_name:"stream-refresh"},{on:"stream:showmore",action_type:"click",action_name:"stream-showmore"},{on:"stream:back-to-top",action_type:"click",action_name:"stream-back-to-top"},{on:"scotref:summary:filter",action_type:"click",action_name:"scotref-table-filter",labels:function(e){return{click:e}}},{on:"marketdata:chart:toggle",action_type:"toggle",action_name:"marketdata-chart-toggle",labels:function(e){return{chart_ticker:e.chart_ticker,chart_timespan:e.chart_timespan,chart_width:e.chart_width,chart_height:e.chart_height}}},{on:"election:findYourConstituency:submitSearch",action_type:"click",action_name:"election-constituency-search-submit"},{on:"election:findYourConstituency:searchError",action_type:"click",action_name:"election-constituency-search-error",labels:function(e){return{error_type:e}}},{on:"tabs:activate:summary",action_type:"click",action_name:"ni-election-tabs",labels:function(){return{click:"summary"}}},{on:"tabs:activate:stageByStage",action_type:"click",action_name:"ni-election-tabs",labels:function(){return{click:"stages"}}},{on:"tabs:activate:popular-vote2016",action_type:"click",action_name:"us2016-pop-vote-tabs",labels:function(){return{click:"2016"}}},{on:"tabs:activate:popular-vote2012",action_type:"click",action_name:"us2016-pop-vote-tabs",labels:function(){return{click:"2012"}}},{on:"tabs:activate:popular-vote2008",action_type:"click",action_name:"us2016-pop-vote-tabs",labels:function(){return{click:"2008"}}},{on:"tabs:activate:popular-vote2004",action_type:"click",action_name:"us2016-pop-vote-tabs",labels:function(){return{click:"2004"}}},{on:"tabs:activate:congress2016",action_type:"click",action_name:"us2016-congress-tabs",labels:function(){return{click:"2016"}}},{on:"tabs:activate:congress2014",action_type:"click",action_name:"us2016-congress-tabs",labels:function(){return{click:"2014"}}},{on:"tabs:activate:congress2012",action_type:"click",action_name:"us2016-congress-tabs",labels:function(){return{click:"2012"}}},{on:"tabs:activate:congress2010",action_type:"click",action_name:"us2016-congress-tabs",labels:function(){return{click:"2010"}}},{on:"ticker:pause:us2016-ticker",action_type:"click",action_name:"us-election-2016-ticker-pause"},{on:"ticker:play:us2016-ticker",action_type:"click",action_name:"us-election-2016-ticker-play"},{on:"ticker:previous:us2016-ticker",action_type:"click",action_name:"us-election-2016-ticker-previous"},{on:"ticker:next:us2016-ticker",action_type:"click",action_name:"us-election-2016-ticker-next"},{on:"ni:election:selectStage",action_type:"click",action_name:"ni-stage-select",labels:function(e){return{click:e}}},{on:"election:summary:filter",action_type:"click",action_name:"general-elections-table-filter",labels:function(e){return{click:e}}},{on:"map:fullscreen:enter",action_type:"click",action_name:"us2016-results-map-launcher",labels:{click:"interact"}},{on:"map:search:focus",action_type:"focus",action_name:"us2016-results-map-search-focus",labels:{click:"select-search"}},{on:"region:chosen:select",action_type:"click",action_name:"us2016-results-map-search-select",labels:function(e){return{click:e}}},{on:"reset-clicked",action_type:"click",action_name:"us2016-results-map-reset",labels:{click:"reset-map"}},{on:"map:open:accordion",action_type:"click",action_name:"us2016-results-map-accordion",labels:{click:"open-accordion"}},{on:"region:chosen:mapclick",action_type:"click",action_name:"us2016-results-map-state",labels:function(e){return{click:e}}},{on:"map:fullscreen:exit",action_type:"click",action_name:"us2016-results-map-close",labels:{click:"close-map"}},{on:"news:recommendation:load",action_type:"load",action_name:"news_recommendation",labels:function(e){return{content_name:e.content_name,content_count:e.content_count,rec_source:e.rec_source,rec_set:e.rec_set,breakpoint_type:e.breakpoint_type}}},{on:"news:recommendation:load_fail_api_down",action_type:"load_fail_api_down",action_name:"news_recommendation",labels:function(e){return{breakpoint_type:e.breakpoint_type}}},{on:"news:recommendation:load_fail_low_content_volume",action_type:"load_fail_low_content_volume",action_name:"news_recommendation",labels:function(e){return{breakpoint_type:e.breakpoint_type}}},{on:"betamax:video:playlist_loaded",action_type:"video",action_name:"play",labels:function(e){return{play_type:e.play_type,item_position:e.item_position,episode_id:e.vpid,section:e.section,action_location:e.action_location}}},{on:"vocab:clicked:enabled",action_type:"on",action_name:"vocab_button",labels:{vocab_on:1}},{on:"vocab:clicked:disabled",action_type:"off",action_name:"vocab_button"},{on:"vocab:cookie:vocab-enabled",labels:{vocab_on:1}},{on:"vocab:error",action_type:"vocab-error",action_name:"vocab-cymrufyw",labels:function(e){return{error_message:e}}},{on:"shareTools:visible",action_type:"view",action_name:"end-article-sharetools"},{on:"shareTools:balatarin:clicked",action_type:"share",action_name:"share_balatarin"},{on:"shareTools:extractedbalatarin:clicked",action_type:"share",action_name:"share_extractedbalatarin"},{on:"shareTools:douban:clicked",action_type:"share",action_name:"share_douban"},{on:"shareTools:extracteddouban:clicked",action_type:"share",action_name:"share_extracteddouban"},{on:"shareTools:email:clicked",action_type:"share",action_name:"share_email"},{on:"shareTools:extractedemail:clicked",action_type:"share",action_name:"share_extractedemail"},{on:"shareTools:facebook:clicked",action_type:"share",action_name:"share_facebook"},{on:"shareTools:extractedfacebook:clicked",action_type:"share",action_name:"share_extractedfacebook"},{on:"shareTools:flipboard:clicked",action_type:"share",action_name:"share_flipboard"},{on:"shareTools:extractedflipboard:clicked",action_type:"share",action_name:"share_extractedflipboard"},{on:"shareTools:friendfeed:clicked",action_type:"share",action_name:"share_friendfeed"},{on:"shareTools:extractedfriendfeed:clicked",action_type:"share",action_name:"share_extractedfriendfeed"},{on:"shareTools:googleplus:clicked",action_type:"share",action_name:"share_googleplus"},{on:"shareTools:extractedgoogleplus:clicked",action_type:"share",action_name:"share_extractedgoogleplus"},{on:"shareTools:hatena:clicked",action_type:"share",action_name:"share_hatena"},{on:"shareTools:extractedhatena:clicked",action_type:"share",action_name:"share_extractedhatena"},{on:"shareTools:kaixin:clicked",action_type:"share",action_name:"share_kaixin"},{on:"shareTools:extractedkaixin:clicked",action_type:"share",action_name:"share_extractedkaixin"},{on:"shareTools:kakaostory:clicked",action_type:"share",action_name:"share_kakaostory"},{on:"shareTools:extractedkakaostory:clicked",action_type:"share",action_name:"share_extractedkakaostory"},{on:"shareTools:line:clicked",action_type:"share",action_name:"share_line"},{on:"shareTools:extractedline:clicked",action_type:"share",action_name:"share_extractedline"},{on:"shareTools:linkedin:clicked",action_type:"share",action_name:"share_linkedin"},{on:"shareTools:extractedlinkedin:clicked",action_type:"share",action_name:"share_extractedlinkedin"},{on:"shareTools:livejournal:clicked",action_type:"share",action_name:"share_livejournal"},{on:"shareTools:extractedlivejournal:clicked",action_type:"share",action_name:"share_extractedlivejournal"},{on:"shareTools:meneame:clicked",action_type:"share",action_name:"share_meneame"},{on:"shareTools:extractedmeneame:clicked",action_type:"share",action_name:"share_extractedmeneame"},{on:"shareTools:messengerdesktop:clicked",action_type:"share",action_name:"share_messengerdesktop"},{on:"shareTools:extractedmessengerdesktop:clicked",action_type:"share",action_name:"share_extractedmessengerdesktop"},{on:"shareTools:messengermobile:clicked",action_type:"share",action_name:"share_messengermobile"},{on:"shareTools:extractedmessengermobile:clicked",action_type:"share",action_name:"share_extractedmessengermobile"},{on:"shareTools:mixi:clicked",action_type:"share",action_name:"share_mixi"},{on:"shareTools:extractedmixi:clicked",action_type:"share",action_name:"share_extractedmixi"},{on:"shareTools:moimir:clicked",action_type:"share",action_name:"share_moimir"},{on:"shareTools:extractedmoimir:clicked",action_type:"share",action_name:"share_extractedmoimir"},{on:"shareTools:odnoklassniki:clicked",action_type:"share",action_name:"share_odnoklassniki"},{on:"shareTools:extractedodnoklassniki:clicked",action_type:"share",action_name:"share_extractedodnoklassniki"},{on:"shareTools:pinterest:clicked",action_type:"share",action_name:"share_pinterest"},{on:"shareTools:extractedpinterest:clicked",action_type:"share",action_name:"share_extractedpinterest"},{on:"shareTools:plurk:clicked",action_type:"share",action_name:"share_plurk"},{on:"shareTools:extractedplurk:clicked",action_type:"share",action_name:"share_extractedplurk"},{on:"shareTools:qq:clicked",action_type:"share",action_name:"share_qq"},{on:"shareTools:extractedqq:clicked",action_type:"share",action_name:"share_extractedqq"},{on:"shareTools:renren:clicked",action_type:"share",action_name:"share_renren"},{on:"shareTools:extractedrenren:clicked",action_type:"share",action_name:"share_extractedrenren"},{on:"shareTools:telegram:clicked",action_type:"share",action_name:"share_telegram"},{on:"shareTools:extractedtelegram:clicked",action_type:"share",action_name:"share_extractedtelegram"},{on:"shareTools:twitter:clicked",action_type:"share",action_name:"share_twitter"},{on:"shareTools:extractedtwitter:clicked",action_type:"share",action_name:"share_extractedtwitter"},{on:"shareTools:viber:clicked",action_type:"share",action_name:"share_viber"},{on:"shareTools:extractedviber:clicked",action_type:"share",action_name:"share_extractedviber"},{on:"shareTools:vkontakte:clicked",action_type:"share",action_name:"share_vkontakte"},{on:"shareTools:extractedvkontakte:clicked",action_type:"share",action_name:"share_extractedvkontakte"},{on:"shareTools:wechat:clicked",action_type:"share",action_name:"share_wechat"},{on:"shareTools:extractedwechat:clicked",action_type:"share",action_name:"share_extractedwechat"},{on:"shareTools:weibo:clicked",action_type:"share",action_name:"share_weibo"},{on:"shareTools:extractedweibo:clicked",action_type:"share",action_name:"share_extractedweibo"},{on:"shareTools:whatsapp:clicked",action_type:"share",action_name:"share_whatsapp"},{on:"shareTools:extractedwhatsapp:clicked",action_type:"share",action_name:"share_extractedwhatsapp"},{on:"shareTools:zing:clicked",action_type:"share",action_name:"share_zing"},{on:"shareTools:extractedzing:clicked",action_type:"share",action_name:"share_extractedzing"},{on:"user:firstscroll",action_type:"scroll",action_name:"scroll_first"},{on:"ojComponent:click",action_type:"click",action_name:"wsoj-recs",labels:function(e){return{content_position_rec:e.clickIndex,rec_source:e.recommenderValue,rec_set:e.itemLinks,user_segment:e.userSegment}}},{on:"ojComponent:pageload",action_type:"load",action_name:"wsoj-recs",labels:function(e){return{rec_source:e.recommenderValue,rec_set:e.itemLinks,user_segment:e.userSegment}}},{on:"wsojcomponent:loadError",action_type:"load-fail",action_name:"wsoj-recs"},{on:"sportBanner:refreshButton:clicked",action_type:"click",action_name:"sport_banner_refresh"},{on:"sportBanner:closeButton:clicked",action_type:"click",action_name:"sport_banner_close"},{on:"sportBanner:loaded",action_type:"load",action_name:"sport_banner_loaded"},{on:"sportBanner:fullScorecard:clicked",action_type:"click",action_name:"sport_banner_full_score_card"},{on:"sportBanner:expandButton:clicked",action_type:"click",action_name:"sport_banner_expand"},{on:"sportBanner:collapseButton:clicked",action_type:"click",action_name:"sport_banner_collapse"},{on:"sportBanner:topicLink:clicked",action_type:"click",action_name:"sport_banner_topic_link"}]}}),define("module/navigation/overflow",["module/bootstrap","translator"],function(e,t){function n(n,a,r){function c(){return!!I.filter(function(e){return this.offsetTop>0}).length}function l(){S=o('<li class="navigation__more-button-container">                    <button class="navigation__more-button navigation-arrow" data-panel-id="'+A+'">'+t.get("navMoreButton")+'<span class="off-screen">'+t.get("navMoreLabel")+"</span></button>                </li>"),T=S.find(".navigation__more-button"),E.append(S)}function u(){var t=e.config.features2&&(e.config.features2.rtl||"-rtl"===e.config.cssPostfix)?"padding-left":"padding-right";E.css(t,S.width()+"px"),E.css("max-width",B-S.width()+"px")}function d(){var e;e=new RegExp("\\b"+$+"\\b","i").test(this.className),e&&this.blur(),T.removeClass($)}function h(){var e=o('<div class="navigation-panel__content"><div class="navigation-panel__inner"></div></div>'),t=o('<div class="navigation-panel navigation-panel--wide navigation-panel--closed '+A+'"></div>');t.append(e),P=e.find(".navigation-panel__inner"),n.after(t),p(),t=e=null,r.statsName&&i.emit("component:loaded",r.statsName)}function p(){for(var e,t=I,n=t.length,o=-1,i=[],s=!1;++o<n;){var a=t[o],r=a.offsetTop>0;if(a.className=a.className.replace(/\binvisible\b/,""),r){s||(f(m(t,o)),s=!0);var c=a.cloneNode(!0);c=g(c),i.push(c),a.className+=" invisible"}}e=v(i),P.html(e),w()}function m(t,n){var o=t[n-1].offsetLeft;return o+=e.config.features2&&(e.config.features2.rtl||"-rtl"===e.config.cssPostfix)?-S.width():t[n-1].offsetWidth}function f(e){S.css("left",e+"px")}function g(e){var t=e.getElementsByTagName("a");return t.length&&(t[0].className="navigation-panel-toplevel__link"),e}function v(e){var t=s.documentElement.clientWidth,n=document.createDocumentFragment();_=[],k=e,C=y(t),x=Math.ceil(k.length/C),R();for(var o=0,i=C;o<i;o++){var a=b();a.className+=" navigation-panel-toplevel--columnised-"+C;for(var r=0,c=_[o].length;r<c;r++)a.appendChild(_[o][r].cloneNode(!0));c>0&&n.appendChild(a)}return n}function b(){var e=document.createElement("ul");return e.className="navigation-panel-toplevel",e}function y(e){return e>=N[2]&&e<N[3]?2:e>=N[3]&&e<N[4]?3:4}function w(){E.length&&1===E[0].getElementsByClassName("invisible selected").length?(S&&S.addClass("selected"),r.overflowEvents&&i.emit("nav:selectedIsHidden")):(S&&S.removeClass("selected"),r.overflowEvents&&i.emit("nav:selectedIsVisible"))}var _,k,C,x,S,T,P,E=n.find("ul"),I=E.find("li"),A=E.attr("data-panel-id"),L=!1,N={2:600,3:740,4:1008},B=992,$="navigation__more-button--highlight";r=r||{},this.toggleMoreButtonHighlight=function(){var t;T.hasClass($)?(d(),t="hidden"):(T.addClass($),t="visible"),e.pubsub.emit("stats:nav:wide:"+a+":overflow:visibility",[t])},this.removeMoreButtonHighlight=function(){void 0!==T&&T.removeClass($)},this.checkOverflowStatus=function(){c()?(L=!0,S?(S.removeClass("hidden"),p()):(l(),u(),h())):S&&L&&(L=!1,i.emit("nav:overflowEmpty",[A]),S.addClass("hidden"),d(),p())},this.checkIfSelectedIsOverflowed=function(){w()};var R=function(){var e=0,t=1;return function(){_.push(k.slice(e,e+x)),e+=x,t++,t<=C?R():(e=0,t=1)}}();this.checkOverflowStatus()}var o=e.$,i=e.pubsub,s=e.window.document;return n}),define("module/navigation/wideView",["module/bootstrap","module/navigation/overflow"],function(e,t){function n(){v("body").on("click",".navigation-wide-list a",function(t){e.pubsub.emit("stats:nav:wide:outsidePanel:click",[v(t.currentTarget).text(),t.currentTarget.href,"wide",!1])}),v("body").on("click",".navigation-panel--wide a",function(t){e.pubsub.emit("stats:nav:wide:insidePanel:click",[v(t.currentTarget).text(),t.currentTarget.href,"wide",!0])});var t=".js-navigation-panel-primary li a, .js-navigation-panel-secondary li a";v("body").on("focus",t,function(){h=!1,d=!0}),v("body").on("blur",t,function(){h=!0,d=!1}),v("body").on("focus","#page, .secondary-navigation--wide a, .nations-pseudo-nav",function(){o()&&(e.pubsub.emit("nav:wide:panel:lostFocus"),h=d=!1)}),v("body").on("click",".navigation__more-button",function(t){t.preventDefault(),e.pubsub.emit("nav:more:clicked",t)})}function o(){return!d&&h}function i(){f&&(f.checkOverflowStatus(),f.checkIfSelectedIsOverflowed()),m&&g&&(g.checkOverflowStatus(),g.checkIfSelectedIsOverflowed())}function s(){f.removeMoreButtonHighlight(),g&&g.removeMoreButtonHighlight()}function a(){m.length?(f=new t(p,"primary",{statsName:"wide-navigation-primary-overflow"}),g=new t(m,"secondary",{overflowEvents:!0,statsName:"wide-navigation-secondary-overflow"})):f=new t(p,"primary",{statsName:"wide-navigation-primary-overflow"})}function r(){p=v(".navigation.navigation--wide"),m=v(".navigation-wide-list--secondary"),a(),n()}function c(){b||(r(),b=!0),i(),y=!0}function l(){b&&(s(),y=!1)}function u(e){var t=v(e.currentTarget).attr("data-panel-id");t&&(t.match(/primary/)?(f.toggleMoreButtonHighlight(),g&&g.removeMoreButtonHighlight()):(g.toggleMoreButtonHighlight(),f.removeMoreButtonHighlight()))}var d,h,p,m,f,g,v=e.$,b=!1,y=!1;return{enable:c,disable:l,toggleMoreButtonHighlights:u}}),define("module/navigation/narrowView",["module/bootstrap","translator"],function(e,t){function n(){$("body").on("click",".navigation__section",function(e){e.preventDefault(),R.emit("nav:sections:clicked",e)}),$("body").on("click",".navigation--narrow .navigation-arrow, .navigation--footer .navigation-arrow",function(e){e.preventDefault(),R.emit("nav:arrow:clicked",e)}),$("body").on("click",".navigation__footerButton",function(e){e.preventDefault(),R.emit("nav:footerButton:clicked",e)})}function o(){E=$("#navigation--bottom"),E.find(".navigation-panel").removeAttr("id"),E.find(".navigation-core-title").remove(),E.removeClass("core--with-secondary"),P=E.clone(),P.attr("id","navigation--top")}function i(){e.config.service.replace(/(\w)/,function(e,t){return t.toUpperCase()});I=$(".navigation__footerButton"),A=$(".navigation--footer");var n=$('<button class="navigation__cta-footer navigation__footerButton">'+t.get("navFooterSectionsButton")+"</button>");E.before(n)}function s(){var e=L.find(".secondary-navigation__title span"),t=L.find(".selected .navigation-narrow-item span").text()||e.text();e.text(t)}function a(){N.addClass("navigation__section--enhanced"),N.removeClass("navigation__section--core"),P.addClass("navigation--narrow"),P.removeClass("navigation--bottom"),r(),$(".site-brand").after(P),M&&(c(),s(),$(".site-brand").after(L)),l()}function r(){P.children().first().removeClass("navigation--bottom__toplevel").addClass("navigation--narrow__toplevel")}function c(){if(!1!==M){var t=$("#secondary-navigation--bottom");if(L=$('<div class="secondary-navigation secondary-navigation--narrow secondary-navigation--narrow-closed"></div>'),t){var n=t.clone();n.addClass("secondary-navigation-narrow-list"),n.removeAttr("id"),n.find(".navigation-core-title").remove(),n.find(".navigation-core-index").remove(),n.removeClass("secondary-navigation--bottom"),n.find(".navigation-arrow").on("click",function(t){t.stopPropagation(),t.preventDefault(),e.pubsub.emit("nav:narrow:secondary:arrow:clicked",t)}),t.addClass("hidden"),L.append(n)}}}function l(){return $(".navigation--narrow__toplevel, .navigation--bottom__toplevel").each(function(){var e=$(this).find(".selected .navigation-panel-secondary");if(e.length>0){0===e.find(".selected").length&&e.find("li").first().addClass("selected")}}),this}function u(){return d()||h()}function d(){return L&&L.find("ul .selected").length>0}function h(){return void 0!==L&&0===L.children().length}function p(){u()?R.emit("nav:selectedIsHidden"):R.emit("nav:selectedIsVisible")}function m(){$("body").removeClass(j),e.pubsub.emit(O,["hidden"]),H=!1}function f(){$("body").addClass(j),e.pubsub.emit(O,["visible"]),H=!0}function g(e){H?m():f()}function v(){var e,t=$(".secondary-navigation--narrow");t.hasClass("secondary-navigation--narrow-closed")?(t.removeClass("secondary-navigation--narrow-closed"),e="visible"):(t.addClass("secondary-navigation--narrow-closed"),e="hidden"),b(e)}function b(t){e.pubsub.emit("stats:nav:narrow:secondary:visibility",t)}function y(){void 0!==L&&(L.addClass("secondary-navigation--narrow-closed"),b("hidden"))}function w(t){var n=t.currentTarget;if(n&&n.href){var o,i=n.href.replace(/.+bbc\.co\.uk/i,""),s="navigation-arrow--open",a=$('.navigation-arrow[href="'+i+'"]'),r=a.find("span").eq(0).text(),c="navigation-list-item--open";$(".navigation--bottom__toplevel .navigation-arrow--open, .navigation--narrow__toplevel .navigation-arrow--open").not(a).removeClass(s),$("."+c).removeClass(c),a.hasClass(s)?(a.removeClass(s),o="hidden"):(a.addClass(s),$(n).parent().addClass(c),o="visible"),e.pubsub.emit("stats:nav:narrow:top:primary:accordion:visibility",[o,r])}}function _(){var e,t="navigation__footer--open";A.hasClass(t)?(A.removeClass(t),e="hidden"):(A.addClass(t),e="visible"),R.emit("stats:nav:narrow:footer:visibility",[e])}function k(){p()}function C(){$(".navigation-arrow--open").removeClass("navigation-arrow--open"),M&&L&&L.addClass("secondary-navigation--narrow-closed"),N.removeClass("navigation__section--open"),$("body").removeClass("narrow-primary-navigation-open")}function x(){N=$(".navigation__section"),B=$("#page"),n(),o(),i(),a(),p(),D=!0,R.emit("nav:narrow:loaded")}function S(){D?k():x()}function T(){D&&C()}var P,E,I,A,L,N,B,$=e.$,R=e.pubsub,D=(e.window,!1),M=!0,H=!1,O="stats:nav:narrow:primary:visibility",j="narrow-primary-navigation-open";return{enable:S,disable:T,togglePrimaryNav:g,toggleSecondaryNav:v,hidePrimaryNav:m,hideSecondaryNav:y,accordionNavItem:w,publishSelectedVisibilityState:p,toggleFooterNav:_}}),define("module/navigation/panels",["module/bootstrap"],function(e){function t(e){return c[e]||(c[e]=a("."+e)),c[e]}function n(e){var t=e?[a("."+e)]:c;for(var n in t)t[n].hasClass(l)||t[n].addClass(l);r.emit("nav:overflow:toggle","hidden")}function o(){a(".navigation--narrow__toplevel .navigation-arrow").each(function(e,t){var n=a(t).attr("data-panel-id");n&&(c[n]=a("."+n))})}function i(){c["navigation-panel--wide"]=a(".navigation-panel--wide")}function s(e){var o,i=e.currentTarget,s=a(i).attr("data-panel-id"),c=t(s);return c.hasClass(l)?(n(),c.removeClass(l),o=!0,r.emit("nav:overflow:toggle","visible")):(c.addClass(l),o=!1,r.emit("nav:overflow:toggle","hidden")),o}var a=e.$,r=e.pubsub,c={},l="navigation-panel--closed";return{cacheNarrow:o,cacheWide:i,close:n,togglePanel:s}}),define("module/indexTitle",["module/bootstrap"],function(e){function t(){if(void 0===n){var t=e.$(o),i=t.data("index-title-meta")||null,s=!1,a=!1;i&&i.opts&&(s=i.opts.alwaysVisible||!1,a=i.opts.onFrontPage||!1),n={element:t,alwaysVisible:s,onFrontPage:a}}return n}var n,o="#comp-index-title",i="index-title--redundant",s=function(){},a=function(){},r=function(t){var n=e.$(o+" .index-title__container"),i=0!==n.length?n:e.$(o);0!==i.length&&i.html(t)},c=function(){t().onFrontPage||t().element.removeClass(i)},l=function(){t().alwaysVisible||t().element.addClass(i)};return{getIndexTitle:t,setTitleHtml:r,setAnchorAttribute:s,appendToTitle:a,show:c,hide:l,toggle:function(){t().element.hasClass(i)?c():l()},init:function(){t().onFrontPage||c()}}}),define("module/navigation/mediator",["module/navigation/wideView","module/navigation/narrowView","module/navigation/panels","module/indexTitle","module/components/mediaPlayer/main"],function(e,t,n,o,i){function s(){i.showFlashPlayers(),e.disable(),n.close(),t.enable(),n.cacheNarrow()}function a(){t.disable(),e.enable(),n.cacheWide()}function r(){e.enable(),n.cacheWide()}function c(){t.togglePrimaryNav(),o.toggle()}function l(){t.hidePrimaryNav(),t.hideSecondaryNav()}function u(e){t.accordionNavItem(e),n.togglePanel(e)}function d(){t.toggleSecondaryNav()}function h(t){e.toggleMoreButtonHighlights(t),n.togglePanel(t)}function p(e){t.toggleFooterNav(e)}function m(){t.publishSelectedVisibilityState()}function f(){n.close(),i.showFlashPlayers()}function g(e){n.close(e)}function v(){o.hide()}function b(){o.show()}return{enableWideStrategy:a,refreshWideStrategy:r,enableNarrowStrategy:s,toggleNarrowNav:c,toggleNarrowFooterNav:p,toggleNarrowSecondaryNav:d,toggleNarrowNavItem:u,toggleWideOverflow:h,hideNarrowNav:l,publishSelectedVisibilityState:m,closePanels:f,closePanel:g,hideIndexTitle:v,showIndexTitle:b,showMediaPlaceholder:i.showFlashPlayers,hideMediaPlaceholder:i.hideFlashPlayers}}),define("module/navigation/handler",["module/bootstrap","module/featureDetector","module/navigation/mediator"],function(e,t,n){function o(){k.on("global:resize",r),k.on("global:group:changed",a),k.on("nav:strategy:changed",c),k.on("nav:strategy:unchanged",l),k.on("nav:footerButton:clicked",u),k.on("nav:arrow:clicked",d),k.on("nav:more:clicked",h),k.on("nav:sections:clicked",p),k.on("nav:narrow:secondary:arrow:clicked",m),k.on("findLocal:overlayVisible",f),k.on("nav:wide:panel:lostFocus",g),k.on("nav:overflowEmpty",v),k.on("nav:selectedIsVisible",b),k.on("nav:selectedIsHidden",y),k.on("nav:overflow:toggle",_)}function i(e){return e>2}function s(e){return!1===i(e)}function a(e){s(e)?n.enableNarrowStrategy():n.enableWideStrategy()}function r(e){i(e)&&n.refreshWideStrategy()}function c(e){
"narrow"===e?n.enableNarrowStrategy():"wide"===e&&n.enableWideStrategy()}function l(e){"wide"===e&&n.refreshWideStrategy()}function u(e){n.toggleNarrowFooterNav(e)}function d(e){n.toggleNarrowNavItem(e)}function h(e){n.toggleWideOverflow(e)}function p(e){n.toggleNarrowNav()}function m(e){n.toggleNarrowSecondaryNav()}function f(){n.hideNarrowNav()}function g(){n.closePanels()}function v(e){n.closePanel(e)}function b(){n.hideIndexTitle()}function y(){n.showIndexTitle()}function w(e){o()}function _(e){"visible"===e?n.hideMediaPlaceholder():n.showMediaPlaceholder()}var k=e.pubsub;return{init:w}}),define("module/hotspot/reflow",["module/bootstrap"],function(e){function t(){if(n(),o())for(var e=0;e<c.length;e++)i(u(c[e]),u(l[e]))}function n(){c=[],l=[],r.each(function(){this.firstElementChild?c.push(this):l.push(this)})}function o(){return l.length>=c.length}function i(e,t){e.children().detach().appendTo(t),t.removeClass(d),e.addClass(d)}function s(){r.removeClass("hotspot--hidden")}function a(e){r=e}var r,c,l,u=e.$,d="hotspot--empty";return{init:a,execute:t,unmask:s}}),define("module/windowHelper",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){function n(n){e.$(e.window).on("resize",t.debounce(n,100))}function o(){return e.window.innerWidth}return{getInnerWidth:o,onResize:n}}),define("module/strategiser",["module/bootstrap","module/windowHelper"],function(e,t){function n(){for(var e,n=1;n<=4;n++)t.getInnerWidth()>=d[n]&&(e=n);return e}function o(){s(),i()?(u.trigger("strategyChange",c),e.pubsub.emit("global:group:changed",c)):e.pubsub.emit("global:resize",c)}function i(){return c!==l}function s(){l=c,c=n()}function a(e){u.on("strategyChange",e)}function r(){o(),t.onResize(o)}var c,l,u=e.$({}),d={1:0,2:400,3:600,4:1008};return{init:r,determineStrategy:n,subscribeToStrategyChange:a}}),define("module/hotspot/handler",["module/bootstrap","module/hotspot/reflow","module/strategiser"],function(e,t,n){function o(){n.subscribeToStrategyChange(function(e,t){i(t)})}function i(e){a!==e&&(null===a&&4===e?t.execute():void 0!==r[e][a]&&t.execute(),null==a&&t.unmask(),a=e)}function s(){var s=e.$(".hotspot");s.length<2||(t.init(s),i(n.determineStrategy()),o())}var a=null,r={1:{4:1},2:{4:1},3:{4:1},4:{1:1,2:1,3:1}};return{init:s}}),define("module/dotcom/facade",["module/bootstrap"],function(e){return{onResize:function(){e.window&&e.window.bbcdotcom&&void 0!==e.window.bbcdotcom.reset&&e.window.bbcdotcom.reset()}}}),define("module/dotcom/handler",["module/bootstrap","module/dotcom/facade"],function(e,t){function n(){s.on("global:resize",o),s.on("global:group:changed",o)}function o(e){t.onResize()}function i(e){n()}var s=e.pubsub;return{init:i}}),define("module/tableScroll",["module/bootstrap"],function(e){function t(){for(var e=document.getElementsByClassName("responsive-table-container"),t=e.length,i=0;i<t;)e[i].addEventListener("touchstart",n,!1),e[i].addEventListener("touchmove",o,!1),i++}function n(e){r=e.currentTarget.scrollLeft+e.touches[0].pageX}function o(e){var t=e.currentTarget;(i(t,e)||s(t,e))&&e.preventDefault(),t.scrollLeft=r-e.touches[0].pageX}function i(e,t){return e.scrollLeft<e.scrollWidth-e.offsetWidth&&e.scrollLeft+t.touches[0].pageX<r-5}function s(e,t){return 0!==e.scrollLeft&&e.scrollLeft+t.touches[0].pageX>r+5}function a(){return!!navigator.userAgent.match(/Android 2/i)}var r=0;return{init:function(){a()&&t()}}}),define("module/components/handler",["module/bootstrap"],function(e){return{handleSuccess:function(t,n){var o=e.$(t.selector);if(o){var i=document.createElement("div");i.innerHTML=n,o.replaceWith(i.childNodes)}},enable:function(t){var n=e.$(t.selector);n&&n.removeClass("hidden")},disable:function(t){var n=e.$(t.selector);n&&n.addClass("hidden")}}}),define("module/components/loader",["module/bootstrap","module/components/handler","deviceInspector","config"],function(e,t,n,o){var i={components:{},batchStore:[],device:"",register:function(e){this.components[e.id]=e},registerComponentsFromDom:function(){for(var t=e.$("[data-comp-meta]"),n=t.length-1;n>=0;n--){var o=e.$(t[n]).data("comp-meta");o&&(o.selector="#"+t[n].id,this.register(o))}},init:function(t){t=t||{},this.registerComponentsFromDom(),n=t.deviceInspector||n,this.device=n.getGroup(),this.processComponents(),e.pubsub.on("deviceGroup",function(e){i.device=e,i.processComponents()})},processComponents:function(){for(var t in this.components){var n=this.components[t],o=this.shouldShow(n.deviceGroups);!n.loaded&&o?i.load(n):n.loaded&&!o?this.callHandler(n,"disable"):n.loaded&&o&&this.callHandler(n,"enable")}this.requestComponents(this.batchStore),e.pubsub.emit("loader:process:done")},load:function(e){switch(e.opts.loading_strategy){case"post_load":this.requestComponents([e]);break;case"batch_load":this.batchStore.push(e);break;default:this.callHandler(e,"handleSuccess")}e.loaded=!0},shouldShow:function(e){return!e||-1!==e.indexOf(i.device)},requestComponents:function(t){var n=t.length,i={batch:{}};if(n){for(;n--;){var s=t[n],a=s.type||s.name;s.opts.loading_strategy="include_content",i.batch[a]={opts:s.opts,id:s.id},s.template&&(i.batch[a].template=s.template)}var r=e.$.param(i),c=o.pathPrefix+(o.languageVariant?"/"+o.languageVariant:"")+"/components?"+r;e.$.ajax({url:c,dataType:"json",success:e.$.proxy(this.processResponse,this)})}},processResponse:function(e){var t;for(var n in e){t=i.components[n];var o=e[n];i.callHandler(t,"handleSuccess",o)}i.batchStore=[]},callHandler:function(e,n,o){var s=e.handler;"default"===s?(t[n].call(t,e,o),i.emitEvent(e,n)):require(["module/components/"+s],function(s){s[n]?s[n].call(s,e,o):t[n].call(t,e,o),i.emitEvent(e,n)})},emitEvent:function(t,n){var o="handleSuccess"===n?"loaded":n;e.pubsub.emit("component:"+o,[t.name,t])}};return i}),define("module/localisation/scriptToggle",["module/bootstrap","deviceInspector"],function(e,t){var n=e.$,o={zhongwen:["simp","trad"],ukchina:["simp","trad"],serbian:["lat","cyr"]},i={zhongwen:"ckps_chinese",ukchina:"ckps_chinese",serbian:"ckps_serbian"};return{init:function(){if(!e.config.isWorldService)return!1;var t=e.config.service,n=o.hasOwnProperty(t),i=document.querySelector(".script-toggle");if(!n||!i)return!1;this.bindEvents(t)},bindEvents:function(e){var t=this;n(".script-toggle").on("click",function(o){var i=t.getVariant(e,n(this));t.setCookie(e,i)})},getVariant:function(e,t){var i=t.attr("data-variant"),s=o[e];return i&&-1!==n.inArray(i,s)?i:null},setCookie:function(t,n){if(!i.hasOwnProperty(t)||!n)return!1;var o=window.location.hostname.match(/com/)?".bbc.com":".bbc.co.uk";document.cookie=i[t]+"="+n+"; expires="+new Date((new Date).getTime()+31536e6).toGMTString()+"; path=/; domain="+o,e.pubsub.emit("scriptToggle:cookieSaved",[{name:i[t],value:n}])}}}),define("module/commentCounts",["module/bootstrap","config"],function(e,t){var n=e.$,o=e.$({}),i=!1;return{init:function(e){var s,a=[];if(s=e?e+" .js-comment-count":".js-comment-count",n(s).each(function(){a.push(n(this).attr("data-comments-id"))}),a.length>0){var r=t.commentsHost;window.location.hostname.match(/bbc.com/)&&(r=r.replace("bbc.co.uk","bbc.com")),n.getScript(r+"/modules/comments/getcount/?items="+a.toString(),function(){i||(i=!0,o.trigger("commentsButtonCodeCanRun"))})}else i||(i=!0,o.trigger("commentsButtonCodeCanRun"))},onCommentsButtonCodeCanRun:function(e){o.on("commentsButtonCodeCanRun",e)}}}),define("module/initialiser",["module/bootstrap","module/navigation/handler","module/hotspot/handler","module/dotcom/handler","module/indexTitle","module/tableScroll","module/components/loader","module/strategiser","module/localisation/scriptToggle","module/commentCounts"],function(e,t,n,o,i,s,a,r,c,l){function u(){a.init(),s.init(),l.init(),i.init(),t.init(),n.init(),o.init(),c.init(),r.init()}return{init:u}}),define("module/urlShrinker",["module/bootstrap"],function(e){var t=e.$;return{find:function(e){return this.links=t(e),this},bindEvents:function(){this.links.on("click",this.shorten),e.pubsub.emit("urlShrinker:eventsBinded")},shorten:function(){var e=this.getAttribute("data-target-url"),n=this.getAttribute("data-social-url");t.ajax({async:!1,url:"http://www.bbc.co.uk/modules/sharetools/v1/shrink.json?url="+encodeURIComponent(e),success:t.proxy(function(e,t,o){this.href=n+e.url},this)})}}}),function(){function e(e,t,n){"use strict";var o=window.document.createElement("link"),i=t||window.document.getElementsByTagName("script")[0],s=window.document.styleSheets;return o.rel="stylesheet",o.href=e,o.media="only x",i.parentNode.insertBefore(o,i),o.onloadcssdefined=function(e){for(var t,n=0;n<s.length;n++)s[n].href&&s[n].href===o.href&&(t=!0);t?e():setTimeout(function(){o.onloadcssdefined(e)})},o.onloadcssdefined(function(){o.media=n||"all"}),o}function t(e,t){e.onload=function(){e.onload=null,t&&t.call(e)},"isApplicationInstalled"in navigator&&"onloadcssdefined"in e&&e.onloadcssdefined(t)}!function(n){var o=function(i,s){"use strict";if(i&&3===i.length){var a=n.navigator,r=n.document,c=n.Image,l=!(!r.createElementNS||!r.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!r.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||n.opera&&-1===a.userAgent.indexOf("Chrome")||-1!==a.userAgent.indexOf("Series40")),u=new c;u.onerror=function(){o.method="png",o.href=i[2],e(i[2])},u.onload=function(){var n=1===u.width&&1===u.height,a=i[n&&l?0:n?1:2];o.method=n&&l?"svg":n?"datapng":"png",o.href=a,t(e(a),s)},u.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",r.documentElement.className+=" grunticon"}};o.loadCSS=e,o.onloadCSS=t,n.grunticon=o}(this),function(e,t){"use strict";var n,o=t.document,i="grunticon:",s=function(e){if(o.attachEvent?"complete"===o.readyState:"loading"!==o.readyState)e();else{var t=!1;o.addEventListener("readystatechange",function(){t||(t=!0,e())},!1)}},a=function(e){return t.document.querySelector('link[href$="'+e+'"]')},r=function(e,t){if(n&&!t)return n;n={};var o,s,a,r,c,l;if(!(o=e.sheet))return n;s=o.cssRules?o.cssRules:o.rules;for(var u=0;u<s.length;u++)a=s[u].cssText,r=i+s[u].selectorText,(c=a.split(");")[0].match(/US\-ASCII\,([^"']+)/))&&c[1]&&(l=decodeURIComponent(c[1]),n[r]=l);return n},c=function(e,t){var n,s,a,r,c;t?n=e:(t=e,n=o),r="data-grunticon-embed";for(var l in t){c=l.slice(i.length);try{s=n.querySelectorAll(c)}catch(e){continue}a=[];for(var u=0;u<s.length;u++)null!==s[u].getAttribute(r)&&a.push(s[u]);if(a.length)for(u=0;u<a.length;u++)a[u].innerHTML=t[l],a[u].style.backgroundImage="none",a[u].removeAttribute(r)}return a},l=function(t,n){"svg"===e.method&&s(function(){var o=r(a(e.href));"function"==typeof n?(c(t,o),n()):c(o),"function"==typeof t&&t()})};e.embedIcons=c,e.getCSS=a,e.getIcons=r,e.ready=s,e.svgLoadedCallback=l,e.embedSVG=l}(grunticon,this),function(e,t){"use strict";var n=t.document,o=function(e,n){var o=new t.XMLHttpRequest;return"withCredentials"in o?o.open("GET",e,!0):void 0!==t.XDomainRequest&&(o=new t.XDomainRequest,o.open("GET",e)),n&&(o.onload=n),o.send(),o},i=function(t){"svg"===e.method&&e.ready(function(){o(e.href,function(){var o=n.createElement("style");o.innerHTML=this.responseText;var i=e.getCSS(e.href);i&&(i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),e.embedIcons(e.getIcons(o)),"function"==typeof t&&t())})})};e.ajaxGet=o,e.svgLoadedCORSCallback=i,e.embedSVGCors=i}(grunticon,this)}(),define("vendor/grunticon-loader",function(){}),define("module/iconLoader",["module/bootstrap","vendor/grunticon-loader"],function(e){return{init:function(){var t=window.grunticon,n=e.config;t([n.staticPrefix+"/icons/generated/icons.data.svg.css",n.staticPrefix+"/icons/generated/icons.data.png.css",n.staticPrefix+"/icons/generated/icons.fallback.css"],function(){t.embedSVGCors()})}}}),define("module/noTouchDetectionForCss",["module/bootstrap","module/featureDetector"],function(e,t){t.is("TouchDevice")||e.$("body").addClass("no-touch")}),define("module/components/commentCountAdapter",["module/commentCounts"],function(e){var t=function(t){e.init(t)};return t(),{onCommentsButtonCodeCanRun:e.onCommentsButtonCodeCanRun,reProcess:t}}),define("module/components/fauxBlockLink",["module/bootstrap"],function(e){var t=function(t){var n;n=t?t+" .faux-block-link":".faux-block-link";var o=e.$(n);o.on("mouseover",".faux-block-link__overlay-link",function(e){e.delegateTarget.className+=" faux-block-link--hover"}),o.on("mouseout",".faux-block-link__overlay-link",function(e){e.delegateTarget.className=e.delegateTarget.className.replace(/ faux-block-link--hover/,"")})};return t(),{reProcess:t}}),define("module/components/responsiveImage",["module/imageenhancer"],function(e){var t=new e;return{reProcess:function(){t.changeDivsToImgs(),t.initResizeImages()}}}),define("module/timestamp",["module/bootstrap","translator"],function(e,t){var n=function(t,n){this.time=t,this.insertTime(n),e.pubsub.emit("timestamp:relative:done",!0)};return n.prototype.insertTime=function(t){var n;n=t?t+" .date":".date";for(var o=e.$(n),i=0,s=o.length;i<s;i++){var a=o.get(i);if(void 0!==a.getAttribute("data-timestamp-inserted")&&0===e.$(".live",a.parentElement).length){if(void 0!==typeof a.getAttribute("data-seconds")){var r=Math.abs(Math.ceil(this.time/1e3-parseInt(a.getAttribute("data-seconds"),10))),c=this.timeAgoInWords(r);if(null!==c)a.innerHTML=c,a.className+=" relative-time";else if(""===a.innerHTML){var l=document.createElement("p");l.innerHTML=a.getAttribute("data-datetime"),l.className=a.className,a.parentNode.insertBefore(l,a)}a.setAttribute("data-timestamp-inserted",!0)}}}},n.prototype.russianRelativeTime=function(e,t,n,o){var i=e%10;return 1===i&&(1===e||e>20)?t:i>1&&i<5&&(e>20||e<10)?n:o},n.prototype.gaelicRelativeTime=function(e,t,n,o){return 1===e?t:2===e?n:o},n.prototype.minutesAgo=function(e){switch(t.getLocale()){case"ru":case"ru-UK":return this.russianRelativeTime(e,t.get("singularMinutesAgo"),t.get("genSingularMinutesAgo"),t.get("genPluralMinutesAgo")).replace("{x}",e);case"gd":return this.gaelicRelativeTime(e,t.get("singularMinutesAgo"),t.get("dualMinutesAgo"),t.get("pluralMinutesAgo")).replace("{x}",e);default:return 1===e?t.get("oneMinuteAgo"):t.get("xMinutesAgo").replace("{x}",e)}},n.prototype.hoursAgo=function(e){switch(t.getLocale()){case"ru":case"ru-UK":return this.russianRelativeTime(e,t.get("singularHoursAgo"),t.get("genSingularHoursAgo"),t.get("genPluralHoursAgo")).replace("{x}",e);case"gd":return this.gaelicRelativeTime(e,t.get("singularHoursAgo"),t.get("dualHoursAgo"),t.get("pluralHoursAgo")).replace("{x}",e);default:return 1===e?t.get("oneHourAgo"):t.get("xHoursAgo").replace("{x}",e)}},n.prototype.timeAgoInWords=function(n){var o=Math.floor(n/60),i=Math.floor(n/3600);return o<1?t.get("lessThanAMinuteAgo"):i<1?this.minutesAgo(o):i<10?this.hoursAgo(i):(e.pubsub.emit("timestamp:relative:done",!0),null)},n}),define("module/components/timestampAdaptor",["module/timestamp"],function(e){var t=function(t){new e(new Date((new Date).toUTCString()).getTime(),t)};return t(),{reProcess:t}}),define("module/polyfill/location.origin",[],function(){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))}),define("module/base",["module/bootstrap","module/stats/statsSubscriber","module/stats/statsConfig","module/initialiser","module/urlShrinker","deviceInspector","module/iconLoader","module/stats/comscore","module/noTouchDetectionForCss","module/components/commentCountAdapter","module/components/fauxBlockLink","module/components/responsiveImage","module/components/timestampAdaptor","module/polyfill/location.origin"],function(e,t,n,o,i,s,a,r){function c(){e.config.service||(e.config={service:"news"})}var l=function(){function t(t){var n=/device--(?:feature|smart|tablet|wide)/,o=document.body.className.split(" "),i=o.length,s=-1;for(/^group\d$/.test(t)&&(n=/device--group/);++s<i;)n.test(o[s])&&e.$("body").removeClass(o[s])}function n(n){o!==n&&(o=n,t(n),e.$("body").addClass("device--"+n))}var o;return e.pubsub.on("deviceGroup",function(e){n(e)}),e.pubsub.on("deviceType",function(e){n(e)}),{setBodyClass:n}}();return{init:function(u){if(a.init(),i.find(".shortenUrl").bindEvents(),e.config.features2.comscore_analytics){new r(e.config).sendPageViewBeacon()}new t(n),l.setBodyClass(s.getGroup()),l.setBodyClass(s.getType()),c(),o.init()}}}),define("module/blog/blogButton",["module/bootstrap"],function(e){var t=function(t){return this.element=e.$('<button class="blog__show-more"><span class="cta">'+t+'</span><span class="spin"></span></button>'),this.bindEvents(),this.listen(),this.element};return t.prototype={bindEvents:function(){this.element.on("click",function(t){t.preventDefault(),e.pubsub.emit("stories:more:request")})},listen:function(){e.pubsub.on("stories:more:loading",e.$.proxy(this.handleLoading,this)),e.pubsub.on("stories:more:success",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("stories:more:error",e.$.proxy(this.handleError,this)),e.pubsub.on("stories:fullyloaded",e.$.proxy(this.handleFullyLoaded,this))},handleLoading:function(e){this.element.attr("disabled","disabled")},handleSuccess:function(e){this.element.removeAttr("disabled")},handleError:function(e){this.element.remove()},handleFullyLoaded:function(e){this.element.remove()}},{create:function(e){return new t(e)}}}),define("module/components/shareTools",["module/bootstrap"],function(e){var t=e.$;return{handleSuccess:function(e){var n=t(e.selector),o=n.find(".share__button"),i=n.find(".share");o.on("click",t.proxy(this.toggleShareToolsVisibility,this,i,o))},toggleShareToolsVisibility:function(e,t,n){e.toggleClass("show"),t.toggleClass("active"),n.preventDefault()}}}),define("module/components/blog",["module/bootstrap","module/blog/blogButton","module/imageenhancer","module/components/mediaPlayer/main","module/timestamp","module/components/shareTools","module/components/mediaPlayer/main","translator"],function(e,t,n,o,i,s,a,r){var c=e.$,l={init:function(n){!function(){var t=["Webkit","Moz"],n=[];for(var o in t)n.push(document.body.style[t[o]+"AnimationName"]);e.$("html").addClass(c.inArray("",n)>-1?"css-anim":"animated-gif")}(),this.enhanceContent(),this.container=c(n.selector),this.nextStoriesLink=this.hasNextStories(this.container),this.requesting=!1,this.requestCount=0,this.nextStoriesLink&&(this.bindEvents(),this.container.after(t.create(r.get("moreStories")))),this.bindShareButtons(this.container)},enhanceContent:function(){new n(".story-body figure img,.story-body .HTML5figure img"),new i(new Date((new Date).toUTCString()).getTime()),o.processNewPlayers()},bindEvents:function(){e.pubsub.on("stories:more:success",c.proxy(function(e){this.handleSuccess(e)},this)),e.pubsub.on("stories:more:error",c.proxy(function(){this.handleError()},this)),e.pubsub.on("stories:more:request",c.proxy(function(){this.handleRequest()},this)),e.pubsub.on("stories:more:loading",c.proxy(function(){this.handleLoading()},this))},hasNextStories:function(e){return e.attr("data-next")},setRequesting:function(e){this.requesting=e},setNextStoriesLink:function(t){this.nextStoriesLink=this.hasNextStories(t),this.nextStoriesLink||e.pubsub.emit("stories:fullyloaded")},handleRequest:function(){this.requesting||this.getMoreStories(this.nextStoriesLink)},handleLoading:function(){this.setRequesting(!0)},handleSuccess:function(e){e=c(e),this.setRequesting(!1),this.setNextStoriesLink(e),this.insertStoriesIntoDom(e.children()),this.enhanceContent()},handleError:function(){this.setRequesting(!1)},insertStoriesIntoDom:function(e){this.container.append(e),this.bindShareButtons(e),a.processNewPlayers()},getRequestCount:function(){return this.requestCount},getMoreStories:function(t){t&&(this.requestCount++,e.pubsub.emit("stories:more:loading"),c.ajax({url:t,success:c.proxy(function(t){e.pubsub.emit("stories:more:success",[t,{requestCount:this.getRequestCount()}])},this),error:c.proxy(function(){e.pubsub.emit("stories:more:error")},this)}))},bindShareButtons:function(e){e.find(".js-share-tools").each(function(e,t){s.handleSuccess({selector:"#"+t.id})})}};return{handleSuccess:function(e,t){l.init.apply(l,arguments)},init:function(e){var t={selector:e.selector};l.init.apply(l,[t])}}}),define("module/blog/blogAdapter",["module/bootstrap","module/components/blog"],function(e,t){var n=e.$,o=n("#comp-blog");if(o.length){var i=o.data("comp-meta");if(i){var s={id:i.id||"",type:i.type||"",handler:i.handler||"",deviceGroups:i.deviceGroups||null,loaded:!0,selector:"#comp-blog",template:i.template};t.init(s)}}}),define("module/components/adverts",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){var n=t.debounce(function(){bbcdotcom.adverts.layout.reset()},150);return{handleSuccess:function(t){"undefined"!=typeof bbcdotcom&&void 0!==bbcdotcom.objects&&bbcdotcom.objects("bbcdotcom.adverts.slot")&&e.$(window).on("resize",n)}}}),define("module/components/advertsAdapter",["module/components/adverts"],function(e){e.handleSuccess()}),define("module/poller",["module/bootstrap"],function(e){function t(t,n){return e.$.extend(t,n)}function n(e){var t="cachebuster="+Math.floor((new Date).getTime()/1e3);return e.indexOf("?")>0?e+"&"+t:e+"?"+t}function o(e){return e&&e>=3e4}function i(e){var t=!1;return"clientdirective"in e&&"pollPeriod"in e.clientdirective&&(t=e.clientdirective.pollPeriod),"pollPeriod"in e&&(t=e.pollPeriod),!(!s(t)&&(t=parseInt(t,10),isNaN(t)))&&(0===this.updateFrequency&&(t=!1),t)}function s(e){return"number"==typeof e}var a=function(e,n,o){this.setPollingTime(e),this.options={timeout:1e4},this.setUrl(n),this.polling=!1,this.options=t(this.options,o),this.cacheBusting=!1};return a.prototype={setUrl:function(e){this.url=e},buildUrl:function(){return this.cacheBusting?n(this.url):this.url},setPollingTime:function(e){s(e)&&e>=30&&e<=7200&&(this.updateFrequency=1e3*e)},startPolling:function(e){this.polling=!0,this.options=t(this.options,e),this.poll()},stopPolling:function(){this.polling=!1},poll:function(){if(this.polling&&this.url){var t=this.options.callbackName||"callback",n=this;e.$.ajax({url:n.buildUrl(),dataType:"jsonp",timeout:this.options.timeout,jsonpCallback:t,method:"get",success:function(e){var t=i(e);if(o(t)?(n.updateFrequency=t,n.rePoll()):n.stopPolling(),n.options.success){var s=n.options.success(e);n.url=s||n.url}},error:function(e){n.options.error&&n.options.error(e)}})}},rePoll:function(){if(this.updateFrequency){var e=this;window.setTimeout(function(){e.poll()},e.updateFrequency)}},stopCacheBusting:function(){this.cacheBusting=!1},startCacheBusting:function(){this.cacheBusting=!0}},a}),define("module/components/breakingNews/storage",[],function(){function e(e){return s[e]}function t(e,t){s[e]=t}function n(t){return localStorage.getItem(t)||e(t)}function o(e,n){t(e,n);try{localStorage.setItem(e,n)}catch(e){}}var i={},s={};return i.articleAlreadySeen=function(e){return n("news/breaking-news-last-seen")===e.toString()},i.setArticleAsSeen=function(e){o("news/breaking-news-last-seen",e.toString())},i}),define("module/components/breakingNews/view",["module/bootstrap"],function(e){function t(){a.off("click","button"),a.empty()}function n(){return e.$("#breaking-news-container")}function o(){a.hide(),i(),t()}function i(){"BODY"!==s.tagName&&s.focus()}var s,a,r={},c=(e.window.document,e.$({}));return r.getAssetIdFromHtml=function(t){var n=e.$;try{n=e.$(t)}catch(e){return""}return n.find("a").data("asset-id")},r.insert=function(e){a=n(),a.show(),a.html(e),s=document.activeElement,a.on("click","button",function(){o(),c.trigger("close")})},r.getPollingUrl=function(){return n().data("polling-url")},r.onClose=function(e){c.on("close",e)},r}),define("module/components/breakingNews/main",["module/bootstrap","module/poller","module/components/breakingNews/storage","module/components/breakingNews/view"],function(e,t,n,o){function i(){r.startPolling({callbackName:"breakingNews",success:function(e){if(e&&e.html){var t=o.getAssetIdFromHtml(e.html);!t||n.articleAlreadySeen(t)||s(t)||(n.setArticleAsSeen(t),o.insert(e.html),a())}}})}function s(e){return window.config&&window.config.asset&&window.config.asset.asset_id===e.toString()}function a(){r.stopPolling()}var r,c={};return c.init=function(){var e=o.getPollingUrl();e&&(r=new t(6e4,5e3),r.setUrl(e),i(),o.onClose(function(){i()}))},c}),define("module/components/breakingNewsAdapter",["module/components/breakingNews/main"],function(e){e.init()}),function(e){"function"==typeof define&&define.amd?define("vendor/xdomainrequest/xdomainrequest",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){if(e.support.cors||!e.ajaxTransport||!window.XDomainRequest)return e;var t=/^(https?:)?\/\//i,n=/^get|post$/i,o=new RegExp("^(//|"+location.protocol+")","i");return e.ajaxTransport("* text html xml json",function(i,s,a){if(i.crossDomain&&i.async&&n.test(i.type)&&t.test(i.url)&&o.test(i.url)){var r=null;return{send:function(t,n){var o="",a=(s.dataType||"").toLowerCase();r=new XDomainRequest,/^\d+$/.test(s.timeout)&&(r.timeout=s.timeout),r.ontimeout=function(){n(500,"timeout")},r.onload=function(){var t="Content-Length: "+r.responseText.length+"\r\nContent-Type: "+r.contentType,o={code:200,message:"success"},i={text:r.responseText};try{if("html"===a||/text\/html/i.test(r.contentType))i.html=r.responseText;else if("json"===a||"text"!==a&&/\/json/i.test(r.contentType))try{i.json=e.parseJSON(r.responseText)}catch(e){o.code=500,o.message="parseerror"}else if("xml"===a||"text"!==a&&/\/xml/i.test(r.contentType)){var s=new ActiveXObject("Microsoft.XMLDOM");s.async=!1;try{s.loadXML(r.responseText)}catch(e){s=void 0}if(!s||!s.documentElement||s.getElementsByTagName("parsererror").length)throw o.code=500,o.message="parseerror","Invalid XML: "+r.responseText;i.xml=s}}catch(e){throw e}finally{n(o.code,o.message,i,t)}},r.onprogress=function(){},r.onerror=function(){n(500,"error",{text:r.responseText})},s.data&&(o="string"===e.type(s.data)?s.data:e.param(s.data)),r.open(i.type,i.url),r.send(o)},abort:function(){r&&r.abort()}}}}),e}),define("module/components/capercaillie/constituencySearch",["module/bootstrap","translator","vendor/xdomainrequest/xdomainrequest"],function(e,t){function n(n){function o(e,t){c("constituencySearchInternalError",t)}function i(n,o){var i;if(n&&n.response&&n.response.details&&n.response.details[0]&&n.response.details[0].externalId&&void 0!==n.response.details[0].distance){if(i=n.response.details[0].externalId,n.response.details[0].distance,"cymrufyw"===e.config.service&&"W"!==i[0].toUpperCase())return void c("constituencySearchNoResults",o);if(n.response.details[0].distance>=0)return e.pubsub.emit("election:findYourConstituency:submitSearch"),void r(t.get("constituencySearchConstituencyPath")+i)}c("constituencySearchNoResults",o)}function s(){var e;if(d(b).text("").addClass("hidden"),e=d(y).val(),!a(e))return void c("constituencySearchNoResults",e);d(f).addClass("constituency-search--searching"),d.ajax({url:p.replace("SEARCH_POSTCODE",l(e)),dataType:"json",success:d.proxy(function(t){i(t,e)},this),error:d.proxy(function(t){o(t,e)},this)})}function a(e){return!!e.match(new RegExp(m))}function r(e){window.location=e}function c(n,o){e.pubsub.emit("election:findYourConstituency:searchError",n),o=void 0===o?"":encodeURIComponent(o).replace(/%20/g," "),d(f).removeClass("constituency-search--searching"),d(b).html(t.get(n).replace("{postcode}",o)).removeClass("hidden")}function l(e){return encodeURIComponent(e.toUpperCase().replace(/ /g,""))}function u(e){var t;"keypress"===e.type&&13!==e.keyCode||(t=d(y).val())!==d(y).attr("placeholder")&&d(y).val(t.toUpperCase())}var d=e.$,h=e.config.environment?e.config.environment.replace("sandbox","live"):"live",p="https://open."+h+".bbc.co.uk/locator/locations/SEARCH_POSTCODE/details/gss-seat?op=intersect&format=json",m="GIR 0AA|[A-PR-UWYZ]([0-9]{1,2}|([A-HK-Y][0-9]|[A-HK-Y][0-9]([0-9]|[ABEHMNPRV-Y]))|[0-9][A-HJKPS-UW]) *[0-9][ABD-HJLNP-UW-Z]{2}",f="#"+n,g="#"+n+"-template",v="#"+n+"-form",b="#"+n+"-message",y="#"+n+"-input",w="#"+n+"-search";(function(){return e.config.locatorFlagPole})()&&(d(g).after(d(g).html()),"placeholder"in document.createElement("input")==!1&&function(){var e=d(e);e.find("[placeholder]").each(function(){d(this).val(d(this).attr("placeholder")),d(this).on("focus",function(){d(this).val("")}),d(this).on("focusout",function(){""===d(this).val()&&d(this).val(d(this).attr("placeholder"))})}),e.on("submit",function(){e.find("[placeholder]").each(function(){d(this).val()===d(this).attr("placeholder")&&d(this).val("")})})}(),function(){d(v).on("submit",function(e){e.preventDefault()}),d(y).on("focusout keypress",d.proxy(u,this)),d(w).on("click",d.proxy(s,this))}())}return{init:function(e){return new n(e)}}}),define("module/components/capercaillie/constituencySearchAdapter",["module/bootstrap","module/components/capercaillie/constituencySearch"],function(e,t){e.$(".capercaillie").each(function(){var e=$(this).attr("id");e&&t.init(e)})}),define("module/components/commentsModule",["module/bootstrap"],function(e){var t=e.$,n=e.pubsub;return{commentsLoaded:function(){this.spinner.remove()},disableAction:function(e){e.preventDefault()},loadComments:function(){var e=this.component.opts.commentsUrl,o=this.component.opts.errormessage,i=this.commentsAction;window.location.hostname.match(/bbc.com/)&&(e=e.replace("bbc.co.uk","bbc.com")),t.ajax({url:e,type:"GET",dataType:"html",timeout:3e4,xhrFields:{withCredentials:!0},success:function(e){i.replaceWith('<div style="font-size:75%">'+e+"</div>")},error:function(e){i.replaceWith("<p>"+o+"</p>")},complete:function(){n.emit("stats:comments:open")}})},openComments:function(){this.spinner=t('<div class="comments-button__loader js-comments-button__loader"><span class="comments-button__spinner"></span></div>'),this.spinner.appendTo(this.component.selector),this.loadComments()},handleSuccess:function(e){e.opts.jsEnabled&&(this.component=e,this.commentsAction=t(e.selector),n.on("stats:comments:open",t.proxy(this.commentsLoaded,this)),this.openComments())}}}),define("module/components/commentsButton",["module/bootstrap","module/commentCounts","module/components/commentsModule"],function(e,t,n){var o=e.$;return{disableAction:function(e){e.preventDefault()},triggerComments:function(){this.commentsAction.off("click",o.proxy(this.triggerComments,this)),n.handleSuccess(this.component)},handleSuccess:function(e){var n="dna-comment-count_"+e.opts.commentsId,i=o("#"+n+".dna-comment-count-show").not(".comments-button__count");if(i.length&&parseInt(i.text(),10)>0){var s=o(e.selector+" .js-comment-count");s.text(i.text()),s.addClass("dna-comment-count-show")}else t.init();e.opts.jsEnabled&&(this.component=e,this.component.selector+=" a",this.commentsAction=o(e.selector),this.commentsAction.on("click",o.proxy(this.disableAction)),this.commentsAction.on("click",o.proxy(this.triggerComments,this)),-1!==window.location.href.indexOf("#comp-comments-button")&&this.triggerComments())}}}),define("module/components/commentsButtonAdapter",["module/components/commentsButton","module/components/commentCountAdapter"],function(e,t){var n=document.getElementById("comp-comments-button");if(n){var o=JSON.parse(n.getAttribute("data-comp-meta"));o&&(o.selector="#"+o.id),t.onCommentsButtonCodeCanRun(function(){e.handleSuccess(o)})}}),define("module/components/correspondentBlogAdapter",["module/components/blog"],function(e){var t=$("#comp-correspondent");if(t.length){var n=t.data("comp-meta");n&&(n.selector="#comp-correspondent",e.init(n))}}),define("module/components/fauxBlockLinkAdapter",["module/components/fauxBlockLink"],function(e){return{init:function(){}}}),define("module/components/hardNewsUnit",["module/bootstrap"],function(e){return{init:function(t){var n=e.$(t+" .faux-block-link");n.on("mouseover",".faux-block-link__overlay-link",function(e){e.delegateTarget.className+=" faux-block-link--hover"}),n.on("mouseout",".faux-block-link__overlay-link",function(e){
e.delegateTarget.className=e.delegateTarget.className.replace(/ faux-block-link--hover/,"")})}}}),define("module/hyperpuff/minihyper",["module/bootstrap","config"],function(e,t){var n=['<aside class="pullout mini-hyper">','<div class="pullout-inner">','<h2 class="heading">{{title}}</h2>','<ul class="related-items">{{content}}</ul>',"</div>","</aside>"].join(""),o=function(e,t){return n.replace("{{title}}",e).replace("{{content}}",t)};return{init:function(){var n;try{n=t.asset.options.allowRelatedStoriesBox}catch(e){n=!1}if(n){var i=e.$(".hyperpuff"),s=e.$(".hyper-title",i).text(),a=e.$(".group .unit",i),r=e.$(".story-body__introduction").first(),c=document.createElement("div"),l=a.length<4?a.length:4;if(i.length){for(var u=0;u<l;u++)c.appendChild(a[u].cloneNode(!0));r.length&&r.before(o(s,c.innerHTML))}}}}}),define("module/components/hyper",["module/bootstrap","module/hyperpuff/minihyper"],function(e,t){return{handleSuccess:function(n,o){var i=e.$(n.selector);i.find(".placeholder-hyperpuff").html(o),i.removeClass("not-fetched").addClass("fetched"),t.init(),e.pubsub.emit("hyperpuff:complete")}}}),define("module/components/hyperAdapter",["module/components/hyper"],function(e){return{handleSuccess:function(t,n){var o,i="#"+t.elementId;n["comp-hyper"]&&n["comp-hyper"].html&&(o=n["comp-hyper"].html),e.handleSuccess({selector:i},o)}}}),define("module/components/in_view_detector",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){var n=e.$,o=t.debounce(function(){i.checkModulesInView()},100),i={eventName:"module:in:view",modules:[],eventsSet:!1,window:n(window),register:function(t){var i=n("#"+t);t&&0!==i.length&&(this.modules.push(i),i.data("block")||i.data("block",t),this.addRegisteredClass(i),this.eventsSet||(e.pubsub.on(this.eventName,n.proxy(this.moduleInView,this)),this.window.on("scroll",o),this.eventsSet=!0),this.window.on("load",n.proxy(function(){this.checkModuleInView(i)},this)))},addRegisteredClass:function(e){e.addClass(e.data("block")+"--in-view-registered")},moduleInView:function(e){this.removeModule(e),e=n(e),e.addClass(e.data("block")+"--in-view")},removeModule:function(t){for(var n=[],i=this.modules.length,s=0;s<i;s++)this.modules[s][0]!==t&&n.push(this.modules[s]);this.modules=n,0===this.modules.length&&(e.pubsub.off(this.eventName),this.window.off("scroll",o),this.eventsSet=!1)},checkModulesInView:function(){for(var e=this,t=this.modules.length,n=0;n<t;n++)e.checkModuleInView(this.modules[n])},checkModuleInView:function(t){this.isModuleInView(t)&&e.pubsub.emit(this.eventName,t)},isModuleInView:function(e){if(void 0===e)return!1;if(!(e=e[0]))return!1;var t=this.window.height(),n=e.getBoundingClientRect(),o=n.top>=0&&n.top<t,i=n.bottom>0&&n.bottom<=t;return o||i}};return i}),define("module/components/listShowAll",["module/bootstrap"],function(e){var t=e.$;return function(e,n){function o(e){e.on("click",t.proxy(i,this))}function i(){s.remove(),e.removeClass(r.closedClass),r.focusAfter.get(0).focus(),r.onClick&&a.trigger("click")}e=t(e);var s,a=t({}),r={showButton:!0,buttonText:"Show all",closedClass:"list-show-all__closed",buttonClass:"list-show-all__button",onClick:!1,focusAfter:e};t.extend(r,n),r.showButton&&(s=function(e,n){var i=t("<button/>").addClass(n).html(e);return o(i),t(i)}(r.buttonText,r.buttonClass),e.addClass(r.closedClass).append(s),r.focusAfter.attr("tabindex")||r.focusAfter.attr("tabindex","0"),a.on("click",r.onClick))}}),define("module/liveEvent/timeline",["config","module/bootstrap","module/stats/comscore"],function(e,t,n){var o=function(t,n,o,i){i=i||{},this.poller=o,this.view=n,this.channel=t,this.sort=i.sort||"descending",this.active=void 0===i.active||!!i.active,this.host=i.pulsarPollingHost||"",this.path=i.pulsarPollingPath||"/"+e.service+"/walkietalkie/pulsar/"+t,this.requestInProgress=!1};return o.prototype={init:function(){var n=this;t.pubsub.on("timeline:more:click",function(){n.requestMoreEntries(),e.features2.comscore_analytics&&n.logComscoreEvent()}),this.setupPolling()},setupPolling:function(){"descending"===this.sort&&this.active&&(this.poller.startCacheBusting(),this.poller.setUrl(this.buildPulsarUrl(!0)),this.poller.startPolling({success:t.$.proxy(function(e){return t.pubsub.emit("timeline:new:dataReceived",[e]),this.buildPulsarUrl(!0)},this),error:function(e){t.pubsub.emit("timeline:new:dataError","dataError")}}))},requestMoreEntries:function(){var e=this;this.requestInProgress||(this.requestInProgress=!0,t.$.ajax({url:this.buildPulsarUrl(!1),dataType:"jsonp",jsonpCallback:"callback",success:function(n){e.requestInProgress=!1,t.pubsub.emit("timeline:more:dataReceived",[n])},error:function(n,o,i){e.requestInProgress=!1,t.pubsub.emit("timeline:more:dataError",[n,o,i])}}))},buildPulsarUrl:function(e){var t={sort:this.sort};return e?(t.entryId=this.view.getTopId(),t.top=!0):t.entryId=this.view.getBottomId(),this.host+this.buildUrl(this.path,t)},buildUrl:function(e,t){var n="";for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];if(!i)continue;n+=o+"="+i+"&"}return n.length>0&&(n=n.substring(0,n.length-1),e=e+"?"+n),e},logComscoreEvent:function(){new n(e).sendClickBeacon("show-more")}},o}),define("module/liveEvent/timelineView",["module/bootstrap","translator"],function(e,t){function n(e){return"#"+e.replace(/(:|\.)/g,"\\$1")}var o=function(t){this.container=e.$(t),this.articleWrapper=this.$(".article-wrapper"),this.moreButton=this.$(".timeline-more a"),this.moreButtonText=this.$(".timeline-more a .cta"),this.windowTopAboveContainerFlag=this.isWindowTopAboveContainer(),this.init(),this.moreButton.append('<span class="spin"></span>')};return o.prototype={init:function(){var t=this;if(this.moreButton.length>0){this.buttonShowMore(),this.moreButton[0].setAttribute("href","#more-button"),this.moreButton[0].addEventListener("click",function(n){return n.preventDefault(),t.moreButton.removeClass("highlighted"),t.buttonLoading(),e.pubsub.emit("timeline:more:click"),!1},!1);var n=function(e,n){t.moreButton[0].addEventListener(e,function(){t.moreButton[n+"Class"]("highlighted")},!1)};n("touchstart","add"),n("touchmove","remove"),n("touchend","remove")}window.addEventListener("scroll",function(){t.hasScrolledAboveContainer()&&e.pubsub.emit("timeline:scroll:top")},!1),window.addEventListener("unload",function(){t.buttonShowMore()},!0),e.pubsub.on("timeline:more:dataReceived",function(e){t.buttonShowMore(),t.appendEntries(e),!1===e.hasMore&&t.buttonHide()}),e.pubsub.on("timeline:new:dataReceived",function(e){t.prependEntries(e),t.handleStickies(e)}),e.pubsub.on("timeline:scroll:top",function(){t.showHiddenEntries()}),e.pubsub.on("timeline:more:dataError",function(){t.buttonError()}),e.pubsub.on("timeline:temp:load",function(){t.buttonLoading()})},handleStickies:function(e){e&&e.stickies&&(this.addStickies(e.stickies),this.removeStickies(e.stickies))},addStickies:function(t){var o=this.$(".sticky-wrapper");for(var i in t)if(t.hasOwnProperty(i)){var s=t[i],a=n(i),r=a+"_stuck";0===this.$(r).length&&(s=s.replace(i,i+"_stuck"),o.prepend(s),this.$(r+" > div").addClass("deleted"));var c=this.$(a);c.length>0&&c.hide()}setTimeout(function(){e.$(".sticky-wrapper .deleted").removeClass("deleted")},500)},removeStickies:function(t){this.$(".sticky-wrapper article").each(function(o,i){var s=i.id.replace("_stuck","");s in t||(e.$(i).remove(),e.$(n(s)).show())})},updateButton:function(e,t){this.moreButton.removeClass("loading").removeClass("error"),this.moreButton.addClass(e),this.moreButtonText.html(t)},buttonShowMore:function(){this.updateButton("",t.get("showMore"))},buttonHide:function(){this.moreButton.hide()},buttonLoading:function(){this.updateButton("loading","Loading")},buttonError:function(){this.buttonShowMore()},getIds:function(){var e=this.$(".article-wrapper article");return e.length>0?e:[]},getTopId:function(){var e=this.getIds();if(e.length>0)return e[0].getAttribute("id")},getBottomId:function(){var e=this.getIds();return e?e[e.length-1].getAttribute("id"):null},appendEntries:function(e){e.text&&this.articleWrapper.append(e.text)},prependEntries:function(e){if(e&&e.text&&(this.articleWrapper.prepend('<div class="hidden">'+e.text+"</div>"),this.windowTopAboveContainerFlag)){var t=this;setTimeout(function(){t.showHiddenEntries()},500)}},hasScrolledAboveContainer:function(){var e=this.isWindowTopAboveContainer();return this.windowTopAboveContainerFlag!==e&&(this.windowTopAboveContainerFlag=e,e)},isWindowTopAboveContainer:function(){var e=this.container[0];if("getBoundingClientRect"in e)return e.getBoundingClientRect().top>0;var t=0;if(e.offsetParent)for(;null!==e.offsetParent;)e=e.offsetParent,t+=e.offsetTop;else t=e.offsetTop;return t>window.pageYOffset},showHiddenEntries:function(){this.$(".hidden").removeClass("hidden")},$:function(t){return e.$(t,this.container)}},o}),define("module/tabbed/panel",["module/bootstrap"],function(e){function t(e){n(e).attr("role","tabpanel")}var n=e.$;return function(e){this.hide=function(){e.removeClass("open"),e.addClass("closed")},this.show=function(){e.removeClass("closed"),e.addClass("open")},t(e)}}),define("module/tabbed/tab",["module/bootstrap","module/tabbed/panel"],function(e,t){function n(e){return"object"==typeof e&&isFinite(e.length)}function o(e){return a(n(e)?e[0]:e)}function i(e,t){e.eq(0).attr("role","presentation"),e.parent().eq(0).attr("role","tablist"),t&&t.attr("role","tab")}function s(e){var t,n=e.which,o=a(e.target).parent(),i=o.next().find("a"),s=o.prev().find("a"),r=o.parent().find("a").first(),c=o.parent().find("a").last();39===n?t=i.length?i:r:37===n&&(t=s.length?s:c),t&&(t.trigger("click"),t[0].focus())}var a=e.$,r=function(e,n,s,a){this.tabsName=a,this.tabId=void 0!==s?s:"",this.tab=o(e),this.panel=new t(o(n)),this.tabAnchor=this.tab.find("a")||!1,this.selected=!1,this.dataEvent=this.tab.attr("data-event")||!1,this.addListerners(),i(this.tab,this.tabAnchor)};return r.prototype.addListerners=function(){a(this.tab[0]).on("click",a.proxy(function(t){t.preventDefault(),e.pubsub.emit("tabs:click"),this.selected||e.pubsub.emit("tabs:activate",[this.tabsName,this.tabId])},this)),a(this.tab[0]).on("keydown",a.proxy(function(e){s(e)},this)),e.pubsub.on("tabs:deactivate",a.proxy(function(e){e===this.tabsName&&this.deactivate()},this)),e.pubsub.on("tabs:activate",a.proxy(function(e,t){t===this.tabId&&e===this.tabsName&&this.activate()},this))},r.prototype.activate=function(t){this.selected=!0,e.pubsub.emit("tabs:deactivate",[this.tabsName]),this.tab.addClass("open"),this.panel.show(),this.tabAnchor&&this.tabAnchor.attr("tabindex","0").append('<span class="off-screen"> selected</span>'),!t&&this.dataEvent&&e.pubsub.emit("tabs:activate:"+this.dataEvent)},r.prototype.deactivate=function(){this.selected=!1,this.tab.removeClass("open"),this.tab.find("span.off-screen").remove(),this.panel.hide(),this.tabAnchor&&this.tabAnchor.attr("tabindex","-1")},r}),define("module/tabbed/tabbed",["module/bootstrap","module/tabbed/tab"],function(e,t){function n(e,t,n){for(var i=0,s=e.length;i<s;i++){var a=i+1,r=e[i],c=t+"__tab-"+a;e[i]==="#"+o(e[i]).attr("id")&&(e[i]="#"+c),o(r).attr("id",c),o(n[i]).addClass("panel-"+a).attr("aria-labelledby",t+"__tab-"+a)}return e}var o=e.$,i=function(e,o,i,s){i=void 0===i||i,this.tabsName=s||"default",this.tabs=[],e=n(e,this.tabsName,o);for(var a=0,r=e.length;a<r;a++)this.tabs.push(new t(e[a],o[a],a,this.tabsName));void 0!==this.tabs[0]&&this.tabs[0].activate(i)};return i.prototype.addTab=function(e,n){this.tabs.push(new t(e,n,this.tabs.length,this.tabsName))},i}),define("module/transclude",["module/bootstrap"],function(e){var t=function(){};return t.prototype.get=function(t,n){function o(e,t,o){n[e]&&n[e](t,o)}function i(){r.shift(),0===r.length&&o("complete")}function s(e){return e.getAttribute("data-fetch-url")||e.href}function a(e){e+="?";for(var t in n.urlParameters)e+=t+"="+n.urlParameters[t]+"&";return e.slice(0,-1)}n=n||{};var r=[];!function(c){e.$(t).each(function(t,c){if(c="number"!=typeof c?c:t,!c.href)return void o("error","Error: No href attribute on  elm "+t,t);r.push(t);var l=s(c),u=e.$(n.target||c),d=n.maintainLink||!1;n.requestUrl&&(l=n.requestUrl),n.urlParameters&&(l=a(l)),e.$.ajax({url:l,dataType:"html",success:function(e){if(d||c.setAttribute("href","#"+(c.id||"transcluded"+(new Date).getTime())),n.insert)u.html(e);else if(u[0]){var s=u[0].id?'id="'+u[0].id+'"':"";u.replaceWith("<div "+s+">"+e+"</div>")}i(),o("success",e,t)},error:function(e){i(),o("error","Error: 404",t)}})})}()},t}),define("module/history/native",["module/bootstrap"],function(e){return function(t,n){this.EmittedFromHistory=!1;for(var o=this,i=0,s=t.length;i<s;i++)!function(t){e.pubsub.on(t,function(){o.EmittedFromHistory?o.EmittedFromHistory=!1:window.history.pushState({isNewsMobile:!0,eventName:t,eventData:Array.prototype.slice.call(arguments)},"")})}(t[i]);window.addEventListener("popstate",function(t){t.state&&"isNewsMobile"in t.state&&(o.EmittedFromHistory=!0,e.pubsub.emit(t.state.eventName,t.state.eventData))},!1),void 0!==n&&window.history.replaceState({isNewsMobile:!0,eventName:n.eventName,eventData:n.data},"")}}),define("module/history/hashed",["module/bootstrap"],function(e){var t=function(t,n,o){var i=this;this.sessionStorage=o||window.sessionStorage,this.EmittedFromHistory=null,this.queue=[],this.historyPos=0,e.pubsub.on("history:hashchange",function(e){i.manageHashChange(e)}),window.addEventListener("hashchange",function(t){void 0===t.newURL&&(t.newURL=window.location.href),e.pubsub.emit("history:hashchange",[t.newURL.split("#")[1]])},!0),window.addEventListener("unload",function(){i.sessionStorage.setItem("news:history:save:"+window.location.pathname,JSON.stringify(i.queue))},!0),this.initState(n),this.addPubSubListeners(t)};return t.prototype.addPubSubListeners=function(t){for(var n=this,o=0,i=t.length;o<i;o++)!function(t){e.pubsub.on(t,function(){n.EmittedFromHistory===t?n.EmittedFromHistory=null:(window.location.href=window.location.pathname+"#"+n.incrementHistoryPos(),n.queue[n.historyPos]={isNewsMobile:!0,eventName:t,eventData:Array.prototype.slice.call(arguments)})})}(t[o])},t.prototype.incrementHistoryPos=function(){return++this.historyPos},t.prototype.initState=function(t){var n=this.sessionStorage.getItem("news:history:save:"+window.location.pathname);n&&void 0!==window.location.hash?(this.queue=JSON.parse(n),this.historyPos=window.location.hash.split("#")[1],e.pubsub.emit("history:hashchange",[this.historyPos])):void 0!==t&&(window.location.href=window.location.pathname+"#"+this.historyPos,this.queue[this.historyPos]={isNewsMobile:!0,eventName:t.eventName,eventData:t.data})},t.prototype.manageHashChange=function(t){var n=this.queue[t];void 0===n||(this.EmittedFromHistory=n.eventName,e.pubsub.emit(n.eventName,n.eventData))},t}),define("module/history/history",["require","module/history/native","module/history/hashed"],function(e){return e("object"==typeof window.history&&void 0!==window.history.pushState?"./native":"./hashed")}),define("module/liveEvent/liveMediaPlayerView",["module/bootstrap","module/featureDetector","translator"],function(e,t,n){var o=e.$,i={live:n.get("live"),watch:n.get("watch")},s={item:150,itemSpacing:2},a={carousel:"media-nav--carousel",item:"media-nav__item",highlight:"media-nav__item--highlight",live:"media-nav__item--live",ondemand:"media-nav__item--ondemand"},r={container:'<div class="media-nav"></div>',items:'<ol class="media-nav__items"></ol>',item:'<li class="media-nav__item {{itemClass}}"><b>{{label}}</b> {{headline}}</li>'};return{init:function(e,t){return this.container=o(e),this.mediaItems=t,this.mediaNav=this.createNav(),this.mediaNavContainer=this.mediaNav.find(".media-nav__items"),this.mediaNavItems=this.mediaNavContainer.find(".media-nav__item"),this.supportsCarousel()&&(this.mediaNav.addClass(a.carousel),this.setMediaNavWidth()),this.container.after(this.mediaNav),this.bindEvents(),this},createNav:function(){var e=o(r.items);return o.each(this.mediaItems,o.proxy(function(t,n){e.append(this.createNavItem(t,n))},this)),o(r.container).append(e)},createNavItem:function(e,t){var n=t.video.live,s=n?i.live:i.watch,c=n?a.live:a.ondemand,l=r.item.replace("{{itemClass}}",c).replace("{{label}}",s).replace("{{headline}}",t.headline);return o(l)},supportsCarousel:function(){return!t.is("AndroidMobile2")},setMediaNavWidth:function(){var e=this.mediaItems.length*s.item,t=(this.mediaItems.length-1)*s.itemSpacing,n=e+t;this.mediaNavContainer.css("width",n)},bindEvents:function(){this.mediaNavContainer.on("click","li",o.proxy(function(t){var n=o(t.currentTarget),i=this.mediaNavItems.index(n);n.hasClass(a.highlight)||(e.pubsub.emit("medianav:select",[this.mediaItems[i],i]),this.highlightItem(i))},this))},highlightItem:function(e){this.mediaNavItems.removeClass(a.highlight).eq(e).addClass(a.highlight)}}}),define("module/liveEvent/liveMediaPlayer",["module/bootstrap","module/components/mediaPlayer/main","module/featureDetector","module/liveEvent/liveMediaPlayerView"],function(e,t,n,o){function i(e){return c.grep(e,function(e){if(e.video)return!0})}function s(e){a.html(r[e]),t.processNewPlayers()}var a,r,c=e.$,l={ITEMS_NOT_ARRAY:"init expects an array as it's first parameter"};return{init:function(t,n){if(t&&n&&document.querySelector(t)){if(!c.isArray(n))throw TypeError(l.ITEMS_NOT_ARRAY);a=e.$("#lep-playable-data"),r=a.data("lep-playable-html"),r&&(this.selector=t,this.mediaItems=i(n),this.createView(),this.bindEvents(),this.loadMediaItem(0))}},createView:function(){this.view=o.init(this.selector,this.mediaItems)},bindEvents:function(){e.pubsub.on("medianav:select",c.proxy(function(e,t){s(t)},this))},loadMediaItem:function(e){s(e),this.view.highlightItem(e)}}}),define("module/live-event",["config","module/bootstrap","module/liveEvent/timeline","module/liveEvent/timelineView","module/poller","module/tabbed/tabbed","module/transclude","module/ajaxForm/ajaxForm","module/ajaxForm/ajaxFormView","module/history/history","module/liveEvent/liveMediaPlayer"],function(e,t,n,o,i,s,a,r,c,l,u){return{init:function(e,r){!function(){var e=["Webkit","Moz"],n=[];for(var o in e)n.push(document.body.style[e[o]+"AnimationName"]);t.$("html").addClass(n.indexOf("")>-1?"css-anim":"animated-gif")}(),u.init("#media-wrapper",r);var c=t.$,d=c("#live-tabs li"),h=c("#live-panels .panel"),p=c(".tab-2 a")[0],m=(p&&h.splice(0,2,h[1],h[0]),d[0]&&new s(d,h),new a,new n(e.channelId,new o("#live-timeline"),new i(e.pollPeriod),{sort:e.channelOrder,active:e.isLive,pulsarPollingHost:e.pollingHost}));new l(["tabs:activate"],{eventName:"tabs:activate",data:[0]});m.init()}}}),define("module/components/liveEventPage",["module/live-event"],function(e){var t=document.getElementById("live-event-page"),n=t.getAttribute("data-live-event-opts"),o=JSON.parse(n),i=t.getAttribute("data-media-player-items"),s=JSON.parse(i);e.init({channelId:o.channelId,channelOrder:o.channelOrder,pollingHost:o.pollingHost,pollPeriod:o.pollPeriod,isLive:o.isLive},s)}),define("module/components/liveEventPromo",["config","module/bootstrap","module/poller","module/timestamp"],function(e,t,n,o){return{pollingUrl:function(e,t,n){return void 0===t&&(t={service:"nfp"}),e+"/"+t.service+"/walkietalkie/latest_index_asset/"+n},handleSuccess:function(){if(e.features.liveeventcomponent){this.init(e.pollingHost,null);var n=t.$("primary-live-event.faux-block-link");n.on("mouseover",".faux-block-link__overlay-link",function(e){e.delegateTarget.className+=" faux-block-link--hover"}),n.on("mouseout",".faux-block-link__overlay-link",function(e){e.delegateTarget.className=e.delegateTarget.className.replace(/ faux-block-link--hover/,"")})}},init:function(i,s){var a=t.$,r=this;a("[data-channel]").each(function(){var t=a(".live-event-index__container",this),c=a(".live-event-index__summary",t),l=a(".live-event-index__entries",t),u=a(this).attr("data-channel"),d=new n(30),h="",p=r.pollingUrl(i,e,u);d.startCacheBusting(),d.setUrl(p),d.startPolling({success:function(e){if(a.trim(l.html())||c.remove(),e.entryId!==h){var t=null;if(e.createTime){var n=e.createTime.split(/[\-T:]/g),i=new Date(n[0],n[1]-1,n[2]);i.setHours(n[3],n[4],n[5]);var r=((new Date).getTime()-i.getTime())/1e3,u=new o(null),d=u.timeAgoInWords(r);d&&(t='<span class="date--v2">'+d+"</span>")}if(t){var m=e.html.indexOf(">")+1,f=e.html.substring(0,m),g=e.html.substring(m);e.html=f+t+g}return s?s(l,e.html):(l.css("opacity","0"),setTimeout(function(){l.html(e.html).css("opacity","1")},1200)),h=e.entryId,p}},error:function(){a.trim(l.html())||(l.css("display","none"),c.css("visibility","visible"),d.stopPolling())}})})}}}),define("module/components/localLive",["module/bootstrap","module/request","module/featureDetector"],function(e,t,n){"use strict";var o=e.$,i={COMPONENT:"#comp-local-live",BUTTON:".local-live__progress-button",STICKY_WRAPPER:".sticky-wrapper",ARTICLE_WRAPPER:".article-wrapper",TOGGLE:".toggle"};return{handleSuccess:function(e){var s,a;this.localLive=o(e),this.stickyWrapper=this.localLive.find(i.STICKY_WRAPPER),this.articleWrapper=this.localLive.find(i.ARTICLE_WRAPPER),this.toggledElems=this.localLive.find(i.TOGGLE),this.canTransition=n.can("CssTransition"),this.button=o(i.BUTTON),a=this.localLive.data("live-event-channel")&&""!==this.localLive.data("live-event-channel")?this.localLive.data("live-event-channel"):null,this.localLive.data("polling-host")&&""!==this.localLive.data("polling-host")&&(s=this.localLive.data("polling-host")),s&&a&&(this.request=new t({getUpdatesOnInit:!0,url:this.constructPulsarUrl(s,a),success:o.proxy(this.handleRefreshSuccess,this),pending:o.proxy(this.handleRefreshPending,this),complete:o.proxy(this.handleRefreshComplete,this)}),this.bindEvents())},constructPulsarUrl:function(e,t){return e+"/news/walkietalkie/pulsar/"+t+"?sort=descending&limit=3&show=all"},handleRefreshSuccess:function(e){this.transition(o.proxy(function(){this.insertStickies(e.stickies),this.insertArticles(e.text)},this))},handleRefreshPending:function(){this.button.addClass("spinner")},handleRefreshComplete:function(){this.button.removeClass("spinner")},transition:function(e){this.canTransition?(this.toggledElems.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",o.proxy(function(){e(),this.showUpdates()},this)),this.hideUpdates()):e()},insertStickies:function(e){var t,n="";for(t in e)e.hasOwnProperty(t)&&(n+=e[t]);this.stickyWrapper.html(n)},insertArticles:function(e){this.articleWrapper.html(e)},hideUpdates:function(){this.toggledElems.addClass("refreshing")},showUpdates:function(){this.toggledElems.removeClass("refreshing")},bindEvents:function(){this.button.on("click",o.proxy(function(e){this.request.getUpdates()},this))}}}),define("module/components/market_data/chart",["module/bootstrap","deviceInspector"],function(e,t){var n=e.$,o="group1",i="",s={group1:{height:171,width:304},group2:{height:171,width:304},group3:{height:343,width:610},group4:{height:363,width:645}},a=function(e){this.init(n(e))};return a.prototype.init=function(o){this.image=o.find(".markets-chart__image"),0!==this.image.length&&(this.imageUrl=this.image.data("chart-url"),i=this.image.data("chart-code"),this.timespans=o.find(".markets-chart__timespans"),this.timespanItems=o.find(".markets-chart_timespan-item"),this.timespans.on("click",".markets-chart_timespan-item",n.proxy(this.handleClick,this)),this.handleResize(t.getGroup()),e.pubsub.on("deviceGroup",n.proxy(this.handleResize,this)))},a.prototype.handleClick=function(e){return this.swapImage(e),this.toggleSelected(e),!1},a.prototype.swapImage=function(e){var t=e.target.getAttribute("data-timespan"),n=this.imageUrl.replace("CHART_TIMESPAN",t);this.track({chart_ticker:i,chart_timespan:t,chart_width:s[o].width,chart_height:s[o].height}),this.image.attr("src")!==n&&this.image.attr("src",n)},a.prototype.toggleSelected=function(e){this.timespanItems.removeClass("markets-chart_timespan-item--selected"),n(e.target).addClass("markets-chart_timespan-item--selected")},a.prototype.track=function(t){e.pubsub.emit("marketdata:chart:toggle",[t])},a.prototype.handleResize=function(e){o=e,this.imageUrl=this.imageUrl.replace("CHART_WIDTH",s[e].width).replace("CHART_HEIGHT",s[e].height),n(".markets-chart_timespan-item--selected").trigger("click")},a}),define("module/components/market_data/company_ticker_chart",["module/components/market_data/chart"],function(e){return{init:function(t){new e(t.selector)}}}),define("module/components/market_data/company_ticker_navigation",["module/bootstrap"],function(e){var t,n,o,i=e.$;return{init:function(e){t=i(e.selector),n=t.find(".markets-selector-item__link"),n.length<=1||(o=i(".company-ticker-top__market-panel"),o.hide().first().show(),t.on("click",".markets-selector-item__link",i.proxy(this.handleClick,this)))},handleClick:function(e){var t=i(e.target);return o.hide(),n.removeClass("markets-selector-item__link--selected"),i(t.attr("href")).show(),t.addClass("markets-selector-item__link--selected"),!1}}}),define("module/components/market_data/company_ticker_top",["module/bootstrap","module/components/market_data/chart"],function(e,t){var n=e.$;return{init:function(e){n(e.selector).find(".markets-chart").each(function(){new t(this)})}}}),define("module/components/market_data/index-selector",["module/bootstrap"],function(e){var t,n,o=e.$;return{init:function(){this.getElements(),t.addClass("hidden"),t.find("li").first().addClass("hidden"),n.on("click",this.toggleDropdown)},getElements:function(){t=o(".index-selector__indices"),n=o(".index-selector__main button")},toggleDropdown:function(e){e.preventDefault(),n.toggleClass("index-selector__toggle--open"),t.toggleClass("hidden")}}}),define("module/components/market_data/markets_index_chart",["module/components/market_data/chart"],function(e){return{init:function(t){new e(t.selector)}}}),define("module/components/scotland_decides/dropdown",["module/bootstrap"],function(e){var t,n,o,i,s,a,r,c,l,u,d,h=e.$;return{handleSuccess:function(e){this.component=e,this.setModule(),this.displayDropdown(),this.setupVars(),this.removeHeaderLink(),this.resetDropdown()},setModule:function(){t=h("#"+this.component.id)},setupVars:function(){n="#"+t.data("list"),o="#"+t.data("header"),c=t.data("button"),l=h("#"+c).text(),u=h("#"+c).data("close"),i="."+t.data("item"),s=t.data("item-selected"),a="."+s,r=t.data("open"),d=h("#page")},removeHeaderLink:function(){var e=h(o);e.html(e.find("a").html())},bindButtonEvent:function(){h("#"+c).one("click",h.proxy(this.toggleList,this))},bindHtmlEvent:function(){h("html").one("click",h.proxy(this.resetDropdown,this))},resetDropdown:function(){this.bindButtonEvent(),this.removeListOpenClass(),this.removeMinPageHeight(),this.hideNonSelectedItems(),this.changeButtonText(l)},hideNonSelectedItems:function(){h(n+" "+i+":not("+a+")").hide()},showAllItems:function(){h(n+" "+i).show()},changeButtonText:function(e){h("#"+c).find("span").html(e)},removeListOpenClass:function(){h(n).removeClass(r)},addListOpenClass:function(){h(n).addClass(r)},toggleList:function(){this.showAllItems(),this.addListOpenClass(),this.addMinPageHeight(),this.changeButtonText(u),setTimeout(h.proxy(this.bindHtmlEvent,this),0)},addMinPageHeight:function(){d.css("min-height",2050)},removeMinPageHeight:function(){d.css("min-height",0)},displayDropdown:function(){var e=t.find("script");t.append(e.html()),e.remove()}}}),define("module/components/market_data/markets_index_dropdown",["module/bootstrap","module/components/scotland_decides/dropdown"],function(e,t){return{init:function(e){t.handleSuccess({id:"comp-markets-index-dropdown"})}}}),define("module/components/mediaPlayer/mainAdapter",["module/components/mediaPlayer/main"],function(e){e.processNewPlayers()}),define("module/components/moreFromThisIndex",["module/bootstrap","module/timestamp","module/imageenhancer"],function(e,t,n){return{handleSuccess:function(o,i){var s,a=e.$(o.selector);a.find(".small-promo-group__body").html(i),s=new t(new Date((new Date).toUTCString()).getTime()),s.insertTime(),new n}}}),define("module/components/moreFromThisIndexAdapter",["module/bootstrap"],function(e){return{handleSuccess:function(t,n){if(n["comp-more-from-this-index"]&&n["comp-more-from-this-index"].html){var o=document.getElementById(t.elementId),i=e.$(o),s=n["comp-more-from-this-index"].html;i.find(".small-promo-group__body").html(s),require(["module/components/responsiveImage","module/components/timestampAdaptor"],function(e,n){var o="#"+t.elementId;e.reProcess(o),n.reProcess(o)})}}}}),define("module/stream/core",["module/bootstrap","module/stream/endpoint"],function(e,t){return function(n){var o=e.$({}),i=new t(n.latest,o,"latest"),s=new t(n.earlier,o,"earlier");return o.on("latest:request",function(){i.request()}),o.on("earlier:request",function(){s.request()}),o.on("latest:endpoints",function(e,t){s.setUrl(t.earlier)}),{emit:function(e){o.trigger(e)},on:function(e,t){o.on(e,function(){return t.apply(this,Array.prototype.slice.call(arguments,1))})}}}}),define("module/stream/view",["module/bootstrap","translator","module/featureDetector"],function(e,t,n){var o=e.$,i={refresh:'<p class="comp-stream__error comp-stream__error--refresh">{{message}}</p>',showMore:'<p class="comp-stream__error comp-stream__error--show-more">{{message}}</p>'},s=function(e,t){return o.contains(e[0],t[0])},a=n.which("TransitionEnd"),r=function(e,t){n.can("CssTransition")?(e.on(a,function(){e.off(a),t(),e.removeClass("refreshing")}),e.addClass("refreshing")):t()};return function(e,n){var a=o({}),c=o(i.refresh.replace("{{message}}",t.get("streamRefreshError"))),l=o(i.showMore.replace("{{message}}",t.get("streamShowMoreError")));return e.on("latest:updates",function(e){r(n,function(){n.html(e),a.trigger("updates:inserted")}),s(n,c)&&c.remove()}),e.on("earlier:updates",function(e){var t=o.parseHTML(e),i=o("a",t)[0];n.append(t),i&&i.focus(),a.trigger("updates:inserted"),s(n,l)&&l.remove()}),e.on("latest:error",function(e){s(n,c)||n.prepend(c)}),e.on("earlier:error",function(e){s(n,l)||n.append(l)}),{on:function(e,t){a.on(e,function(){return t.apply(this,Array.prototype.slice.call(arguments,1))})}}}}),define("module/stream/refresh_button",["module/bootstrap","translator"],function(e,t){var n=e.$,o=['<button class="comp-stream__button--refresh">','<span class="off-screen">{{label}}</span>','<span class="comp-stream__button--refresh-icon"></span>',"</button>"].join(""),i={normal:t.get("streamRefreshButton")},s={loading:"spinner"};return function(){var e=n(o.replace("{{label}}",i.normal)),t=n({});return e.on("click",function(e){t.trigger("click")}),{appendTo:function(t){e.appendTo(t)},remove:function(){e.detach()},on:function(e,n){t.on(e,n)},setNormal:function(){e.removeClass(s.loading)},setLoading:function(){e.addClass(s.loading)}}}}),define("module/components/nexus/connectedStream",["module/stream/core","module/stream/view","module/stream/refresh_button","module/stream/show_more_button","module/bootstrap","module/featureDetector","module/imageenhancer","module/components/mediaPlayer/main"],function(e,t,n,o,i,s,a,r){"use strict";function c(e){return{latest:e.opts.endpoints.latest,earlier:e.opts.endpoints.earlier}}var l=i.$,u={init:function(e){return e.on("updates:inserted",l.proxy(this.run,this)),this},run:function(){this.publishTrackEvents(),this.createStatsData()},publishTrackEvents:function(){i.pubsub.emit("component:loaded",["connected-stream-internal"]),i.pubsub.emit("component:loaded",["connected-stream-external"])},createStatsData:function(){var e=l("#comp-connected-stream .update"),t=[".update__image",".update__headline",".update__body"];e.each(function(n,o){l(o).find("a").each(function(o,s){var a=l.grep(t,function(e){return l(s).closest(e).length>0}),r={update_index:n+1,update_total:e.length,update_type:l(s).closest(".update").attr("class"),update_position:a[0]};s.linktrack=i.$.param(r)})})}},d={init:function(e){return e.on("updates:inserted",l.proxy(this.run,this)),this},run:function(){r.processNewPlayers()}},h={init:function(e){return e.on("updates:inserted",l.proxy(this.run,this)),this},run:function(){
new a(".update__body img",".update__image img")}};return{handleSuccess:function(a){var r=l(a.selector),p=s.can("CssTransition"),m=new e(c(a)),f=new t(m,r.find(".updates")),g=new n,v=new o,b=l(".back-to-top");g.on("click",function(){m.emit("latest:request"),i.pubsub.emit("stream:refresh")}),m.on("latest:requesting",function(){g.setLoading()}),m.on("latest:updates",function(){g.setNormal()}),m.on("latest:error",function(){g.setNormal()}),g.appendTo(r.find(".comp-stream__header")),c(a).earlier&&(v.on("click",function(){m.emit("earlier:request"),i.pubsub.emit("stream:showmore")}),m.on("earlier:requesting",function(){v.setLoading()}),m.on("earlier:updates",function(){v.setNormal()}),m.on("earlier:noupdates",function(){v.remove()}),m.on("earlier:error",function(){v.setNormal()}),v.appendTo(r)),m.on("latest:endpoints",function(e){e.earlier&&v.appendTo(r)}),b.on("click",function(){i.pubsub.emit("stream:back-to-top")}),l("body").addClass(p?"css-anim":"animated-gif"),h.init(f).run(),d.init(f).run(),u.init(f).run()}}}),define("module/components/nexus/connectedStreamAdapter",["module/bootstrap","module/components/nexus/connectedStream"],function(e,t){var n=e.$,o=n("#comp-connected-stream");if(o.length){var i=o.data("compMeta");if(i){var s={id:i.id||"",type:i.type||"",handler:i.handler||"",deviceGroups:i.deviceGroups||null,loaded:!0,opts:{about:i.opts.about,title:i.opts.title,endpoints:{latest:i.opts.endpoints.latest,earlier:i.opts.endpoints.earlier}},selector:"#comp-connected-stream",template:i.template};t.handleSuccess(s)}}}),define("module/components/nexus/templates",{refresh:{button:'<button class="comp-stream__button--refresh"><span class="off-screen">{{label}}</span><span class="comp-stream__button--refresh-icon"></span></button>',error:'<p class="comp-stream__error comp-stream__error--refresh">{{message}}</p>'},show_more:{button:'<button class="show-more"><span class="show-more__inner"><span class="show-more__label">{{label}}</span><span class="show-more__spinner"></span></span></button>',error:'<p class="comp-stream__error comp-stream__error--show-more">{{message}}</p>'}}),define("styleguide/queryString",[],function(){var e={},t=function(){var t="";for(var n in e)t+=t?"&"+n+"="+e[n]:"?"+n+"="+e[n];return t},n=function(t){return e[t]},o=function(t,n){e[t]=n},i=function(t,n){e.hasOwnProperty(t)||o(t,n)},s=function(t){delete e[t]};return function(){for(var t,n=window.location.search.substring(1),o=n?n.split("&"):[],i=0;i<o.length;i++)t=o[i].split("="),e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}(),{get:t,getParam:n,setParam:o,setParamIfNotAlreadySet:i,unsetParam:s}}),define("vendor/optimizely/optimizelyDax",[],function(){function e(e){return e.toLowerCase().replace(r,"_")}function t(e){return e.toLowerCase().replace(r,"-")}function n(n,o){var i=o.experiment.id,s=window.optimizely.get("visitor");if(s&&(!s.custom||s.custom&&!s.custom[i])){var a={};if(a[i]=!0,window.optimizely.push({type:"user",attributes:a}),!o.isInCampaignHoldback){var r={},c=o.experiment.name,l=o.variation.name;r.mvt_experience=t(c+"."+l),r[e("mvt_"+c)]=t(l),n.log("ab-test","optimizely",r)}}}function o(e,t){n(t,window.optimizely.get("state").getCampaignStates({isActive:!0})[e])}function i(e){window.optimizely=window.optimizely||[],window.optimizely.push({type:"addListener",filter:{type:"lifecycle",name:"campaignDecided"},handler:function(t){o(t.data.campaign.id,e)}})}function s(e){window.optimizely=window.optimizely||[];var t=window.optimizely.get&&window.optimizely.get("state");if(t){var n=t.getCampaignStates({isActive:!0});for(var i in n)n.hasOwnProperty(i)&&o(i,e)}}function a(e){s(e),i(e)}var r=/[^A-Za-z0-9.]/g;return{init:a}}),define("module/components/caminoTracking",["module/bootstrap"],function(e){var t=function(e){var t=[];return e.each(function(e,n){var o=n.getAttribute("href");t.push(o)}),t.join("|")},n=function(t,n){t.on("click",function(){var t=e.$(this).index(".parrot-item__link")+1;n.clickIndex=t,e.pubsub.emit("ojComponent:click",n)})},o=function(){e.pubsub.on("component:postloaded",function(o){if(void 0!==o&&o.hasOwnProperty("component")&&"wsoj"===o.component){var i=e.$(".parrot-item__link"),s=t(i),a={recommenderValue:o.recommenderValue,itemLinks:s,userSegment:o.userSegment};e.pubsub.emit("ojComponent:pageload",a),n(i,a)}})};return{init:function(){o()},getJoinedLinks:t}}),define("module/components/optimizelyTracking",["module/bootstrap","vendor/optimizely/optimizelyDax","istats-1","module/components/caminoTracking"],function(e,t,n,o){var i=function(){e.$("#optimizely-in-page").on("load",function(){t.init(n)})},s=function(){e.pubsub.on("shareTools:visible",function(){window.optimizely.push({type:"event",eventName:"story-completes"})})},a=function(e){e.on("click",function(){window.optimizely.push({type:"event",eventName:"oj-component-clicks"})})},r=function(){e.pubsub.on("component:postloaded",function(t){if(void 0!==t&&t.hasOwnProperty("component")&&"wsoj"===t.component){window.optimizely.push({type:"user",attributes:{user_segment:t.userSegment}});var n=e.$(".parrot-item__link");a(n)}})};return{init:function(){i(),s(),r()}}}),define("module/components/optimizelyAdapter",["module/bootstrap","module/assortedUtils","styleguide/queryString","vendor/lo-dash/lo-dash","module/components/optimizelyTracking"],function(e,t,n,o,i){var s={};return s.getConfig=function(){try{return JSON.parse(e.$("meta[name=optimizely-config]").attr("data-optimizely-config"))}catch(e){}return!1},s.isTestMode=function(){if("optimizely"===n.getParam("_fake"))return!0;var e=s.getConfig();return e&&e.isTestContext},s.loadOptimizely=function(e,t){var n=s.getConfig();return n&&n.optimizelyHost?s.async(t,n.optimizelyHost,e):null},s.loadFakeOptimizely=function(){function e(){return[n.getParam("active_exp")]}function t(){var e={};return e={},e.id=n.getParam("optimizely_id"),e.name=n.getParam("optimizely_name"),e[n.getParam("active_exp")]={id:n.getParam("optimizely_id"),name:n.getParam("optimizely_name")},e}function o(){var e={},t=n.getParam("active_exp"),o=n.getParam("optimizely_name"),i=!1;return"holdback"===o&&(i=!0),e[t]={isInExperimentHoldback:i,variation:{id:t,name:o}},e}s.optimizelyObjExists()||(window.optimizely={get:function(){return{getActiveExperimentIds:e,getVariationMap:t,getExperimentStates:o}}})},s.variationsCanBeObtained=function(){return!!s.optimizelyObjExists()&&(!(!s.variationFunctionsExist()||!s.variationPropertiesExist())&&s.getActiveExperimentIdsReturnsArray())},s.async=function(e,t,n){var o,a=document,r=a.createElement("script"),c=a.getElementsByTagName("script")[0];s.setCookieExpiration(),c.src!==t&&(r.src=t,r.id="optimizely-in-page",c.parentNode.insertBefore(r,c),o=r,i.init()),c.src===t&&(o=c),o.addEventListener("load",function(t){s.variationsCanBeObtained()?n.call(e):window.optimizely.push({type:"addListener",filter:{type:"lifecycle",name:"campaignDecided"},handler:function(t){n.call(e)}})},!1)},s.optimizelyObjExists=function(){return void 0!==window.optimizely},s.variationPropertiesExist=function(){if(!window.optimizely.hasOwnProperty("get"))return!1;var e=window.optimizely.get("state");return e.hasOwnProperty("getActiveExperimentIds")&&e.hasOwnProperty("getVariationMap")},s.variationFunctionsExist=function(){if(!window.optimizely.hasOwnProperty("get"))return!1;var e=window.optimizely.get("state");return o.isFunction(e.getActiveExperimentIds)&&o.isFunction(e.getVariationMap)},s.getActiveExperimentIdsReturnsArray=function(){if(window.optimizely.hasOwnProperty("get")){return window.optimizely.get("state").getActiveExperimentIds().constructor===Array}return!1},s.setCookieExpiration=function(){window.optimizely=window.optimizely||[],0===window.optimizely.length&&window.optimizely.push(["setCookieExpiration",365])},s.activateInactiveExperiments=function(){if(s.getConfig()&&!this.isTestMode()){window.optimizely=window.optimizely||[];var e=optimizely.get("state").getPageStates({isActive:!1});for(var t in e)e.hasOwnProperty(t)&&e[t].apiName&&window.optimizely.push({type:"page",pageName:e[t].apiName})}},s}),define("module/components/camino",["module/bootstrap","module/featureDetector","deviceInspector"],function(e,t,n){var o={config:{identifyPath:"/api/identify",recsPath:"/api/recommend",knownBrowsers:["Chrome","Safari","IE","Firefox","FacebookBrowser","AndroidBrowser"],knownOperatingSystems:["Apple","Android","Windows"],limit:4,host:"",seenBefore:!1,optimizely:{variation:"default-0"}},user:{recSys:1,segment:"default-0",profile:0},recs:[],identified:!1,profileUpdated:!1,loadFakeCamino:function(){o.identify=function(e,t,n){return n(null,o.user,!1)},o.fetchRecs=function(e,t){return o.updateRecs({items:[{assetUri:"/1",ampUri:"/amp/1",shortHeadline:"A short headline",imageHref:"i.jpg"}]}),t(null,o.recs)}},identify:function(t,n,i){if(o.updateUser(t)&&!n)return i(null,o.user,!0);var s=o.getIdentifyUrl();if(!s)return i(Error("Missing Identify URL"));e.$.ajax(s,{dataType:"json",success:function(e){if(o.updateUser(e))return i(null,o.user,!1)},error:function(e,t,n){return i(n)}})},isValidUserData:function(e){return e&&"object"==typeof e&&e.hasOwnProperty("recSys")&&e.hasOwnProperty("segment")},isUserIdentified:function(){return o.identified},updateUser:function(e){return!!o.isValidUserData(e)&&(Object.keys(o.user).forEach(function(t){o.user[t]=e[t]||o.user[t]}),o.identified=!0,!0)},getIdentifyUrl:function(){var e=o.config.host,t=o.config.identifyPath,n=o.getParams();return e&&t&&n?e+t+n:null},getParams:function(){return"?"+e.$.param({assetType:o.getAssetType(),seenBefore:o.getSeenBefore(),referrer:o.getReferrer(),deviceType:o.getDeviceType(),operatingSystem:o.getOperatingSystem(),browserName:o.getBrowserName(),optimizelyVariant:o.getVariation()})},setSeenBefore:function(e){return o.config.seenBefore=e,this},getSeenBefore:function(){return o.config.seenBefore},setHost:function(e){return o.config.host=e,this},setVariation:function(e){return o.config.optimizely.variation=e,this},getVariation:function(){return o.config.optimizely.variation},getAssetType:function(){return e.config.asset.type},getReferrer:function(e){var t=e||document.referrer;return t?t.split("/")[2]:""},getDeviceType:function(){return n.getType()},getOperatingSystem:function(){return o.config.knownOperatingSystems.forEach(function(e){if(t.is(e))return e}),"Other"},getBrowserName:function(){return o.config.knownBrowsers.forEach(function(e){if(t.is(e))return e}),"Other"},fetchRecs:function(t,n){var i=o.getRecsUrl(t);if(!i)return n(Error("Missing Recommendations URL"));e.$.ajax(i,{dataType:"json",success:function(e){var t=null;return o.updateRecs(e)?o.updateUserProfile(e):t="Invalid recommendations",n(t,o.recs)},error:function(e,t,o){return n(o)}})},getRecsUrl:function(e){var t=o.config.host,n=o.config.recsPath,i=o.getEncodedComponent("recSys",o.user.recSys,!0)+o.getEncodedComponent("limit",o.config.limit)+o.getEncodedComponent("assetUri",e)+(o.userProfileEnabled()?o.getEncodedComponent("userProfile",o.user.profile):"");return t&&n&&i?t+n+i:null},userProfileEnabled:function(){return o.user.profile&&3===Number(o.user.recSys)},getEncodedComponent:function(e,t,n){return(n?"?":"&")+e+"="+encodeURIComponent(t)},updateRecs:function(e){if(!o.isValidRecsData(e))return!1;var t=[];return e.items.forEach(function(e){o.isValidRec(e)&&t.push(e)}),o.recs=t,!0},updateUserProfile:function(e){e.userProfile&&(o.profileUpdated=o.user.profile!==e.userProfile)&&(o.user.profile=e.userProfile)},isValidRecsData:function(e){return e&&"object"==typeof e&&e.hasOwnProperty("items")&&Array.isArray(e.items)},isValidRec:function(e){return e&&"object"==typeof e&&e.hasOwnProperty("assetUri")&&e.hasOwnProperty("ampUri")&&e.hasOwnProperty("shortHeadline")&&e.hasOwnProperty("imageHref")}};return o}),define("module/components/remotePortlet",["module/bootstrap","module/components/handler"],function(e,t){return{runDependent:function(e){if("on"===e.opts.js){var t=e.opts.js_dependency?e.opts.js_dependency:e.opts.id;require(["module/components/"+t],function(t){t.init(e)})}},handleSuccess:function(e,n){void 0!==n&&t.handleSuccess(e,n),this.runDependent(e)}}}),define("module/components/responsiveSurveyBanner",["module/bootstrap","module/cookieUtils","module/bannerUtils"],function(e,t,n){function o(){a("#responsive-survey__take-me-there").on("click",function(e){e.preventDefault(),e.stopPropagation(),window.open(this.href,"_blank").opener=null,s.setSurveyTakenCookie(),i()}),a("#responsive-survey__go-back").on("click",function(e){e.preventDefault(),s.optOut(),i()}),a("#responsive-survey__dismiss").on("click",function(e){s.removeFixedModifierFromBanner(),s.setBannerDismissedCookie(),s.removeOrbFooterPadding()})}function i(){a("#news-banner").hide()}var s,a=e.$;return{handleSuccess:function(e){s=new n({cookieName:"ckps_responsive_survey",cookieExpiryInDays:90,optInValue:"i",optOutValue:"o",surveyTakenValue:"s",dismissedValue:"d"}),s.isOptedOut()||s.isSurveyTaken()||(s.displayBanner(),o())}}}),define("module/components/shareToolsAdapter",["module/components/shareTools"],function(e){e.handleSuccess({selector:"#sharetools-lightweight, .js-share-tools"})}),define("module/components/shoebill/view",["module/bootstrap"],function(e){var t=e.$,n=function(e){e=e||{},this.containerClass=e.containerClass||"shoebill",this.itemsCount=e.itemsCount||4,this.interval=e.interval||4e3,this.intervalId=null,this.currentIndex=0,this.itemSelectedClass="shoebill-item--selected",this.imageHiddenClass="shoebill-image--hidden",this.footerHiddenClass="shoebill-footer--hidden",this.animatedClass="shoebill--animated",this.$container=t("."+this.containerClass),this.$leadItem=this.$container.find(".shoebill-lead-item"),this.$leadImageContainer=this.$container.find(".shoebill-lead-item__image"),this.$itemContainer=this.$container.find(".shoebill-item-container"),this.$items=this.$container.find(".shoebill-item"),this.$footer=this.$container.find(".shoebill-footer"),this.$startButton=this.$container.find(".shoebill-footer__button.start-button"),this.$stopButton=this.$container.find(".shoebill-footer__button.stop-button"),this.init()};return n.prototype.init=function(){this.bindEvents(),this.prepareImages(),this.replaceUrls(),this.showFooter(),this.isLeadItemVisible()&&(this.selectItem(this.currentIndex),e.window.setTimeout(t.proxy(this.startTransition,this),2e3))},n.prototype.bindEvents=function(){this.$leadItem.on("mouseenter",t.proxy(this.onLeadItemMouseEnter,this)),this.$leadItem.on("click",t.proxy(this.onLeadItemClick,this)),this.$itemContainer.on("mouseenter",t.proxy(this.onItemContainerMouseEnter,this)),this.$itemContainer.on("mouseleave",t.proxy(this.onItemContainerMouseLeave,this)),this.$items.on("mouseenter",t.proxy(this.onItemMouseEnter,this)),this.$startButton.on("click",t.proxy(this.onStartButtonClick,this)),this.$stopButton.on("click",t.proxy(this.onStopButtonClick,this))},n.prototype.onItemContainerMouseEnter=function(e){this.isAnimated()&&this.stopTransition(),this.$items.removeClass(this.itemSelectedClass)},n.prototype.onItemContainerMouseLeave=function(e){this.$items.eq(this.currentIndex).addClass(this.itemSelectedClass)},n.prototype.onItemMouseEnter=function(e){this.currentIndex=t(e.currentTarget).index(),this.showImage(this.currentIndex)},n.prototype.onLeadItemMouseEnter=function(e){this.stopTransition()},n.prototype.onLeadItemClick=function(e){var t=this.$items.eq(this.currentIndex),n=t.find(".title-link").attr("href");this.updateLocationUrl(n)},n.prototype.onStartButtonClick=function(e){this.selectNextItem(),this.startTransition()},n.prototype.onStopButtonClick=function(e){this.stopTransition()},n.prototype.isLeadItemVisible=function(){return"block"===this.$leadItem.css("display")},n.prototype.prepareImages=function(){var e=this.$leadImageContainer.find(".shoebill-image"),n=this.$container.find(".shoebill-item .responsive-image");if(!e.length)for(var o=0;o<n.length;o++){var i=t("<div></div>").attr("class","shoebill-image "+this.imageHiddenClass).attr("id","shoebill-image-"+o).append(t(n[o]).clone());this.$leadImageContainer.append(i)}},n.prototype.hidePlaceholderImage=function(){this.$leadImageContainer.children(".responsive-image:first").hide()},n.prototype.replaceUrls=function(){var e=this.$container.find(".group-title__link");e.length&&(this.$items.each(function(n){var o=e.attr("href")+"/"+t(this).data("asset-id");t(this).find("a").attr("href",o)}),this.$footer.find("a").attr("href",e.attr("href")))},n.prototype.updateLocationUrl=function(t){t&&(e.window.location.href=t)},n.prototype.showFooter=function(){this.$footer.removeClass(this.footerHiddenClass)},n.prototype.showImage=function(e){var n=t("#shoebill-image-"+e);n.length&&(this.$leadImageContainer.find(".shoebill-image").addClass(this.imageHiddenClass),n.removeClass(this.imageHiddenClass))},n.prototype.selectItem=function(e){this.currentIndex=e,this.showImage(e),this.$items.removeClass(this.itemSelectedClass),this.$items.eq(e).addClass(this.itemSelectedClass)},n.prototype.selectNextItem=function(){var e=this.currentIndex<this.itemsCount-1?this.currentIndex+1:0;this.selectItem(e)},n.prototype.startTransition=function(){this.stopTransition(),this.hidePlaceholderImage();var n=t.proxy(function(){this.selectNextItem(),0===this.currentIndex&&this.stopTransition()},this);this.intervalId=e.window.setInterval(n,this.interval),this.$container.addClass(this.animatedClass),this.showStopButton()},n.prototype.stopTransition=function(){e.window.clearInterval(this.intervalId),this.intervalId=null,this.$container.removeClass(this.animatedClass),this.showStartButton()},n.prototype.showStartButton=function(){this.$startButton.removeClass("start-button--hidden"),this.$stopButton.addClass("stop-button--hidden")},n.prototype.showStopButton=function(){this.$stopButton.removeClass("stop-button--hidden"),this.$startButton.addClass("start-button--hidden")},n.prototype.isAnimated=function(){return null!==this.intervalId},n}),define("module/components/shoebill/main",["module/bootstrap","module/components/shoebill/view"],function(e,t){var n=function(){var e=$(".container-shoebill").length>0?"container-shoebill.wide-only":"shoebill";this.view=new t({containerClass:e}),this.registerEventHandlers()};return n.prototype.registerEventHandlers=function(){e.pubsub.on("deviceGroup",$.proxy(this.handleResize,this))},n.prototype.handleResize=function(e){"group4"===e?this.view.isAnimated()||this.view.startTransition():this.view.stopTransition()},n}),define("module/components/shoebillAdapter",["module/components/shoebill/main"],function(e){new e}),define("module/components/socialEmbed/analytics",["istats-1"],function(e){"use strict";var t=function(){var e=document.getElementsByClassName("social-embed-post"),t="";if(e.length>0){for(var n=0;n<e.length;n++)t+=0!==n?"|":"",t+=e[n].className.replace("social-embed-post social-embed-","");return{embed_count:e.length,embed_list:t}}};return{init:function(){var n=t();n&&e.log("load","socialEmbed",n)}}}),define("module/components/socialEmbed/view",["module/bootstrap","module/featureDetector","vendor/lo-dash/lo-dash"],function(e,t,n){"use strict";var o=!1,i=!1,s=!1,a=function(){c(),r()},r=function(){$(window).on("scroll",c)},c=function(){o=!!o||l("embed-twitter",300,"https://platform.twitter.com/widgets.js"),i=!!i||l("embed-facebook",600,"https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.3"),s=!!s||l("embed-instagram",300,"https://platform.instagram.com/en_US/embeds.js"),u(300)},l=function(e,t,n){var o=document.getElementsByClassName(e);if(0!==o.length&&d(o[0],t)){var i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.src=n,document.getElementsByTagName("head")[0].appendChild(i),!0}},u=function(e){for(var t=document.getElementsByClassName("embed-iframe"),n=0;n<t.length;n++){var o=t[n].getAttribute("data-iframe");o&&d(t[n],e)&&(t[n].getElementsByClassName("embed-iframe-inner")[0].innerHTML=o,t[n].className="embed embed-iframe-rendered")}},d=function(e,t){var n=e.getBoundingClientRect().bottom,o=e.scrollHeight;return n<=window.innerHeight+o+t};return{init:a}}),define("module/components/socialEmbed/handler",["module/bootstrap","module/components/socialEmbed/view","module/components/socialEmbed/analytics"],function(e,t,n){"use strict";return{init:function(){t.init(),n.init()}}}),define("module/components/socialEmbedAdapter",["module/components/socialEmbed/handler"],function(e){e.init()}),define("module/components/spoonbill/view",["module/bootstrap"],function(e){var t=e.$,n=function(e){this.$container=e,this.$items=this.$container.find(".spoonbill-item"),this.$link=this.$container.find(".spoonbill__link"),this.init()};return n.prototype.init=function(){var e=this.$container.attr("class").indexOf("compact-tablet")>-1;this.replaceUrls(e)},n.prototype.replaceUrls=function(e){var n,o,i=this.$link.attr("href");this.$items.each(function(s){(n=t(this).data("asset-id"))&&(o=i+"/"+n,e&&(o+="#video-"+n),t(this).find("a").attr("href",o))})},n}),define("module/components/spoonbill/main",["module/bootstrap","module/components/spoonbill/view"],function(e,t){var n=e.$;return function(){var e=[".container-spoonbill.wide-only",".container-spoonbill.compact-tablet-only"];n.each(e,function(e,o){n(o).length>0&&new t(n(o))}),n(".style-guide").length>0&&new t(n(".spoonbill"))}}),define("module/components/spoonbillAdapter",["module/components/spoonbill/main"],function(e){new e}),define("module/components/sport",["module/bootstrap","module/components/hardNewsUnit","translator"],function(e,t,n){var o=e.$;return{handleSuccess:function(e,n){this.selector=o(e.selector),this.teams=this.selector.find("#sport-teams").removeClass("hidden").hide(),this.sportStories=this.selector.find("#latest-sport-stories"),t.init(e.selector),this.sportStories.length&&this.teams.length&&this.renderTabs(),0===this.sportStories.length&&this.teams.length&&this.teams.show()},renderTabs:function(){this.selector.find("#latest-sport-stories").before(o('<ul class="tabs-list js-tabs-list" role="tablist">                <li id="tab-1" class="open" role="presentation"><a href="#latest-sport-stories"                    role="tab" tabindex="0">Latest stories<span class="off-screen"> selected</span>                    </a></li>                <li id="tab-2" role="presentation"><a href="#sport-teams"                     role="tab" tabindex="-1">Local teams</a></li></ul>')),this.selector.addClass("has-tabs"),this.tabs=this.selector.find(".js-tabs-list li"),this.tabs.find("a").on("click",o.proxy(this.toggleTabs,this)),this.tabs.find("a").on("keydown",o.proxy(this.handleKeypress,this))},toggleTabs:function(e){this.selector.find(".js-tab-content").attr("aria-hidden","true").hide(),this.tabs.removeClass("open"),this.tabs.find("a").attr("tabindex","-1");var t=o("#"+e.target.href.split("#")[1]),n=o(e.target),i=n.parent();return this.tabs.find("span.off-screen").appendTo(n),i.addClass("open"),n.attr("tabindex","0"),t.attr("aria-hidden","false").show(),!1},handleKeypress:function(e){var t,n=o(e.target).parent(),i=n.next().find("a"),s=n.prev().find("a"),a=n.parent().find("a").first(),r=n.parent().find("a").last();e.which&&(39===e.which?t=i.length?i:a:37===e.which&&(t=s.length?s:r)),t&&(t.trigger("click"),t[0].focus())}}}),define("module/sport/sportView",["module/bootstrap","module/deviceInspector","translator"],function(e,t,n){var o,i=e.$,s=function(){},a=(i("#latest-sport-stories .sport-stories__more-button"),n.get("showMore")),r=n.get("showLess"),c=n.get("latestSportStories");return s.prototype={init:function(e,n){o=n||t.init(),this.selectorContainer=e instanceof i?e:i(e),this.headlineContainer=this.selectorContainer.find(".sport-stories__headline-stories"),0!==this.selectorContainer.length&&/group(1|2)/i.test(o.getGroup())&&(this.setUpStories(),this.button&&this.bindEvents())},setUpStories:function(){var e=this.selectorContainer.find(".sport-stories__headline-story");if(e.length>4&&/group(1|2)/i.test(o.getGroup())){e.slice(4).addClass("sport-stories__headline-story--toggle"),this.headlineContainer.addClass("sport-stories__headline-stories--hide"),this.appendButton()}},bindEvents:function(){i(window).on("resize",i.proxy(this.handleResize,this))},appendButton:function(){this.selectorContainer.find("#latest-sport-stories").append('<button class="sport-stories__more-button">'+a+'<span class="off-screen"> '+c+"</span></button>"),this.button=i(".sport-stories__more-button"),this.button.on("click",i.proxy(this.handleButtonEvent,this))},handleButtonEvent:function(){this.toggleStories(),this.toggleButtonState()},toggleButtonState:function(){var e=this.button[0].childNodes[0];e.nodeValue===a?(e.nodeValue=r,this.selectorContainer.find("a.sport-stories__headline-story--toggle")[0].focus()):(e.nodeValue=a,this.button[0].focus())},toggleStories:function(){this.headlineContainer.toggleClass("sport-stories__headline-stories--hide")},handleResize:function(e){/group3|4/i.test(o.getGroup())?(this.headlineContainer.hasClass("sport-stories__headline-stories--hide")&&(this.toggleStories(),this.button[0].textContent===r+" "+c&&this.toggleButtonState()),this.button.css("display","none")):(0===i("#latest-sport-stories .sport-stories__more-button").length&&this.setUpStories(),this.headlineContainer.addClass("sport-stories__headline-stories--hide"),this.button.css("display","block"))}},s}),define("module/components/sportAdapter",["module/bootstrap","module/components/sport","module/sport/sportView"],function(e,t,n){if(e.$("#comp-sport-stories").length>0){var o=new n;t.handleSuccess(e.$("#comp-sport-stories")),o.init(e.$("#comp-sport-stories"))}}),define("module/components/sportBanner",["module/bootstrap"],function(e){var t=e.$;return{sessionStorageKey:"sport_banner_status",bannerHiddenKey:"hidden",bannerMinimisedKey:"min",selectors:{banner:".sport-banner__container",footer:"#orb-footer",refresh_button:".sport-banner__container .refresh-icon",close_button:".sport-banner__container .close-icon",expand_button:".sport-banner__container .expand-icon",scorecard_link:".sport-banner__container .full-scorecard-link",topic_link:".sport-banner__container .secondary-content"},classes:{banner_visible:"sport-banner__container--visible",banner_minimised:"sport-banner__container--minimised"},url:"/pattern-library-components?presenter=sport-banner&options[]",init:function(){e.pubsub.emit("sportBanner:loaded");var t="/hindi";window.config&&window.config.service&&(t="/"+window.config.service),this.url=t+this.url,this.bannerSetup()},bannerSetup:function(){var n=this;t(this.selectors.close_button).on("click",function(t){t.preventDefault(),t.stopPropagation(),e.pubsub.emit("sportBanner:closeButton:clicked"),n.disableBanner()}),t(this.selectors.expand_button).on("click",function(e){e.preventDefault(),e.stopPropagation(),n.toggleMinMax()}),t(this.selectors.refresh_button).on("click",function(t){t.preventDefault(),t.stopPropagation(),e.pubsub.emit("sportBanner:refreshButton:clicked"),n.refreshBanner()}),t(this.selectors.scorecard_link).on("click",function(t){t.stopPropagation(),e.pubsub.emit("sportBanner:fullScorecard:clicked")}),t(this.selectors.topic_link).on("click",function(t){t.stopPropagation(),e.pubsub.emit("sportBanner:topicLink:clicked")}),this.shouldShowBanner()&&this.showBanner()},hideBanner:function(){this.hideLoader(),t(this.selectors.banner).removeClass(this.classes.banner_visible),this.bannerUpdated()},showBanner:function(){this.hideLoader(),this.shouldMinimiseBanner()&&this.minimiseBanner(),t(this.selectors.banner).addClass(this.classes.banner_visible),this.bannerUpdated()},setBannerStatus:function(e){if(window.sessionStorage){if(!e)return void sessionStorage.removeItem(this.sessionStorageKey);sessionStorage.setItem(this.sessionStorageKey,e)}},toggleMinMax:function(){if(this.isBannerMinimised())return e.pubsub.emit("sportBanner:expandButton:clicked"),this.maximiseBanner(),void this.setBannerStatus();e.pubsub.emit("sportBanner:collapseButton:clicked"),this.minimiseBanner(),this.setBannerStatus(this.bannerMinimisedKey)},minimiseBanner:function(){var e=this;t(this.selectors.banner).addClass(this.classes.banner_minimised),t(this.selectors.banner).on("click",function(t){t.preventDefault(),e.toggleMinMax()}),this.bannerUpdated()},maximiseBanner:function(){t(this.selectors.banner).removeClass(this.classes.banner_minimised),t(this.selectors.banner).off("click"),this.bannerUpdated()},disableBanner:function(){this.hideBanner(),t(this.selectors.banner).off("click"),this.setBannerStatus(this.bannerHiddenKey)},shouldShowBanner:function(){return!window.sessionStorage||sessionStorage.getItem("sport_banner_status")!==this.bannerHiddenKey},shouldMinimiseBanner:function(){return!!window.sessionStorage&&sessionStorage.getItem("sport_banner_status")===this.bannerMinimisedKey},isBannerMinimised:function(){return t(this.selectors.banner).hasClass(this.classes.banner_minimised)},showLoader:function(){t(this.selectors.banner).css({opacity:.85})},hideLoader:function(){t(this.selectors.banner).css({opacity:1})},refreshBanner:function(){var e=this;this.showLoader(),t.ajax({url:this.url,dataType:"json",success:function(n){if(n.html){t(n.html).is(e.selectors.banner)&&(t(e.selectors.banner).replaceWith(t(n.html)),e.bannerSetup())}},error:function(){e.hideLoader()}})},bannerUpdated:function(){var e=0,n=t(this.selectors.banner).first();n&&"none"!==n.css("display")&&(e=t(this.selectors.banner).height()),t(this.selectors.footer).css({"margin-bottom":e})}}}),define("module/components/stickyPlayer/main",["module/bootstrap"],function(e){"use strict";var t=e.$,n={stickyPlayer:".sticky-player",player:".sticky-player__player",closeButton:".sticky-player__close-button"},o={enabled:"sticky-player--enabled",pinned:"sticky-player--pinned",visible:"sticky-player--visible"},i=function(o,i,s){s=s||{},this.mediaPlayerDomId="media-player",this.stickyPlayerDomId="sticky-player",i>0&&(this.mediaPlayerDomId+="-"+i,this.stickyPlayerDomId+="-"+i),this.state={enabled:!1,pinned:!1,visible:!1},this.isTouchDevice=s.isTouchDevice||!1,this.isTouchEvent=!1,this.scrollThreshhold=300,this.scrollHandler=this.throttle(this.onWindowScroll,this.scrollThreshhold,this),this.showTimerId=null,this.isDebug=document.location&&null!==document.location.search.match(/debug=1/),this.wrapPlayer(t(o)),this.$window=t(e.window),this.$body=t("body"),this.$container=t("#"+this.stickyPlayerDomId),this.$player=this.$container.find(n.player),this.$closeButton=this.$container.find(n.closeButton),this.$placeholder=t("#"+this.stickyPlayerDomId+"-placeholder")};return i.prototype.bindEvents=function(){this.$window.on("scroll",this.scrollHandler),this.$container.on("click",t.proxy(this.onContainerClick,this)),this.$player.on("click",t.proxy(this.onPlayerClick,this)),this.$closeButton.on("click",t.proxy(this.onExitButtonClick,this)),this.isTouchDevice&&(this.$window.on("touchstart",t.proxy(this.onTouchStart,this)),this.$window.on("touchend",t.proxy(this.onTouchEnd,this)))},i.prototype.unbindEvents=function(){this.$window.off("scroll",this.scrollHandler),this.$container.off("click"),this.$player.off("click"),this.$closeButton.off("click"),this.isTouchDevice&&(this.$window.off("touchstart",t.proxy(this.onTouchStart,this)),this.$window.off("touchend",t.proxy(this.onTouchEnd,this)))},i.prototype.onWindowScroll=function(e){this.isEnabled()&&!this.isTouchEvent&&(this.updatePosition(),this.log("scrolled"))},i.prototype.onContainerClick=function(e){e.stopPropagation(),this.isEnabled()&&this.isVisible()&&this.scrollPlayerIntoView()},i.prototype.onPlayerClick=function(e){e.stopPropagation()},i.prototype.onExitButtonClick=function(e){e.stopPropagation(),this.disable()},i.prototype.onTouchStart=function(e){this.isTouchEvent=!0,this.clearTimeout("showTimerId")},i.prototype.onTouchEnd=function(e){this.isTouchEvent=!1,this.updatePosition()},i.prototype.enable=function(){!this.isEnabled()&&this.$container.length>0&&(this.bindEvents(),this.$body.addClass(n.stickyPlayer.substring(1)),this.$container.addClass(o.enabled),this.state.enabled=!0,this.log("enabled"))},i.prototype.disable=function(){this.isEnabled()&&(this.hide(),this.unbindEvents(),
this.getNumberOfPlayersEnabled()<=1&&this.$body.removeClass(n.stickyPlayer.substring(1)),this.$container.removeClass(o.enabled),this.state.enabled=!1,this.log("disabled"))},i.prototype.isEnabled=function(){return this.state.enabled},i.prototype.getNumberOfPlayersEnabled=function(){return t("."+o.enabled).length},i.prototype.updatePosition=function(){if(this.isEnabled()&&!this.isTouchEvent)if(this.isPlayerInViewport())(this.isPinned()||this.isVisible())&&this.hide();else if(this.isPinned()||this.pin(),!this.isVisible()){var e=this.isTouchDevice?this.scrollThreshhold+100:100;this.setTimeout(this.show,"showTimerId",e)}},i.prototype.setTimeout=function(n,o,i){this.clearTimeout(o),this[o]=e.window.setTimeout(t.proxy(n,this),i)},i.prototype.clearTimeout=function(t){e.window.clearTimeout(this[t]),this[t]=null},i.prototype.show=function(){this.isPinned()||this.pin(),this.$container.addClass(o.visible),this.state.visible=!0,this.log("visible")},i.prototype.hide=function(){this.unpin(),this.$container.removeClass(o.visible),this.state.visible=!1,this.log("hidden")},i.prototype.isVisible=function(){return this.state.visible},i.prototype.pin=function(){this.isPinned()||(this.showPlaceholderElement(),this.$container.addClass(o.pinned),this.state.pinned=!0)},i.prototype.unpin=function(){this.isPinned()&&(this.hidePlaceholderElement(),this.$container.removeClass(o.pinned),this.state.pinned=!1)},i.prototype.isPinned=function(){return this.state.pinned},i.prototype.isPlayerInViewport=function(){var e,t,n,o;return e=this.isPinned()?this.$placeholder.get(0).getBoundingClientRect():this.$container.get(0).getBoundingClientRect(),t=this.$window.height(),n=e.top>=0&&e.top<t,o=e.bottom>0&&e.bottom<=t,n||o},i.prototype.renderTemplate=function(e){var n='            <div id="{{id}}">                <div class="{{class}}__wrapper">                    <div class="{{class}}__player"></div>                    <div class="{{class}}__body">                        <h2 class="{{class}}__headline">{{title}}</h2>                    </div>                    <button class="{{class}}__close-button falcon__button">                        <span class="off-screen">Exit player</span>                    </button>                </div>            </div>            <div id="{{id}}-placeholder" class="{{class}}__image responsive-image"></div>';for(var o in e)n=n.replace(new RegExp("{{"+o+"}}","ig"),e[o]);return t(n)},i.prototype.wrapPlayer=function(e){var o,i;o=this.getPlayableData(e),i=this.renderTemplate({class:n.stickyPlayer.substring(1),id:this.stickyPlayerDomId,title:t("<div/>").text(o.title).html()}),e.hasClass("media-player")&&(e.replaceWith(i),i.find(n.stickyPlayer+"__player").append(e),this.log("wrapped around "+this.mediaPlayerDomId))},i.prototype.getPlayableData=function(e){var t=e.data("playable");return t&&t.settings&&t.settings.playlistObject?t.settings.playlistObject:{}},i.prototype.showPlaceholderElement=function(){this.$placeholder.css({height:this.$player.height()}).addClass("sticky-player__image--visible")},i.prototype.hidePlaceholderElement=function(){this.$placeholder.removeClass("sticky-player__image--visible")},i.prototype.scrollPlayerIntoView=function(){this.$placeholder.get(0).scrollIntoView?this.$placeholder.get(0).scrollIntoView():e.window.location.href="#"+this.$placeholder.attr("id")},i.prototype.throttle=function(t,n,o){n=n||100;var i,s;return function(){var a=o||this,r=+new Date,c=arguments;i&&r<i+n?(e.window.clearTimeout(s),s=e.window.setTimeout(function(){i=r,t.apply(a,c)},n)):(i=r,t.apply(a,c))}},i.prototype.log=function(t){this.isDebug&&e.window.console&&e.window.console.log("[Sticky Player] "+this.stickyPlayerDomId+" "+t)},i}),define("module/components/stickyPlayer/factory",["module/components/stickyPlayer/main","module/featureDetector","module/bootstrappedJquery"],function(e,t,n){"use strict";return{build:function(){var o,i={},s={isTouchDevice:t.is("TouchDevice")};return n.each(n(".js-media-player-unprocessed"),function(t,n){o=new e(n,t+1,s),i[o.mediaPlayerDomId]=o}),i}}}),define("module/components/stickyPlayer/handler",["module/components/stickyPlayer/factory","module/components/mediaPlayer/main","module/bootstrappedJquery"],function(e,t,n){"use strict";var o={},i={},s={},a=function(){o=e.build(),t.processNewPlayers(),r()},r=function(){t.subscribeToPlayerEvent("initialised",function(e,t){t.bind("adsPlugin",function(e){"adStarted"===e.id&&l(t)}),t.bind("bbc.smp.plugins.preview",function(e){c(t.settings().domid,e.id)})}),t.subscribeToPlayerEvent("playing",function(e,t){l(t)}),t.subscribeToPlayerEvent("ended",function(e,t){u(t)})},c=function(e,t){s[e]="start"===t||!1},l=function(e){var t=e.settings();if(t.domid){if(i[t.domid]=e,!0===s[t.domid])return;n.each(i,function(e,n){t.domid===e||n.paused()||!0===s[t.domid]||n.pause()}),n.each(o,function(e,n){t.domid===e?n.enable():n.disable()})}},u=function(e){var t=e.settings();t.domid&&n.each(o,function(e,n){t.domid===e&&n.disable()})};return{init:a}}),define("module/components/stickyPlayer/mainAdapter",["module/components/stickyPlayer/handler"],function(e){"use strict";e.init()}),define("module/components/storiesGroup",["module/components/hardNewsUnit"],function(e){var t=!1;return{handleSuccess:function(n){t||(e.init(".stories-group"),t=!0)}}}),define("module/components/swift/view",["module/bootstrap","module/polyfill/bind"],function(e){var t=function(t){this.element=t,this.$contentContainer=e.$(this.element).find(".js-polling-content-container"),this.events=e.$({}),this.$contentContainer.on("transitionend webkitTransitionEnd",function(e){e.originalEvent&&"opacity"!==e.originalEvent.propertyName&&this.events.trigger("first-animation-end")}.bind(this)),this.events.on("first-animation-end",function(){this.$contentContainer.html(this.newItemNodes),this.$contentContainer.removeClass("swift-body--start-animation")}.bind(this))};return t.prototype.getSelector=function(){return".swift"},t.prototype.getPollingUrl=function(){if(this.element)return this.element.getAttribute("data-polling-url")},t.prototype.startAnimationAndInsertHtml=function(e){this.$contentContainer.addClass("swift-body--start-animation");var t=document.createElement("div");t.innerHTML=e,this.newItemNodes=t.childNodes},t.prototype.afterEntryIsInsertedAndSecondAnimationStarts=function(e){this.events.on("first-animation-end",e)},t}),define("module/components/swift/main",["module/bootstrap","module/poller","module/components/swift/view","module/alternativeJsStrategy/processJsDependencies","module/polyfill/bind"],function(e,t,n,o){var i=1,s=function(e){this.view=new n(e);var o=this.view.getPollingUrl();o&&(this.pollerInstance=new t(3e4),this.pollerInstance.setUrl(o),this.pollerInstance.startPolling({callbackName:"swift"+i++,success:this.processSuccessfulResponse.bind(this)}),this.view.afterEntryIsInsertedAndSecondAnimationStarts(function(){require(["module/components/timestampAdaptor"],function(e){e.reProcess(this.view.getSelector())}.bind(this))}.bind(this)))};return s.prototype.processSuccessfulResponse=function(e){e.entryId&&e.entryId!==this.currentEntryId&&0!==e.html.trim().length&&(this.currentEntryId=e.entryId,this.view.startAnimationAndInsertHtml(e.html))},s.prototype.stopPolling=function(){this.pollerInstance.stopPolling()},s}),define("module/components/swift/collection",["module/components/swift/main","module/bootstrap"],function(e,t){var n=function(e,n){e=e||t.window.document,n=n||function(){};var o,i=e.getElementsByClassName("swift"),s=i.length;for(o=0;o<s;o++)n(i[o])},o=function(e){n(e,function(e){e.swiftPoller.stopPolling()})};return{init:function(t){n(t,function(t){t.swiftPoller||(t.swiftPoller=new e(t))})},cleanup:o}}),define("module/components/swiftAdapter",["module/components/swift/collection"],function(e){e.init()}),define("module/components/titanis/view",["module/bootstrap"],function(e){var t=(e.$,function(e){this.$container=e,this.$image=this.$container.find(".titanis__image"),this.$body=this.$container.find(".titanis__body"),this.$label=this.$container.find(".titanis__label")});return t.prototype.startAnimation=function(){this.$image.removeClass("titanis__image--hidden"),this.$body.removeClass("titanis__body--hidden");var e=this;setTimeout(function(){e.$label.removeClass("titanis__label--fadein")},1800)},t}),define("module/components/titanis/main",["module/bootstrap","module/components/titanis/view","module/components/in_view_detector"],function(e,t,n){var o=e.$,i=function(e){this.el=o(e),this.view=new t(this.el),this.el.length>0&&(this.registerEventHandlers(),this.initInViewDetector())};return i.prototype.registerEventHandlers=function(){e.pubsub.on("module:in:view",o.proxy(this.handleModuleInView,this))},i.prototype.handleModuleInView=function(e){this.el.get(0)===o(e).get(0)&&this.view.startAnimation()},i.prototype.initInViewDetector=function(){n.register("titanis"),n.checkModulesInView()},i}),define("module/components/titanisAdapter",["module/components/titanis/main"],function(e){new e(".titanis")}),define("module/components/topStories",["module/bootstrap","module/components/liveEventPromo","module/components/hardNewsUnit","module/components/localLive"],function(e,t,n,o){return{handleSuccess:function(i){var s=e.$(i.selector);n.init(i.selector),s.hasClass("js-has-live-event-promo")&&t.handleSuccess(),s.hasClass("js-has-local-live-promo")&&o.handleSuccess("#comp-local-live")}}}),define("module/components/topStoriesAdapter",["module/components/topStories"],function(e){e.handleSuccess({selector:"#top-stories"})}),define("module/components/topicalStories",["module/components/hardNewsUnit"],function(e){return{handleSuccess:function(t){e.init(t.selector)}}}),define("module/components/twite/analytics",[],function(){"use strict";var e=!1,t={clicked:"twite:shareTools:clicked"};return{init:function(){try{e=window.bbcdotcom&&bbcdotcom.config.isAnalyticsEnabled()}catch(e){}},track:function(n,o){if(e){if(!t[n])throw'Event name "'+n+'" not defined';var i=t[n],s=o||{};try{bbcdotcom.trackEvent(i,s)}catch(e){}}}}}),define("module/components/twite/view",["module/bootstrap","module/featureDetector","vendor/lo-dash/lo-dash"],function(e,t,n){"use strict";var o,i={shareButton:".twite__share-button",closeButton:".twite__close-button",panel:".twite__panel",channelLink:".twite__channel-link",extractedLink:".extracted__channel-link",shareLink:".twite__share-link",container:".container-twite",miniInfoTimestamp:".mini-info-list-wrap",miniInfoTwite:".share-tools--no-event-tag",twiteListMobileElements:".twite__channel-out--mobile"},s=e.$,a=function(){l(),O(),o=s("#page"),r()},r=function(){var e=s(i.miniInfoTimestamp).width(),t=s(i.miniInfoTimestamp).parent().width(),n=t-e-44;s(i.miniInfoTwite).width()>n&&c(n)},c=function(e){var t=s(i.twiteListMobileElements).length;if(t)for(var n=s(i.twiteListMobileElements),o=t-Math.floor(e/44),a=1;a<=o;a++)n.length>=a&&n[t-a].remove()},l=function(){s(i.shareButton).on("click",u),s(i.channelLink).on("click",m),s(i.extractedLink).on("click",f),s(i.panel).on("click",g),s(i.closeButton).on("click",p),s(i.shareLink).on("click",v),s(window).on("resize",r),e.pubsub.on("timestamp:relative:done",r),s("html").on("click",b),H()},u=function(e){e.preventDefault(),e.stopPropagation();var t=s(this).next();"visible"===t.css("visibility")?C(t):(x(),T(t),y(t)),d()},d=function(){s(i.shareButton).each(function(){var e=s(this).next();s(this).attr("aria-expanded","visible"===e.css("visibility"))})},h=function(){return document.getElementsByClassName("direction").length>0&&"rtl"===document.getElementsByClassName("direction")[0].getAttribute("dir")},p=function(e){e.preventDefault(),e.stopPropagation(),C(s(this).parent()),d()},m=function(t){t.stopPropagation();var n=s(this).closest(i.panel).prev(),o=s(this).find("span").attr("data-platform"),a=n.data("origin");e.pubsub.emit("shareTools:channel:clicked",[o,a]),e.pubsub.emit("shareTools:"+o+":clicked")},f=function(t){t.stopPropagation();var n=s(this).find("span").attr("data-platform");n="extracted"+n,e.pubsub.emit("shareTools:channel:clicked",[n,"page"]),e.pubsub.emit("shareTools:"+n+":clicked")},g=function(e){e.stopPropagation()},v=function(e){e.preventDefault(),e.stopPropagation(),$(s(this))},b=function(e){x()},y=function(e,t){e.addClass("show"),o.length&&_(I(e)-P()),w()},w=function(){s(window).on("resize.twite",n.debounce(function(){var e=s(i.panel+".show");o.length&&_(I(e)-P())},150))},_=function(e){o.length&&o.css("min-height",e)},k=function(){_(0),s(window).off("resize.twite")},C=function(e){S(e),e.prev()[0].focus(),k()},x=function(){S(s(i.panel)),k()},S=function(e){e.removeClass().addClass("twite__panel")},T=function(e){var t="arrow-top-right";h()?R()?M()?(e.css("top",-(A(e)+31)),e.css("right",0),t="arrow-bottom-left"):(e.css("top",-(A(e)+31)),e.css("left",0),t="arrow-bottom-right"):M()?(e.css("right",0),t="arrow-top-left"):(e.css("left",0),t="arrow-top-right"):R()?D()?(e.css("top",-(A(e)+31)),e.css("left",0),t="arrow-bottom-left"):(e.css("top",-(A(e)+31)),e.css("right",0),t="arrow-bottom-right"):D()?(e.css("left",0),t="arrow-top-left"):(e.css("right",0),t="arrow-top-right"),e.addClass(t)},P=function(){return parseInt(o.offset().top,10)-20},E=function(e){return parseInt(e.offset().top,10)},I=function(e){return E(e)+A(e)},A=function(e){return parseInt(e.css("height"),10)},L=function(e,t){N(e,t),B(e,t)},N=function(e,t){e.find(i.channelLink).each(function(e){var n=t.find(i.channelLink).eq(e);s(this).attr("href")!==n.attr("href")&&n.attr("href",s(this).attr("href"))})},B=function(e,t){var n=e.find(i.panel).data("share-uri"),o=window.location.protocol+"//"+window.location.hostname+n;t.find(i.shareLink).attr("href",o).text(o)},$=function(e){document.execCommand("selectAll",!1,e.get(0))},R=function(){return s(i.shareButton).offset().top>s(i.panel).height()+50},D=function(){return s(i.shareButton).offset().left+s(i.panel).width()<document.documentElement.clientWidth},M=function(){return s(i.shareButton).offset().left>s(i.panel).width()},H=function(){s("#site-container").on("focus","#page",function(e){0===s(i.container).has(e.target).length&&(x(),d())})},O=function(){s(".sharetools").addClass("sharetools--reveal"),t.is("TouchDevice")||(s(".twite__channel-out--messengermobile").addClass("messenger-hide"),s(".twite__channel--messengermobile").addClass("messenger-hide"),s(".twite__channel-out--messengerdesktop").addClass("messenger-show"),s(".twite__channel--messengerdesktop").addClass("messenger-show"),s(".twite__channel-out--kakaostory").addClass("messenger-show"))};return{init:a,hidePanels:x,copyLinks:L,selectShareLink:$,checkSpacing:r}}),define("module/components/twite/handler",["module/bootstrap","module/components/twite/view","module/components/twite/analytics"],function(e,t,n){"use strict";var o=(e.$,function(){e.pubsub.on("shareTools:channel:clicked",i),e.pubsub.on("shareTools:links:update",s),e.pubsub.on("shareTools:panels:close",a)}),i=function(e,t){n.track("clicked",{platform:e,origin:t})},s=function(e,n){t.copyLinks(e,n)},a=function(){t.hidePanels()};return{init:function(){t.init(),n.init(),o()}}}),define("module/components/twiteAdapter",["module/components/twite/handler"],function(e){e.init()}),define("module/components/vocabWidget",["module/bootstrap","module/cookieUtils"],function(e,t){function n(e){var t;try{var n=n;t=new n("keypress",{bubbles:!0,cancelable:!1}),t.keyCode=e}catch(n){t=document.createEvent("Event"),t.initEvent("keypress",!0,!1),t.keyCode=e}return t}function o(e,t){e.dispatchEvent(t)}function i(){var e=y(".gwt-ToggleButton"),t=n(I);e[0].focus(),s(),o(e[0],t),k.toggleClass(P),v()}function s(){y(".translate").toggleClass("user-select-none")}function a(e,t,n){("string"==typeof e?y(e):e).attr(t,n)}function r(e){var n=!(!y(e).hasClass(E)&&!y(e).hasClass(P));t.setCookie(S,n)}function c(e){_.addClass("vocab-alert--show"),_.find(".vocab-alert__text").html(e)}function l(){_.removeClass("vocab-alert--show")}function u(e){d(e,C)?w.emit("vocab:clicked:enabled"):w.emit("vocab:clicked:disabled")}function d(e,t){return!1===t||y(e).hasClass(P)}function h(){y("body").on("click",T,function(){C?i():(g(),b()),u(this),r(this)})}function p(){y("body").on("click",".vocab_link",function(e){return e.stopPropagation(),!1})}function m(){y("body").on("click",".gwt-DecoratedPopupPanel .popupTopRightInner",function(e){y(".gwt-DecoratedPopupPanel").css({visibility:"hidden",display:"none"})})}function f(){y("body").on("click",".vocab-alert__close",function(){l()})}function g(){k.addClass(E)}function v(){k.removeClass(E)}function b(){!1===C&&require(["vendor/vocab/vocabKickoff"],function(){})}var y=e.$,w=e.pubsub,_=y(".js-vocab-alert"),k=y(".js-vocab-toggle"),C=!1,x=5e3,S="ckps_vocab_cf",T=".js-vocab-toggle",P="vocab-toggle--active",E="vocab-toggle--loading",I=13;return window.onVocabReady=function(){setTimeout(function(){y(".vocab-tool").addClass("vocab-tool--show"),a(T,"aria-disabled",!1),i(),C=!0},x)},window.onVocabError=function(e){a(T,"aria-disabled",!0),t.setCookie(S,!1),c(e),v(),w.emit("vocab:error",[e])},function(){return"true"===t.readCookie(S)}()&&(g(),w.emit("vocab:cookie:vocab-enabled"),b()),function(){window.vocabConfig={language:"cy",start:"#page",apikey:k.data("vocab-key")}}(),function(){h(),p(),m(),p(),f()}(),{setTimeoutValue:function(e){x=e}}}),define("vendor/locator/main",["module/bootstrap","locator/locatorView","locator/stats"],function(bootstrap,LocatorView,Stats){function doRequest(url,success,actionType,complete){"function"==typeof complete&&(complete=function(){}),bootstrap.ajax({url:url,dataType:"json",method:"get",complete:complete,success:success,error:function(e){var responseText,response;responseText=e&&e.responseText?e.responseText:"{}";try{response=window.JSON?window.JSON.parse(responseText):eval("("+responseText+")")}catch(e){response=null}bootstrap.pubsub.emit("locator:error",[response,actionType])}})}function normaliseCoordinate(e){return String(Math.round(1e3*e)/1e3)}var Locator,newsMap={3:"england/berkshire",4:"england/birmingham_and_black_country",7:"england/bristol",8:"england/cambridgeshire",11:"england/cornwall",12:"england/coventry_and_warwickshire",13:"england/cumbria",16:"england/derbyshire",17:"england/devon",18:"england/dorset",19:"scotland/edinburgh_east_and_fife",20:"england/essex",22:"scotland/glasgow_and_west",23:"england/gloucestershire",26:"world/europe/guernsey",27:"england/hampshire",28:"england/hereford_and_worcester",30:"scotland/highlands_and_islands",31:"england/humberside",32:"world/europe/isle_of_man",33:"world/europe/jersey",34:"england/kent",35:"england/lancashire",36:"england/leeds_and_west_yorkshire",37:"england/leicester",38:"england/lincolnshire",39:"england/merseyside",40:"england/london",41:"england/manchester",42:"wales/mid_wales",43:"england/norfolk",44:"england/northamptonshire",45:"scotland/north_east_orkney_and_shetland",46:"wales/north_east_wales",21:"northern_ireland",47:"wales/north_west_wales",49:"england/nottingham",50:"england/oxford",57:"england/south_yorkshire",51:"england/shropshire",52:"england/somerset",53:"wales/south_east_wales",55:"scotland/south_scotland",56:"wales/south_west_wales",58:"england/stoke_and_staffordshire",59:"england/suffolk",66:"england/surrey",60:"england/sussex",61:"scotland/tayside_and_central",62:"england/tees",1:"england/beds_bucks_and_herts",63:"england/tyne_and_wear",65:"england/wiltshire",48:"england/york_and_north_yorkshire"},newsRegionsMap={56:"South West Wales",28:"Hereford &amp; Worcester",36:"Leeds and Bradford",60:"Sussex",61:"Tayside &amp; Central Scotland",62:"Tees",63:"Tyne and Wear",35:"Lancashire",66:"Surrey",34:"Kent",26:"Guernsey",27:"Hampshire",20:"Essex",21:"Northern Ireland",48:"York &amp; North Yorkshire",49:"Nottinghamshire",46:"North East Wales",47:"North West Wales",44:"Northampton",45:"North East Scotland Orkney &amp; Shetland",42:"Mid Wales",43:"Norfolk",40:"London",41:"Manchester",1:"Beds Herts &amp; Bucks",3:"Berkshire",4:"Birmingham and Black Country",7:"Bristol",8:"Cambridgeshire",13:"Cumbria",12:"Coventry &amp; Warwickshire",30:"Highlands &amp; Islands",58:"Stoke &amp; Staffordshire",11:"Cornwall",39:"Liverpool",38:"Lincolnshire",59:"Suffolk",22:"Glasgow &amp; West of Scotland",17:"Devon",16:"Derby",19:"Edinburgh Fife &amp; East of Scotland",18:"Dorset",31:"Humberside",23:"Gloucestershire",51:"Shropshire",50:"Oxford",53:"South East Wales",52:"Somerset",33:"Jersey",55:"South Scotland",37:"Leicestershire",32:"Isle of Man",57:"Sheffield &amp; South Yorkshire",65:"Wiltshire"},newsTldMap={56:"southwestwales",42:"midwales",50:"oxford",60:"sussex",61:"taysideandcentralscotland",62:"tees",63:"tyne",49:"nottingham",66:"surrey",52:"somerset",53:"southeastwales",26:"guernsey",27:"hampshire",20:"essex",21:"northernireland",22:"glasgowandwestscotland",23:"gloucestershire",46:"northeastwales",47:"northwestwales",44:"northampton",45:"northeastscotlandnorthernisles",28:"herefordandworcester",43:"norfolk",40:"london",41:"manchester",1:"threecounties",3:"berkshire",4:"birmingham",7:"bristol",8:"cambridgeshire",39:"liverpool",38:"lincolnshire",58:"stoke",11:"cornwall",51:"shropshire",13:"cumbria",12:"coventry",59:"suffolk",48:"york",17:"devon",16:"derby",19:"edinburghandeastscotland",18:"dorset",31:"humberside",30:"highlandsandislands",37:"leicester",36:"leeds",35:"lancashire",34:"kent",33:"jersey",55:"southscotland",32:"isleofman",57:"sheffield",65:"wiltshire"},nationsMap={e:"england",n:"northernireland",s:"scotland",w:"wales"};return Locator=function(e){var t,n,o,i,s;t=this,o=!1,e=e||{},this.host=e.host||"",this.getLocation(),this.action="",e.pubsub&&(bootstrap.pubsub=e.pubsub),this._persistLocation=e.persistLocation||!1,s=!!e.confirmLocationSelection,this.confirmLocationSelection=s,i=new Stats(bootstrap.pubsub),i.applyEvents(),bootstrap.pubsub.on("locator:open",function(i){if(!o){o=!0,n=new LocatorView(i,{enableReverseGeocode:!1!==e.enableReverseGeocode,enableAutoComplete:!1!==e.enableAutoComplete}),t.location&&!0===t._persistLocation?bootstrap.pubsub.emit("locator:renderChangePrompt"):bootstrap.pubsub.emit("locator:renderForm");var a=t.getNewsRegionChoices();a.length>1&&(bootstrap.pubsub.emit("locator:renderForm"),bootstrap.pubsub.emit("locator:newsLocalRegions",[{location:{id:t.location.id},regions:a}])),bootstrap.pubsub.on("locator:locationSelected",function(e){s?"geolocate"===t.action?n.renderGeolocationResult(e):0===n.results.children.length&&n.renderSearchResults({results:[e]}):n.resetForm()}),bootstrap.pubsub.on("locator:newsLocalRegions",function(){s&&n.setMoreResultsDisplay("none")})}}),bootstrap.pubsub.on("locator:close",function(e){o&&(o=!1,n.close(),n=null)}),bootstrap.pubsub.on("locator:geoLocation",function(e){t.geoLocate(e.coords.latitude,e.coords.longitude)}),bootstrap.pubsub.on("locator:submitSearch",function(e,n){t.search(e,n)}),bootstrap.pubsub.on("locator:submitLocation",function(e,n){t.checkLocation(e,n)}),bootstrap.pubsub.on("locator:submitAutoCompleteSearch",function(e){t.autoComplete(e)}),bootstrap.pubsub.on("locator:submitAutoCompleteLocation",function(e,n){t.checkLocation(e,null)})},Locator.prototype.open=function(e){bootstrap.pubsub.emit("locator:open",[e])},Locator.prototype.close=function(){bootstrap.pubsub.emit("locator:close")},Locator.prototype.handleLocation=function(e){this.locationSelection=e,!0===this._persistLocation?(this.persistLocation(e),bootstrap.pubsub.emit("locator:renderChangePrompt"),bootstrap.pubsub.emit("locator:locationChanged",[this.getLocation()])):bootstrap.pubsub.emit("locator:locationSelected",[e])},Locator.prototype.checkLocation=function(e,t){var n=this,o=this.host+"/locator/news/responsive/location.json?id="+e;this.confirmLocationSelection||bootstrap.pubsub.emit("locator:renderWait"),t&&(o+="&newsRegion="+t),doRequest(o,function(e){n.handleResponse(e)},"location")},Locator.prototype.handleResponse=function(e){"search_results"===e.type?bootstrap.pubsub.emit("locator:searchResults",[e]):"autocomplete_search_results"===e.type?bootstrap.pubsub.emit("locator:autoCompleteSearchResults",[e]):"news_regions"===e.type?bootstrap.pubsub.emit("locator:newsLocalRegions",[e]):"geolocation"===e.type?e.isWithinContext||bootstrap.pubsub.emit("locator:locationOutOfContext",[e]):"location"===e.type&&this.handleLocation(e)},Locator.prototype.setLocServCookie=function(e){var t,n;e=e||{},"location"===e.type&&e.cookie&&e.expires&&!1!==(n=this.getCookieDomain(window.location.hostname))&&(t="locserv="+e.cookie+"; expires="+new Date(1e3*e.expires).toUTCString()+"; path=/; domain="+n,this.setCookieString(t),this.hasParsedCoookie=!1)},Locator.prototype.getCookieDomain=function(e){var t;return"string"==typeof e&&(!(!(t=e.match(/bbc\.co(\.uk|m)$/))||2!==t.length)&&"."+t[0])},Locator.prototype.persistLocation=function(e,t){var n,o;if(!1!==this._persistLocation)return o=this,!e&&!t&&"object"==typeof this.locationSelection||"object"==typeof e&&e===this.locationSelection?void this.setLocServCookie(this.locationSelection):e&&t?(e=e.toString(),this.locationSelection&&this.locationSelection.id===e&&this.locationSelection.news.id===t?void this.setLocServCookie(this.locationSelection):(n=this.host+"/locator/news/responsive/location.json?id="+e,n+="&newsRegion="+t,void doRequest(n,function(e){o.setLocServCookie(e)},"location"))):void("object"==typeof e&&this.setLocServCookie(e))},Locator.prototype.search=function(e,t){var n=this.host+"/locator/news/responsive/search.json?search="+encodeURIComponent(e),o=this;this.action="search",t&&(n+="&offset="+t),bootstrap.pubsub.emit("locator:renderWait"),doRequest(n,function(e){o.handleResponse(e)},"search")},Locator.prototype.autoComplete=function(e){var t=this;doRequest(this.host+"/locator/news/responsive/autocomplete.json?search="+e,function(e){t.handleResponse(e)},"autocomplete")},Locator.prototype.geoLocate=function(e,t){var n=this.host+"/locator/news/responsive/geolocate.json?latitude="+normaliseCoordinate(e)+"&longitude="+normaliseCoordinate(t),o=this;this.action="geolocate",bootstrap.pubsub.emit("locator:renderWait"),doRequest(n,function(e){o.handleResponse(e)},"geolocate")},Locator.prototype.getCookieString=function(){return document.cookie},Locator.prototype.setCookieString=function(e){document.cookie=e},Locator.prototype.getNewsRegionChoices=function(){var e,t,n,o;if(n=[],t=this.getCookieString().match(/locserv=[\w\W]*?(r=([\d+\.?]+))[;|\s|$]?/))for(e=t[2].split("."),o=0;o<e.length;o++)n.push({id:newsTldMap[e[o]],name:newsRegionsMap[e[o]]});return n},Locator.prototype.getLocation=function(){var e,t,n,o,i;if(this.hasParsedCoookie)return this.location;if(o=function(e){var t,n,o,i,s={};for(n=e.substr(0,1),e=e.substr(3),o=e.split(":"),t=0;t<o.length;t++)i=o[t].split("="),i[1]=i[1].replace(/\+/g,"%20"),s[i[0]]=decodeURIComponent(i[1]);return{name:n,data:s}},!(e=this.getCookieString().match("locserv=(.*?)(;|$)"))||e.length<2)return null;for(this.location={id:null,name:null,nation:null,news:null,weather:null},t=e[1].substr(2).split("@"),i=0;i<t.length;i++)n=o(t[i]),"l"===n.name?(this.location.id=n.data.i,this.location.name=n.data.n,n.data.h&&(this.location.nation=nationsMap[n.data.h])):"w"===n.name?this.location.weather={id:n.data.i,name:n.data.p}:"n"===n.name&&(this.location.news={id:n.data.r,path:newsMap[n.data.r]});return this.hasParsedCoookie=!0,this.location},Locator.prototype.setPersistance=function(e){var t=this._persistLocation;return this._persistLocation=e,t},Locator}),define("module/locatorInstance",["config","module/bootstrap","vendor/locator/main"],function(e,t,n){return new n({pubsub:t.pubsub,enableReverseGeocode:!(!e.local||!e.local.allowLocationLookup)&&e.local.allowLocationLookup,enableAutoComplete:!(!e.local||!e.local.allowAutoComplete)&&e.local.allowAutoComplete,host:e.locatorHost,confirmLocationSelection:!0,persistLocation:!0})}),define("module/locatorFacade",["config","module/locatorInstance"],function(e,t){return{getNewsRegionChoices:function(){return t.getNewsRegionChoices()},getLocation:function(){return t.getLocation()},getLocationIndexUrl:function(){return e.pathPrefix+"/"+t.getLocation().news.path},open:function(e){t.open(e)},handleLocation:function(e){t.handleLocation(e)},insert:function(e,n){t.close(),t.setPersistance(n),t.open(e)},setPersistance:function(e){return t.setPersistance(e)},persistLocation:function(e){return t.persistLocation(e)}}}),define("module/local/local",["module/bootstrap"],function(e){var t=function(t){this.options=t||{},this.options.simple=this.options.simple||!1,this.options.story_limit=this.options.story_limit||2,this.options.append_ext=this.options.append_ext||void 0,e.pubsub.on("locator:locationChanged",e.$.proxy(this.updateLocalNews,this))};return t.prototype.updateLocalNews=function(t){t&&t.news&&t.news.id&&t.news.path?(e.pubsub.emit("local:requestStarted"),e.$.ajax({url:e.config.pathPrefix+"/local/"+t.news.path+(void 0!==this.options.append_ext?this.options.append_ext:"")+"?limit="+this.options.story_limit+"&simple="+this.options.simple,dataType:"html",type:"get",success:function(n){e.pubsub.emit("local:newsReceived",[n,t.news.path])},error:function(t){e.pubsub.emit("local:requestError","requestError")}})):e.pubsub.emit("local:locationInvalid","locationInvalid")},t}),define("module/local/localView",["module/bootstrap","module/timestamp","module/imageenhancer","module/components/hardNewsUnit","config","translator"],function(e,t,n,o,i,s){var a=function(t,n){this.container=e.$(t,n),this.container.length&&(this.moduleTitle=e.$(".local-weather__title",n),this.hideLocal(),e.pubsub.on("local:requestStarted",e.$.proxy(this.handleLoading,this)),e.pubsub.on("local:newsReceived",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("local:requestError",e.$.proxy(this.handleError,this)))};return a.prototype={handleLoading:function(){e.pubsub.emit("local:handleLoaded",this.container),this.setContent(null,"loading")},handleSuccess:function(t,n){this.showLocal(),this.setContent(t),e.pubsub.emit("local:newsRendered",this.container),n&&this.setTitle(n)},handleError:function(){this.setContent(s.get("localNewsCouldNotBeLoaded"),"error")},setTitle:function(t){var n,o=e.$("#local-stories",this.container);o&&o.attr("data-title")&&(n='<a href="{{link}}" class="local-weather__link right-arrow">{{title}}</a>'.replace("{{link}}","/news/"+t).replace("{{title}}",o.attr("data-title")),this.moduleTitle.html(n))},setContent:function(e,i){i&&(e='<div class="'+i+'">'+(e||"")+"</div>"),this.container.html(e);new n,new t(new Date((new Date).toUTCString()).getTime());o.init("#local-stories")},hideLocal:function(){this.container.addClass("hidden")},showLocal:function(){this.container.removeClass("hidden")}},a}),define("module/weather/weather",["module/bootstrap"],function(e){var t=function(t){this.options=t||{},this.options.type=this.options.type||"hourly",this.options.append_ext=this.options.append_ext||void 0,e.pubsub.on("weather:locationChanged",e.$.proxy(this.updateWeather,this))};return t.prototype.updateWeather=function(t){t&&t.id&&(this.url=e.config.pathPrefix+"/weather/"+t.id.toString().toLowerCase()+"/"+this.options.type,e.pubsub.emit("weather:requestStarted"),e.$.ajax({url:this.url+(void 0!==this.options.append_ext?this.options.append_ext:""),type:"get",dataType:"html",success:function(n){e.pubsub.emit("weather:success",[n,t])},error:function(t){e.pubsub.emit("weather:requestError",[t])}}))},t}),define("module/weather/weatherView",["module/bootstrap"],function(e){var t=function(t){this.container=e.$(t),this.container.length&&(this.weatherLinkHref=this.container.attr("href"),this.hideWeather(),e.pubsub.on("weather:success",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("weather:requestError",e.$.proxy(this.handleError,this)))};return t.prototype={setContent:function(e){this.container.html(e)},setLink:function(e){return e=e||"",this.weatherLinkHref+"/"+e.toString().toLowerCase()},setLocationName:function(t){if(void 0!==t){var n=e.$(".weather-location");n.length&&n.html('<h3 class="weather-location__current"><a href="'+this.setLink(this.location.id)+'" class="weather-location__current-link right-arrow">'+t+" weather</a></h3>")}},
handleSuccess:function(e,t){this.setContent(e),this.location=t,this.container.attr("href",this.setLink(this.location.id)),this.showWeather(),this.setLocationName(this.location.name),this.highlightDropdownButton()},handleError:function(){this.hideWeather()},showWeather:function(){this.container.removeClass("hidden")},hideWeather:function(){this.container.addClass("hidden")},highlightDropdownButton:function(){e.$(".weather-location__show-locations").on("mouseenter",function(){e.$(".weather-location__current").addClass("hover")}).on("mouseleave",function(){e.$(".weather-location__current").removeClass("hover")}).on("keyup",function(t){9===(t.keyCode||t.which)&&e.$(".weather-location__current").addClass("hover")}).on("blur",function(){e.$(".weather-location__current").removeClass("hover")})}},t}),define("module/weather/weatherLocation",["module/bootstrap"],function(e){var t=function(){this.retrieveWeatherItems()};return t.prototype={retrieveWeatherItems:function(){e.pubsub.emit("weatherLocation:requestStarted");var t=window.location.pathname,n=e.config.pathPrefix+"/weather/regions"+t.toLowerCase();e.$.ajax({url:n,type:"get",dataType:"html",success:function(t){e.pubsub.emit("weatherLocation:success",[t])},error:function(t){e.pubsub.emit("weatherLocation:requestError",[t])}})}},t}),define("module/weather/weatherLocationView",["module/bootstrap","deviceInspector"],function(e,t){var n=function(t){this.container=e.$(t),this.weatherModule=e.$(".weather-forecast"),this.container.length&&(this.hideWeatherLocation(),e.pubsub.on("weatherLocation:success",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("weatherLocation:requestError",e.$.proxy(this.handleError,this)))};return n.prototype={insertWeatherLocationDropdown:function(t){this.container.append(t),e.$(".weather-location__list li:first-child",this.container).length&&this.assignEventListeners();var n=e.$(".weather-location__current",this.container).attr("data-weather");e.pubsub.emit("weather:locationChanged",[{id:n}])},assignEventListeners:function(){this.locations=e.$(this.container),this.list=e.$(".weather-location__list",this.container),this.listItems=e.$("li",this.container),this.button=e.$(".weather-location__show-locations",this.container);var n=this;n.button[0].addEventListener("click",function(){n.list.hasClass("hidden")?n.button.text("Hide locations"):n.button.text("Show locations"),n.button.toggleClass("weather-location__show-locations--open"),n.list.toggleClass("hidden")},!0);var o=function(o){var i=o||window.event;if("keypress"!==o.type||"keypress"===o.type&&13===i.keyCode){var s=i.target||i.srcElement,a=e.$(s),r={},c=document.getElementById("comp-weather");n.clicked=a.text(),n.listItems.removeClass("hidden"),a.addClass("hidden"),e.$(".weather-location__current",this.locations).text(n.clicked),n.button.removeClass("weather-location__show-locations--open"),n.list.addClass("hidden"),r.id=o.target.getAttribute("data-weather"),e.pubsub.emit("weather:locationChanged",[r]),n.elementInView(n.button)||"desktop"===t.getType()||c.scrollIntoView()}};e.$("li",n.list).each(function(){this.addEventListener("click",function(e){o(e)},!0)}),n.list[0].addEventListener("keypress",function(e){o(e)},!0)},elementInView:function(t){return t.offset().top>e.$(window).scrollTop()},handleSuccess:function(e){this.insertWeatherLocationDropdown(e),this.showWeatherLocation()},handleError:function(){this.hideWeatherLocation()},showWeatherLocation:function(){this.container.removeClass("hidden")},hideWeatherLocation:function(){this.container.addClass("hidden")}},n});try{define("module/localnewsandweather",["module/bootstrap","module/locatorFacade","module/local/local","module/local/localView","module/weather/weather","module/weather/weatherView","config","translator","module/weather/weatherLocation","module/weather/weatherLocationView"],function(e,t,n,o,i,s,a,r,c,l){var u={LOCATOR:".locator",WEATHER:".weather-forecast",LOCAL:".locator-stories-placeholder"};return{init:function(t){if(this.moduleElement=e.$(t),this.moduleElement.length){this.moduleTitle=e.$(".local-weather__title",this.moduleElement),this.locatorElement=e.$(".locator",this.moduleElement),this.localNewsElement=e.$(".locator-stories-placeholder",this.moduleElement),this.titleLink=e.$("a",this.moduleTitle);var r=e.$(".weather-dropdown",this.moduleElement);r.length&&(this.weatherLocation=new c,this.weatherLocationView=new l(r),e.pubsub.on("weather:locationChanged",e.$.proxy(this.setTitleLink,this))),this.local=new n({simple:!(!a.local||!a.local.simple)&&a.local.simple,story_limit:a.local&&a.local.story_limit?a.local.story_limit:2,append_ext:a.local&&a.local.append_ext?a.local.append_ext:void 0}),this.type="average",a.local&&a.local.weather_type&&(this.type=a.local.weather_type),this.weather=new i({type:this.type,append_ext:a.local&&a.local.append_ext?a.local.append_ext:void 0}),this.localView=new o(u.LOCAL,this.moduleElement),this.weatherView=new s(u.WEATHER),this.locatorElement.length&&this.renderLocator(),this.localNewsElement.length&&this.renderLocal(),this.renderWeather(),this.show()}},setTitle:function(e,t){t&&(e='<a href="{{link}}">{{title}}</a>'.replace("{{link}}",t).replace("{{title}}",e)),this.moduleTitle.html(e)},setTitleLink:function(e){this.weatherBaseUrl||(this.weatherBaseUrl=this.titleLink[0].href),e.id&&"string"==typeof e.id&&this.titleLink.attr("href",this.weatherBaseUrl+"/"+e.id.toString().toLowerCase())},renderLocator:function(){t.open(u.LOCATOR),this.location=t.getLocation(),this.location||(this.setTitle(r.get("localNewsAndWeather")),e.pubsub.emit("locator:renderForm"))},renderLocal:function(){this.local.updateLocalNews(this.location)},renderWeather:function(){this.weather.updateWeather(this.location)},show:function(){this.moduleElement.removeClass("hidden")},hide:function(){this.moduleElement.addClass("hidden")}}})}catch(e){}define("module/components/weatherAdaptor",["module/localnewsandweather"],function(e){e.init("#comp-weather")}),define("module/comscoreAdapter",["config","module/stats/comscore"],function(e,t){new t(e).sendPageViewBeacon()}),define("vendor/bbc-video-experience/bbcdotcom/adverts",[],function(){var e,t,n=function(){return void 0!==window.bbcdotcom&&!0===window.bbcdotcom.config.isAdsEnabled()};return{init:function(t){e=void 0!==t.assetType?t.assetType:""},initBump:function(e){t=e},isAdsModuleEnabled:n,updateAdTag:function(o){if(t&&n()){var i;try{i=window.bbcdotcom.av.emp.adverts.getPrerollAdTagWithAdRule()}catch(e){return}if(o&&o.shortHeadline&&o.uri&&o.assetId){for(var s=encodeURIComponent(o.shortHeadline.toLowerCase().split(" ").join("")),a=o.assetId,r=encodeURIComponent(encodeURIComponent(window.location.origin+o.uri)),c=14,l="";c--;)l+=Math.floor(10*Math.random());i=i.replace(/(correlator=)(\d+)/g,"correlator="+l),i=i.replace(/(url=)[^&]*/g,"url="+r),""!==e&&(i=i.replace(/(asset_type%3D(media_asset|index))/g,"asset_type%3D"+e)),i=i.replace(/(headline%3D)\w+/g,"headline%3D"+s),i=i.replace(/(story_id%3D)\w+/g,"story_id%3D"+a),t.dispatchEvent("bbc.smp.plugins.ads.event.updateAdTag",{adTag:i})}}},initCompanionAds:function(){if(n()){var e=document.getElementById("bbccom_mpu"),t='<div class="bbccom_companion_inner"><a href="'+bbcdotcom.locale.get("advertInfoPageUrl")+'" class="bbccom_text">'+bbcdotcom.locale.get("advertisementText")+'</a><div class="bbccom_advert_inner" id="bbccom_mpu_inner"></div></div>';e.innerHTML=t;var o=bbcdotcom.adverts.adUnit.get();googletag.cmd.push(function(){googletag.defineSlot(o,[300,60],"bbccom_mpu_inner").addService(googletag.companionAds()).addService(googletag.pubads()),googletag.enableServices()})}}}}),define("vendor/bbc-video-experience/analytics/adapter",[],function(){var e={},t={},n=function(e){t[e.getName()]=e},o=function(n){var o=n.getProviderName();if(t[o]){var i=n.getEvents(),s=n.getBuilders();for(var a in i){void 0===e[a]&&(e[a]=[]);var r={providerName:o,eventName:i[a],builder:s[a]};void 0!==r.builder&&e[a].push(r)}}},i=function(){for(var n=arguments[0],o=[],i=1;i<arguments.length;i++)o.push(arguments[i]);var s=e[n];if(void 0!==s)for(var a in s){var r=s[a],c=r.eventName,l=r.builder,u=t[r.providerName];try{u.track(c,l.apply(l,o))}catch(e){}}};return{registerProvider:n,registerSource:o,track:i}}),define("vendor/bbc-video-experience/analytics/provider/bbcdotcom",[],function(){var e=function(){return"bbcdotcom"},t=function(){try{return void 0!==window.bbcdotcom&&!0===window.bbcdotcom.config.isAnalyticsEnabled()}catch(e){return!1}},n=function(e,t){try{window.bbcdotcom.av.emp.analytics.trackEvent(e,t)}catch(e){}};try{t()&&window.bbcdotcom.setConfig({isContinuousPlayPage:!0})}catch(e){}return{getName:e,isEnabled:t,track:n}}),define("vendor/bbc-video-experience/analytics/provider/comscore",[],function(){var e;return{getName:function(){return"comscore"},track:function(t,n){e.emit(t,[n])},setNewsPubsub:function(t){e=t}}}),define("vendor/bbc-video-experience/continuousPlay/playIntent",[],function(){var e=null,t=null,n=function(n,o){t=e,e={index:n,event:null},o&&(e.event=o)},o=function(){return e.index},i=function(){return null===t?null:t.index};return{create:n,getIndex:o,getEvent:function(){return e.event},getPreviousIndex:i,isActive:function(){return null!==e},isFirst:function(){return null===t}}}),define("vendor/bbc-video-experience/continuousPlay/analytics/bbcdotcom",["vendor/bbc-video-experience/continuousPlay/playIntent"],function(e){var t={playlistLoaded:"continuousPlay.mediaStarted",dismissContPlay:"continuousPlay.dismissed",openMoreVideos:"continuousPlay.openedMoreVideos",goneFullScreen:"videoExperience:player:enteredFullScreen"},n={playlistLoaded:function(t){var n={index:e.getIndex(),title:t.title},o=e.getEvent();return o?(n.origin=void 0!==o.origin?"cp-"+o.origin:null,n.cpTimeout=void 0!==o.secondsIntoCountdown?o.secondsIntoCountdown:null,n.fullscreen=void 0!==o.fullscreen?o.fullscreen:null):n.origin=e.isFirst()?"page-load":"manual",n},dismissContPlay:function(e){return{cpTimeout:e.secondsIntoCountdown}},openMoreVideos:function(){return{}},goneFullScreen:function(){return{}}};return{getProviderName:function(){return"bbcdotcom"},getEvents:function(){return t},getBuilders:function(){return n}}}),define("vendor/bbc-video-experience/continuousPlay/analytics/comscore",["vendor/bbc-video-experience/continuousPlay/playIntent"],function(e){var t={playlistLoaded:"betamax:video:playlist_loaded"},n={playlistLoaded:function(t,n){var o={item_position:e.getIndex(),vpid:t.firstProgrammeItem?t.firstProgrammeItem.identifier:null,section:n.section},i=e.getEvent();if(i){switch(i.origin){case"cta":o.play_type="next";break;case"auto":o.play_type="continuous";break;case"carousel":o.play_type="carousel";break;default:o.play_type=null}o.action_location=i.fullscreen?"player-fullscreen":"page"}else o.play_type=e.isFirst()?"auto":"list",o.action_location="page";return o}};return{getProviderName:function(){return"comscore"},getEvents:function(){return t},getBuilders:function(){return n}}}),define("vendor/bbc-video-experience/continuousPlay/config",[],function(){var e,t,n,o=function(o){e=o||{};var i=e.staticPrefix||null;if(!i)throw"options.staticPrefix not defined";var s=e.pluginPath||"/js/vendor/bbc/smp/continuousPlay/";t=i+s+"js/",n=i+s+"swf/"},i=function(n){return{name:"smp.plugin.continuousplay.playlistSetChanged",data:{items:n,countdownDurationSecs:e.countdownDuration||10,path:t,adPluginExists:e.adsEnabled||!1,autoPlayFirstItem:void 0===e.autoPlayFirstItem||e.autoPlayFirstItem,copy:e.copy}}};return{init:o,getPluginLocations:function(){return{html:t+"continuousPlayPlugin.js",swf:n+"ContinuousPlayPluginFlash.swf"}},getConfig:i}}),define("vendor/bbc-video-experience/continuousPlay/dataSource",["vendor/bbc-video-experience/continuousPlay/playIntent"],function(e){var t,n,o,i,s,a=function(e){o=e,i=!1,s=[]},r=function(e){o.findItems(function(s,a){if(s)return e(s);t=[],n=[];var r;for(r in a){var c=o.parseItem(r,a),l=parseInt(r,10);c.index=l,t[l]=c,n[l]=o.parseAdvertMeta(r,a)}i||(i=!0,p()),e(null,t)})},c=function(e){h(function(){e(t)})},l=function(n){h(function(){var o=e.getIndex();u(o)&&n(t[o])})},u=function(e){return t&&t[e]?t[e]:void 0},d=function(t){h(function(){var o=e.getIndex();t(n[o])})},h=function(e){i?e():s.push(e)},p=function(){for(var e in s){(0,s[e])()}s=[]};return{init:a,refresh:r,getCurrentItem:l,getCurrentAdvertMeta:d,getItemAtIndex:u,getData:c}}),define("vendor/bbc-video-experience/continuousPlay/history",["vendor/bbc-video-experience/continuousPlay/dataSource"],function(e){var t,n,o,i,s,a,r=function(e){var r=e||{};t=window.history,n=r.isEnabled||!1,o=r.maintainHistory||!1,i=r.playHandler||function(){},a=!0,s=t&&void 0!==t.pushState,n&&s&&(window.onpopstate=l)},c=function(){n&&s&&e.getCurrentItem(function(e){if(e){var n=e.title+" - BBC News",i=e.uri+location.search,s=t.state;if(!s||s.uri!==i){var r={videoIndex:e.index,uri:i,title:n};o&&!a?t.pushState(r,"",i):t.replaceState(r,"",i),u(n),a=!1}}})},l=function(e){var t=e.state;t&&t.videoIndex&&(i(t.videoIndex),u(t.title))},u=function(e){document.title=e};return{init:r,update:c}}),define("vendor/bbc-video-experience/continuousPlay/main",["vendor/bbc-video-experience/continuousPlay/config","vendor/bbc-video-experience/continuousPlay/dataSource","vendor/bbc-video-experience/continuousPlay/playIntent","vendor/bbc-video-experience/bbcdotcom/adverts","vendor/bbc-video-experience/continuousPlay/history","vendor/bbc-video-experience/continuousPlay/analytics/bbcdotcom","vendor/bbc-video-experience/continuousPlay/analytics/comscore","vendor/bbc-video-experience/analytics/adapter"],function(e,t,n,o,i,s,a,r){var c,l,u,d,h,p,m,f,g,v,b=null,y=!1,w=!1,_=!1,k=function(c,l){var u=l||{};t.init(c),r.registerSource(s),r.registerSource(a),e.init({staticPrefix:u.staticPrefix,adsEnabled:o.isAdsModuleEnabled(),countdownDuration:u.countdownDuration,pluginPath:u.pluginPath,autoPlayFirstItem:u.autoPlayFirstItem,copy:u.copy});var d=u.updateBrowserUrl||{};i.init({isEnabled:d.enabled||!1,maintainHistory:d.maintainHistory||!1,playHandler:S}),o.init({assetType:u.advertAssetType}),!0===u.showCompanionAds&&o.initCompanionAds(),P(u.handlers||{}),n.create(u.startIndex||0)},C=function(e){c=e,o.initBump(c),c.bind("pluginLoaded",E),c.bind("pluginLoadFailed",I),c.bind("playlistLoaded",A),c.bind("continuousPlay.play",L),c.bind("continuousPlay.stats",N),c.bind("uiinfo",B),null!==b&&(S(b),b=null)},x=function(){t.refresh(function(t,o){if(t)return void p(t);c.setData(e.getConfig(o));var i=n.isFirst()?n.getIndex():n.getPreviousIndex();h(c.ended()?null:i)})},S=function(e){if(!c)return void(b=e);n.create(e),t.getCurrentItem(function(e){c.loadPlaylist(e.playlist,{counterName:e.counterName||null})})},T=function(){var e,o,i;return n.isActive()&&(e=n.getIndex(),(n.isFirst()||t.getItemAtIndex(e+1))&&(o=e+1),t.getItemAtIndex(e-1)&&(i=e-1)),{index:e,nextIndex:o,prevIndex:i}},P=function(e){u=e.videoPlayed||function(){},d=e.videoReplayed||function(){},h=e.dataChanged||function(){},p=e.dataFailed||function(){},m=e.dismissed||function(){},l=e.enabled||function(){},f=e.turnOn||function(){},g=e.turnOff||function(){},v=e.failedToload||function(){}},E=function(t){var o=e.getPluginLocations();void 0!==t.eventData?w=t.eventData===o.swf:void 0!==t.url&&(w=t.url===o.html),w&&(i.update(),l(n.getIndex()))},I=function(e){v()},A=function(s){t.getCurrentAdvertMeta(function(e){o.updateAdTag(e)});for(var a=0;a<s.playlist.items.length;a++){var l=s.playlist.items[a];if("bbc_news24"===l.vpid||"bbc_news24"===l.identifier)return void v()}if(t.getCurrentItem(function(e){r.track("playlistLoaded",s.playlist,e)}),!y)return t.refresh(function(t,n){if(t)return p(t);c.updateUiConfig({controls:{availableOnMediaEnded:!0}}),c.loadPlugin(e.getPluginLocations(),e.getConfig(n))}),void(y=!0);w&&(i.update(),u(n.getIndex()))},L=function(e){switch(e.origin){case"replay":d();break;case"auto":case"cta":case"carousel":n.create(e.index,e)}},N=function(e){var t=e.id;switch(t){case"dismissContPlay":r.track(t,e),m();break;case"openMoreVideos":r.track(t);break;case"turnCPon":f(n.getIndex());break;case"turnCPoff":g()}},B=function(e){_||e.isFullscreen&&(_=!0,r.track("goneFullScreen"))};return{init:k,initBump:C,refreshData:x,playItem:S,getPlayingInfo:T}}),define("vendor/bbc-video-experience/continuousPlay/module",["vendor/bbc-video-experience/continuousPlay/main","vendor/bbc-video-experience/analytics/adapter","vendor/bbc-video-experience/analytics/provider/bbcdotcom"],function(e,t,n){return n.isEnabled()&&t.registerProvider(n),e}),define("module/continuousPlay",["module/bootstrap","module/featureDetector","module/components/mediaPlayer/main","vendor/bbc-video-experience/continuousPlay/module"],function(e,t,n,o){"use strict";var i,s=e.pubsub,a=function(e){return"function"!=typeof orb.fig?e:void 0===orb.fig("mb")?e:orb.fig("mb")};return{init:function(r,c){i=c||{},a(!0)||i.enabled&&(o.init(r,{staticPrefix:e.config.staticPrefix,adsEnabled:t.is("DisplayingGnlAds"),pluginPath:"/js/vendor/bbc-video-experience/continuousPlay/smp/",countdownDuration:5,updateBrowserUrl:{enabled:!0,updateHistory:!1},advertAssetType:i.advertAssetType,autoPlayFirstItem:i.autoPlayFirstItem,handlers:{enabled:function(e){s.emit("continuousPlay:videoPlayed",[e])},videoPlayed:function(e){s.emit("continuousPlay:videoPlayed",[e])},dismissed:function(){s.emit("continuousPlay:dismissed")}}}),n.subscribeToPlayerEvent("initialised",function(e,t){o.initBump(t)},!0))}}}),define("module/dotcom/handlerAdapter",["module/dotcom/handler"],function(e){e.init()}),define("module/endSlate/main",["module/bootstrappedJquery","module/components/mediaPlayer/main"],function(e,t){"use strict";var n,o,i,s,a,r,c,l,u=function(e,t){c=!0,l=!1,n={};var u=e.endSlate||{};return!u.disabled&&(i={swf:"name:endSlate.swf",html:"name:endSlate.js"},r=void 0===u.offsetSecs?.5:u.offsetSecs,a=void 0!==u.cpPluginExists&&u.cpPluginExists,s=void 0===u.showOnPause||u.showOnPause,o=t,d(),!0)},d=function(){t.subscribeToPlayerEvent("initialised",function(e,t){h(t)})},h=function(e){l?e.loadPlugin(i,l):(n[e.settings().domid]=e,c&&e.bind("playing",p))},p=function(){c=!1,e.each(n,function(e,t){t.unbind("playing",p)}),setTimeout(m,1e3*r)},m=function(){o.fetch(function(e){f(e)})},f=function(t){t&&t.length&&(l={name:"smp.plugin.endSlate.data",data:{copy:{CAROUSEL_TITLE:o.getTitle()},items:t,showOnPause:s,cpPluginExists:a}},e.each(n,function(e,t){t.loadPlugin(i,l)}))};return{init:u}}),define("module/endSlate/provider",["module/bootstrappedJquery"],function(e){"use strict";var t,n,o,i=function(i){n=!1,o=!1;var s=i.endSlate||{};if(s.disabled)return!1;var a=s.ajaxPath||"/news/video_and_audio/endslate/",r=s.dataSelector||"#page",c=s.dataKey||"story-id",l=e(r);if(1===l.length){var u=l.data(c);u&&(n=a+u+".json",s.query&&(n+="?"+e.param(s.query)),t=s.title||"More to watch")}return!1!==n},s=function(){return t};return{init:i,fetch:function(t){n&&!o&&e.get(n).done(function(e){o=!0,t(e)})},getTitle:s}}),define("module/endSlateAdaptor",["config","module/endSlate/provider","module/endSlate/main"],function(e,t,n){t.init(e)&&n.init(e,t)}),define("module/gallery",["module/bootstrap"],function(e){return{init:function(){var t=e.$;this.imagesToResize=t(".responsive-image--16by9.forced");for(var n=0;n<this.imagesToResize.length;n++){var o=Number(this.imagesToResize[n].children[0].getAttribute("width")),i=Number(this.imagesToResize[n].children[0].getAttribute("height"));"portrait"===(i>o?"portrait":"landscape")&&(this.imagesToResize[n].parentElement.className+=" portrait-margins"),this.imagesToResize[n].style.paddingBottom=i/o*100+"%"}}}}),define("module/galleryAdapter",["module/gallery"],function(e){e.init()}),define("module/gazzetta",["module/bootstrap","module/tabbed/tabbed"],function(e,t){return{init:function(){var n=e.$,o=n("#tracker-tab li"),i=n(".tracker-container"),s=o[0]?new t(o,i):null;"started"===n("#tracker-tab").attr("data-knockout-status")&&s.tabs[1].activate(),n(".knockout__title").on("click",function(e){n(this).parent().toggleClass("knockout--closed")}),n(".live-scores__refresh").on("click",function(e){e.preventDefault();var t=n(this),o=t.closest(".live-scores").attr("id");return window.location.href=t.attr("href")+"#"+o,window.location.reload(),!1})}}}),define("module/gazzettaAdapter",["module/bootstrap","module/gazzetta"],function(e,t){e.$(".live-scores").length&&t.init()}),define("module/hotspot/handlerAdapter",["module/hotspot/handler"],function(e){e.init()}),define("module/hotspot/handlerPostLoad",["module/hotspot/handler"],function(e){return{reProcess:e.init}}),define("module/iconLoaderAdapter",["module/iconLoader"],function(e){e.init()}),define("module/index",["module/bootstrap","module/imageenhancer","module/timestamp","module/history/history","module/localnewsandweather","module/sport/sportView","module/gazzetta","config"],function(e,t,n,o,i,s,a,r){var c=e.$;return{init:function(){var e=(new n(new Date((new Date).toUTCString()).getTime()),c("#travel"),new s);new t,r.features.localnews&&r.locatorFlagPole&&require(["module/localnewsandweather"],function(e){e.init("#comp-weather")}),c("#comp-sport-stories").length>0&&e.init(c("#comp-sport-stories")),c(".live-scores").length&&a.init()}}}),define("module/indexTitleAdaptor",["module/indexTitle"],function(e){e.init()}),define("module/live-event-component",["config","module/bootstrap","module/poller","module/timestamp"],function(e,t,n,o){return{pollingUrl:function(e,t,n){return void 0===t&&(t={service:"nfp"}),e+"/"+t.service+"/walkietalkie/latest_index_asset/"+n},handleSuccess:function(){e.features.liveeventcomponent&&this.init(e.pollingHost,null)},init:function(i,s){var a=t.$,r=this;a("[data-channel]").each(function(){var t=a(".article-inner",this),c=a(".live-event-summary",t),l=a(".live-event-entries",t),u=a(this).attr("data-channel"),d=new n(30),h="",p=r.pollingUrl(i,e,u);d.startCacheBusting(),d.setUrl(p),d.startPolling({success:function(e){if(a.trim(l.html())||c.remove(),e.entryId!==h){var t=null;if(e.createTime){var n=e.createTime.split(/[\-T:]/g),i=new Date(n[0],n[1]-1,n[2]);i.setHours(n[3],n[4],n[5]);var r=((new Date).getTime()-i.getTime())/1e3,u=new o(null),d=u.timeAgoInWords(r);d&&(t='<em class="entry-timestamp">'+d+"</em>")}if(t){var m=e.html.indexOf(">")+1,f=e.html.substring(0,m),g=e.html.substring(m);e.html=f+t+g}return s?s(l,e.html):(l.css("opacity","0"),setTimeout(function(){l.html(e.html).css("opacity","1")},1200)),h=e.entryId,p}},error:function(){a.trim(l.html())||(l.css("display","none"),c.css("visibility","visible"),d.stopPolling())}})})}}}),define("module/local/localSwift",["module/bootstrap","module/components/swift/collection"],function(e,t){return{init:function(){e.pubsub.on("local:handleLoaded",t.cleanup),e.pubsub.on("local:newsRendered",t.init)}}}),define("module/local/localSwiftAdapter",["module/local/localSwift"],function(e){e.init()}),define("module/localisation/scriptToggleAdapter",["module/localisation/scriptToggle"],function(e){e.init()}),define("module/locator",["config","module/bootstrap","vendor/locator/main"],function(e,t,n){return new n({pubsub:t.pubsub,enableReverseGeocode:!(!e.local||!e.local.allowLocationLookup)&&e.local.allowLocationLookup,enableAutoComplete:!(!e.local||!e.local.allowAutoComplete)&&e.local.allowAutoComplete,host:e.locatorHost,confirmLocationSelection:!0,persistLocation:!0})}),define("module/mediaAssetPage/api",["module/bootstrap","module/featureDetector"],function(e,t){var n=function(){var t=this;e.pubsub.on("map:asset:load",function(e){t.request(e,"asset")}),e.pubsub.on("map:feed:load",function(e){t.request(e,"feed")})};return n.prototype={request:function(t,n,o){var i=e.config.pathPrefix;e.pubsub.emit("map:request:start",[t,n]),e.$.ajax({url:i+"/api/av/"+n+"/"+t+".html",type:"get",dataType:"json",success:function(i){i.feed&&(i=i.feed),o&&o(i),e.pubsub.emit("map:"+n+":request:success",[t,i])},error:function(o){e.pubsub.emit("map:"+n+":request:error",[t,o])}})}},n}),define("module/page",["istats-1"],function(e){return{getCountername:function(){return e.getCountername()},setCountername:function(t){e.setCountername(t)}}}),define("module/mediaAssetPage/assetView",["module/bootstrap","module/timestamp","translator","config","deviceInspector","module/page"],function(e,t,n,o,i,s){function a(){g=new t(new Date((new Date).toUTCString()).getTime()),e.pubsub.on("map:asset:request:success",d),e.pubsub.on("map:asset:request:error",p),e.pubsub.on("map:asset:load",function(){v("#media-asset-page-video figure").remove()}),u()}function r(e){v(".story-inner .more-wrapper").css("display","block"),v(".story-inner .more-text").text(n.get("moreInfo"));var t=v(".map-body",e),o=1;t.children().first().is("figure")&&o++,e.addClass("contains-more-text"),t.append('<div class="hide-wrapper extra-content"></div>');var i=v(".hide-wrapper",e);v(".map-body > *",e).each(function(){0!==o||v(this).hasClass("hide-wrapper")?--o:i.append(this)}),t.removeClass("display-feature-phone-only")}function c(){var t=v(".story-inner"),o=v("#media-asset-page-text",t),i=(v(".map-body",o),'<div class="more-wrapper" style="display: none;"><a class="more-text" href="#">'+n.get("moreInfo")+"</a></div>");o.after(i),v(".more-text",t).on("click",function(t){var i=t.target,s=v(".hide-wrapper",o);s.toggleClass("extra-content"),s.hasClass("extra-content")?(e.pubsub.emit("map:asset:summary",["close"]),i.innerHTML=n.get("moreInfo")):(e.pubsub.emit("map:asset:summary",["open"]),i.innerHTML=n.get("lessInfo")),t.preventDefault()})}function l(t){"desktop"===t||m()||(e.pubsub.off("device",l),c(),r(v(".story-inner #media-asset-page-text")))}function u(){var t=v(".story-inner"),n=v("#media-asset-page-text",t),o=v(".more-text",t),s=v(".map-body > *",n).length;s<=1||2===s&&v(".map-body .related-items",n).length>0||"desktop"===i.getType()||m()?(v(".map-body",n).removeClass("display-feature-phone-only"),o.css("display","none"),n.removeClass("contains-more-text"),e.pubsub.on("deviceGroup",l)):(0===v(".more-text",t).length&&c(),r(n))}function d(e,t){h(t.countername);v("#media-asset-page-text");v("#media-asset-page-text").html(t.body),g.insertTime(),u(),f(t.related),window.scrollTo(0,1)}function h(e){s.setCountername(e)}function p(e,t,n){}function m(){var e=!1;return o.features2.hasOwnProperty("channel_page")&&(e=o.asset.asset_uri===o.pathPrefix+"/"+o.features2.channel_page.candy_id),e}function f(e){e.match("media-feed-error")?(v(".media-feed.primary-feed.related-video-audio").addClass("hidden"),v("#media-asset-list-view__tab-1").addClass("hidden off-screen")):(v(".media-feed.primary-feed.related-video-audio").removeClass("hidden"),v("#media-asset-list-view__tab-1").removeClass("hidden off-screen"))}var g,v=e.$;return{init:a}}),define("module/mediaUtils/timeInterval",[],function(){function e(e){if(!i[e]){var t=e.match(/PT((\d+)H)?((\d+)M)?((\d+)S)?/);if(null===t)throw"Could not parse time interval: "+e;var n=void 0!==t[2]?parseInt(t[2],10):0,o=void 0!==t[4]?parseInt(t[4],10):0,s=void 0!==t[6]?parseInt(t[6],10):0;i[e]={h:n,m:o,s:s}}return i[e]}function t(e){return e.toString().replace(/^(\d)$/,"0$1")}function n(n){var o=e(n);return o.m+":"+t(o.s)}function o(t){var n=e(t);return 3600*n.h+60*n.m+n.s}var i={};return{toTimestamp:n,toSeconds:o}}),define("module/mediaUtils/playlistObjectBuilder",["module/mediaUtils/timeInterval","module/featureDetector"],function(e,t){function n(e,t){var n=[];return o(t,e)&&n.push(r),n.push({vpid:e.externalId,live:e.live,kind:s(e)}),{embedRights:e.allowOffSiteEmbedding?"allowed":"blocked",guidance:e.guidance,holdingImageURL:e.image&&e.image.href?e.image.href:"",items:n,title:e.caption,simulcast:e.live}}function o(t,n){return i()&&"radioProgramme"!==s(n)&&t.editorAdFlag&&e.toSeconds(n.duration)>30}function i(){return t.is("DisplayingGnlAds")}function s(e){if(void 0!==e.kind)return e.kind;for(var t in e.id){var n=e.id[t],o=a[n];if(void 0!==o)return o}return""}var a={audios:"radioProgramme",videos:"programme"},r={kind:"advert",media:{kind:"video",type:"video/mp4"}};return{build:n}}),define("module/mediaAssetPage/continuousPlay/dataProvider",["module/bootstrap","module/mediaUtils/playlistObjectBuilder","module/mediaUtils/timeInterval"],function(e,t,n){"use strict";var o,i,s=e.$,a=function(e){i=(e||{}).endpoint},r=function(e){s.ajax({url:i,dataType:"jsonp",jsonpCallback:"cpItems",crossDomain:!0}).done(function(t){o=t;var n=s(".related-video-audio article").toArray();if(n.unshift(s(".media-asset").get(0)),o.length!==n.length)return void e("Number of related videos do not match");e(null,n)}).fail(function(t){e(t.statusText)})},c=function(e,i){var a=i[e],r=s(a),c=o[e],l=c.media,u={};return"0"===e?(u.title=r.find(".story-body__h1").text(),u.date=r.find(".date--v1 strong").text(),u.uri=r.find(".story-body__h1").data("asset-uri")):(u.title=r.find(".cta").text(),u.date=r.find(".date--v1").data("datetime"),u.uri=r.data("uri")),u.imgUrl=l.image?l.image.href:null,u.duration=l.duration?n.toTimestamp(l.duration):null,u.counterName=l.istatsCounterName?l.istatsCounterName:null,u.playlist=t.build(c.media,c.advert),u},l=function(e){var t;if(e&&e.split&&!(e.indexOf("/")<0))return t=e.split?e.split("/"):[],"/"+t.splice(1,1)+"/api/av/asset"+t.join("/")},u=function(e,t){var n=l(e);n&&s.ajax({url:n,dataType:"jsonp",jsonpCallback:"cpAsset",crossDomain:!0}).done(function(e){t(null,e)}).fail(function(e){t(e.statusText)})};return{init:a,findItems:r,parseItem:c,parseAdvertMeta:function(e){return o[e].advert},getMediaAsset:u,getMetaData:function(e){return o[e]}}}),define("module/mediaAssetPage/continuousPlay/view",["module/bootstrap"],function(e){"use strict";var t,n=e.$,o=function(){t=n(".related-video-audio article").toArray(),t.unshift(n(".media-asset").first())},i=function(e){var o=n(t[e]),i=n(t[e+1]),s=!0;u("next"),e<1&&(s=!1),s&&(u("selected"),e>0&&l(o,"selected","NOW PLAYING")),i.length>0&&l(i,"next","UP NEXT")},s=function(e){n("#media-asset-page-text").empty().append(e.removeClass("display-feature-phone-only")).show()},a=function(e){n(".share-wrapper").empty().append(e).show()},r=function(){n(".share-wrapper").hide()},c=function(e){var t=n("#media-asset-page-text h1");t.data("asset-uri","").text(e),n("#media-asset-page-text").empty().append(t)},l=function(e,t,o){e.addClass(t),n("."+t).find(".js-media-duration").text(o)},u=function(e){n(".media-feed-item."+e).each(function(t,o){var i=n(o);i.removeClass(e),n(".js-media-duration",i).text(i.attr("data-duration"))})};return{init:o,updateTags:i,updatePageContent:s,updateShareTools:a,removeNextTag:function(){u("next")},hideShareTools:r,hidePageContent:c,getMediaAssetUri:function(){return n(".media-asset").first().find(".story-body__h1").data("asset-uri")}}}),define("module/mediaAssetPage/continuousPlay/handler",["module/bootstrap","module/continuousPlay","module/mediaAssetPage/continuousPlay/dataProvider","module/mediaAssetPage/continuousPlay/view","module/page"],function(e,t,n,o,i){"use strict";var s,a=function(e){var t=n.getMetaData(e)||{},s=o.getMediaAssetUri();o.updateTags(e),t.media&&t.media.istatsCounterName?i.setCountername(t.media.istatsCounterName):(i.setCountername(null),i.setCountername(i.getCountername())),t.advert&&t.advert.uri!==s&&n.getMediaAsset(t.advert.uri,function(e,n){var i=void 0!==t.advert.shortHeadline?t.advert.shortHeadline:"";e?(o.hidePageContent(i),o.hideShareTools()):(n.body?o.updatePageContent($(n.body)):o.hidePageContent(i),n.shareTools?o.updateShareTools($(n.shareTools)):o.hideShareTools())})},r=function(){o.removeNextTag()},c=function(){e.pubsub.on("continuousPlay:videoPlayed",function(e){a(e)}),e.pubsub.on("continuousPlay:dismissed",function(){r()})};return{init:function(e){s=e||{},s.advertAssetType="media_cplay",c(),n.init(s.dataProvider),o.init(),t.init(n,s)}}}),define("module/mediaAssetPage/listView",["module/bootstrap","module/featureDetector","module/tabbed/tabbed","module/timestamp","translator","config"],function(e,t,n,o,i,s){function a(e,t,n){!1===n(t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}function r(t,n){document.title=n,e.pubsub.emit("map:asset:load",[t.replace(s.pathPrefix+"/","")])}function c(n){v(),T=n,
S=new o(new Date((new Date).toUTCString()).getTime()),e.pubsub.on("map:feed:request:success",b),e.pubsub.on("map:feed:request:error",y),e.pubsub.on("map:asset:request:success",_),e.pubsub.on("tabs:activate",m),t.can("UseHistoryApi")&&window.addEventListener("popstate",function(e){null!==e.state&&e.state.title&&e.state.path&&(-1===e.state.path.indexOf("/news/video_and_audio/")?r(e.state.path,e.state.title):window.history.go(0))});var i=P(".top_stories.showmore.open .media-feed-placeholder .media-feed-grid");0!==i.length&&i.append(u(C())),l(),f(),w()}function l(){var e=P(".media-feeds")[0];e&&(e.onclick=function(t){for(var n=t||window.event,o=n.target||n.srcElement;o!==e;){if(("ARTICLE"===o.nodeName||"DIV"===o.nodeName&&-1!==o.className.indexOf("HTML5article"))&&P(o).hasClass("media-feed-item")){a(n,o,d);break}if("H2"===o.nodeName&&0!==P("a",o).length){a(n,o,p);break}if(P(o).hasClass("more-text")){a(n,o,g);break}o=o.parentNode}})}function u(e){return'<div class="more-wrapper"><a class="more-text" href="#" data-cps-id="'+e+'">'+i.get("showMore")+"</a></div>"}function d(e){if(P(e).hasClass("selected"))return!1;null!==e.attributes["data-uri"]&&(window.location.href=e.attributes["data-uri"].value+window.location.search)}function h(e){return P('.media-feed[data-cps-id="'+e+'"]')}function p(t){var n=t.parentNode.attributes["data-cps-id"].value.replace(s.pathPrefix+"/",""),o=h(n),i=P(".media-feed-grid",o);o.toggleClass("open");var a=o.hasClass("open")?"open":"close",r=o.attr("data-event");if(e.pubsub.emit("map:index:toggle",[r,a]),0===i.length&&o.hasClass("open")){var c=P(".media-feed-error",o);0!==c.length&&c.remove(),o.addClass("loading-after"),e.pubsub.emit("map:feed:load",[n])}return!1}function m(t,n){var o=P(x.tabs[n].t).attr("data-cps-id");if(o){var i=h(o),s=P(".media-feed-grid",i);i.addClass("open"),0===s.length&&(i.addClass("loading-after"),e.pubsub.emit("map:feed:load",[o]))}}function f(){var e;P(".media-panel").each(function(t,n){P(n).hasClass("open")&&(e=t)}),x=new n(P("#media-tabs li"),P(".media-panel"),!0,"media-asset-list-view"),!1===s.features2.map_most_watched&&(e=0),e&&(x.tabs[e].activate(),m("default",e))}function g(t){var n=t,o=h(n.getAttribute("data-cps-id"));return o.toggleClass("showmore"),o.hasClass("showmore")?(e.pubsub.emit("map:index:topstories",["close"]),n.innerHTML=i.get("showMore")):(e.pubsub.emit("map:index:topstories",["open"]),n.innerHTML=i.get("showLess")),!1}function v(){var e=P(".media-feed.top_stories"),t=P("h2",e);P("a",e).replaceWith(function(){return this.innerHTML}),t.text(P.trim(t.text())),e.addClass("primary-feed")}function b(e,t){var n=h(e),o=P(".media-feed-placeholder",n);if(t&&o.html(t),S.insertTime(),n.hasClass("showmore")){P(".media-feed-grid",o).append(u(e))}n.removeClass("loading-after"),k()}function y(e,t){var n=h(e);n.removeClass("loading-after"),0===P(".media-feed-error",n).length&&n.append('<div class="media-feed-error">'+i.get("mediaUnavailable")+"</div>")}function w(){P(".media-feed.js-postload").each(function(t,n){var o=P(n).attr("data-cps-id");null!==o&&0===P(".media-feed-item",n).length&&(P(n).addClass("loading-after"),e.pubsub.emit("map:feed:load",[o]))})}function _(e,t){k(e);var n=P(".related-video-audio .media-feed-grid"),o=P(".related-video-audio .media-feed-error");if(1===n.length){n.replaceWith(t.related);var i=0;P("#media-asset-list-view__tab-1").hasClass("hidden off-screen")&&(i=1),x.tabs[i].activate()}1===o.length&&o.replaceWith(t.related)}function k(e){e&&(T=s.pathPrefix+"/"+e),P(".media-feed-item.selected").each(function(e,t){var n=P(t);n.removeClass("selected"),P(".js-media-duration",n).text(n.attr("data-duration"))}),P('.media-feed-item[data-uri="'+T+'"]').each(function(e,t){var n=P(t);n.addClass("selected"),P(".js-media-duration",n).text(i.get("nowPlaying"))})}function C(){return s.configuration.hasOwnProperty("videotopiccandyid")&&s.configuration.videotopiccandyid?s.configuration.videotopiccandyid:"video_and_audio/top_stories"}var x,S,T,P=e.$;return{init:c,modifyTopStoriesHeader:v}}),define("module/mediaAssetPage/map",["module/bootstrap"],function(e){return{init:function(){var t=this;e.pubsub.on("map:asset:request:success",function(e,n){t.updateShareTools(n.shareTools)})},updateShareTools:function(t){e.$(".share").replaceWith(t)}}}),define("module/mediaAssetPage/mediaAssetPage",["module/assortedUtils","module/bootstrap","module/transclude","module/mediaAssetPage/assetView","module/mediaAssetPage/listView","module/mediaAssetPage/api","module/mediaAssetPage/map","module/mediaAssetPage/continuousPlay/handler","module/components/mediaPlayer/autoPlay","module/components/mediaPlayer/view"],function(e,t,n,o,i,s,a,r,c,l){function u(){var e=document.getElementById("page");if(e)return e.getAttribute("data-map-id")}function d(){var e,t=l.getPlayableForPlaceholder(l.findFirstMediaPlaceholder());return e=t.otherSettings.continuousPlayCfg,e.autoPlayFirstItem=c.isEnabled(t),e}new s,e.jsonParse;!function(){o.init();var e=u(),s=d();if(r.init(s),i.init(e),a.init(),t.config.features2.map_most_watched){(new n).get(".media-tab.most-watched a",{target:".most-watched .media-feed-placeholder",success:function(){t.pubsub.emit("map:feed:request:success",["most-watched"])},error:function(){t.pubsub.emit("map:feed:request:error",["most-watched"])},insert:!0})}else t.pubsub.emit("map:feed:request:error",["most-watched"])}()}),define("module/nav/nav",["module/bootstrap"],function(e){var t=e.$,n=function(e,t){this.button=e,this.nav=t,this.state=!1,this.name=this.button&&this.button.attr?this.button.attr("data-event"):"",this.setupBindings(),this.setupListeners()};return n.prototype={getName:function(){return this.name},setupListeners:function(){e.pubsub.on("nav:all:close",t.proxy(this.close,this)),e.pubsub.on(this.getEventName("close"),t.proxy(this.close,this)),e.pubsub.on("nav:all:open",t.proxy(this.open,this)),e.pubsub.on(this.getEventName("open"),t.proxy(this.open,this)),e.pubsub.on("tabs:click",t.proxy(this.close,this))},setupBindings:function(){this.button.on("click",t.proxy(function(t){t.preventDefault(),this.state?e.pubsub.emit(this.getEventName("close"),"close"):e.pubsub.emit(this.getEventName("open"),"open")},this)),this.nav.on("click",t.proxy(function(t){e.pubsub.emit(this.getEventName("close"),"close")},this))},close:function(){this.state=!1,t(".site-brand").removeClass(this.getOpenClass()),t("#js-navigation-sections-wrapper").removeClass(this.getOpenClass()),t(".navigation--footer").removeClass(this.getOpenClass())},open:function(){e.pubsub.emit("nav:all:close","close"),this.state=!0,t(".navigation--footer").hasClass(this.getOpenClass())||"footer"!==this.getName()?(t("#js-navigation-sections-wrapper").addClass(this.getOpenClass()),t(".site-brand").addClass(this.getOpenClass())):t(".navigation--footer").addClass(this.getOpenClass())},getOpenClass:function(){return"navigation__"+this.getName()+"--open"},getEventName:function(e){return"nav:"+this.getName()+":"+e}},n}),define("module/nav/navManager",["module/bootstrap","module/nav/nav","translator","config"],function(e,t,n,o){var i=e.$;return{init:function(){var e=i("#js-navigation-cta-header"),t=i("<button>"+e.html()+"</button>");i.each(e.prop("attributes"),function(){"href"!==this.name&&t.attr(this.name,this.value)}),e.replaceWith(t),this.bottomNav=i("#js-navigation-sections").removeAttr("role").removeAttr("aria-label"),this.topButton=i("#js-navigation-cta-header"),this.topNavPlaceholder=i(".navigation--open .navigation__panel"),this.createFooterButton(n.get("section")),this.cloneNavToHead(),this.createNavs()},createFooterButton:function(e){var t=o.service.charAt(0).toUpperCase()+o.service.slice(1);this.bottomNav.before('<button class="navigation__cta-footer" data-event="footer" role="navigation" aria-label="'+t+'">'+e+"</button>"),this.bottomButton=i(".navigation__cta-footer")},cloneNavToHead:function(){var e=this.bottomNav[0].cloneNode(!0);e.id="js-navigation-sections-header",this.bottomNav.addClass("footer").attr("id","js-navigation-sections-footer"),this.topNavPlaceholder.append(e),this.topNav=i(e)},createNavs:function(){new t(this.topButton,this.topNav),new t(this.bottomButton,this.bottomNav)}}}),define("module/navigation/handlerAdaptor",["module/navigation/handler"],function(e){e.init()}),define("module/touchEvents",["module/bootstrap","module/featureDetector"],function(e,t){var n=e.$;return{touchStart:function(e){this.startX=e.originalEvent.targetTouches[0].clientX,this.fastFlick=!0,setTimeout(n.proxy(function(){this.fastFlick=!1},this),this.flickTime)},touchMove:function(t){this.endX=t.originalEvent.targetTouches[0].clientX,this.transformFunction(this.endX-this.startX),e.pubsub.emit("touch:move"),this.enableTouchMove=!0},isSwipeOrFlick:function(e){return Math.abs(e)>this.flickDistance&&this.fastFlick||Math.abs(e)>this.swipeDistance},handleTouchMove:function(){var e=this.endX-this.startX;this.slidingElementContainer.addClass("snap-position"),this.isSwipeOrFlick(e)?(this.swipe=!0,e>0?(this.transformFunction(this.snapInterval),this.swipeDirection="right"):(this.transformFunction(-this.snapInterval),this.swipeDirection="left")):this.transformFunction(0)},touchEnd:function(){this.enableTouchMove&&this.handleTouchMove(),this.enableTouchMove=!1},setSnapInterval:function(e){this.snapInterval=window.document.documentElement.clientWidth*(1+e)},swipeEnd:function(){e.pubsub.emit("touchmove:"+this.swipeDirection),this.transformFunction(0),this.swipe=!1},transitionEnd:function(){this.slidingElementContainer.removeClass("snap-position"),this.swipe&&this.swipeEnd(),e.pubsub.emit("touch:end")},handleResize:function(){this.setSwipeDistance(),this.setSnapInterval(this.spaceBetweenItemsRatio)},bindEvents:function(){this.container.on("touchstart",n.proxy(function(e){this.touchStart(e)},this)),this.container.on("touchmove",n.proxy(function(e){e.preventDefault(),this.touchMove(e)},this)),this.container.on("touchend",n.proxy(function(){this.touchEnd()},this)),n(window).on("resize",n.proxy(function(e){this.handleResize()},this)),this.slidingElementContainer.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",n.proxy(function(){this.transitionEnd()},this))},setSwipeDistance:function(){this.swipeDistance=window.document.documentElement.clientWidth*this.swipeDistanceRatio},transform3d:function(e){this.slidingElementContainer.css("transform","translate3d("+e+"px,0,0)")},transform:function(e){this.slidingElementContainer.css("transform","translateX("+e+"px)")},positionLeft:function(e){this.slidingElementContainer.css("left",e)},setTransformFunction:function(){return this.canTransform3d=!1,t.can("CssTransform3d")?(this.canTransform3d=!0,this.transform3d):t.can("CssTransform")?this.transform:(n("body").addClass("no-translate"),this.positionLeft)},config:function(e){this.container=n(e.touchEventContainer),this.slidingElementContainer=n(e.slidingElementContainer),this.swipeDistanceRatio=.5,this.flickDistance=30,this.flickTime=250,this.setSwipeDistance(),this.spaceBetweenItemsRatio=e.spaceBetweenItemsRatio,this.setSnapInterval(this.spaceBetweenItemsRatio)},handleTouchEventsSupport:function(e){this.config(e),this.transformFunction=this.setTransformFunction(),this.canTransform3d&&this.transform3d(0),this.enableTouchMove=!1,this.bindEvents(),n("html").addClass("swipe-on")},init:function(e){t.can("TouchEvents")&&this.handleTouchEventsSupport(e)}}}),define("module/pictureViewer",["module/bootstrap","module/featureDetector","vendor/lo-dash/lo-dash","module/touchEvents","module/urlShrinker"],function(e,t,n,o,i){var s,a,r=e.$,c={global:null,body:r(".direction"),request:function(t,n){r.ajax({url:e.config.pathPrefix+"/api/pictures/"+t,type:"get",dataType:"json",success:function(t){n&&n(),e.pubsub.emit("pictureViewer:loaded",[t])}}),this.pictureViewerRequested=!0},loadViewer:function(e){this.body.append(e.body),o.init({touchEventContainer:"#picture-viewer",slidingElementContainer:".picture-viewer__pictures",spaceBetweenItemsRatio:.2}),this.pictureViewer=r("#picture-viewer"),this.pictureContainer=r(".picture-viewer__pictures")},setHeightToFillScreen:function(){r(".image-container").height(this.browserHeight)},setImageHeight:function(e,t){e.element.css({height:t})},setImageMaxWidth:function(e,t){e.element.css({"max-width":t+"px"})},getWindowMeasurements:function(){var e=this.doc.documentElement;this.browserHeight=e.clientHeight,this.browserWidth=e.clientWidth,this.browserRatio=this.browserWidth/this.browserHeight},calculateDimensions:function(e){var t=e.height,n=e.width,o=e.ratio,i=1/o,s={};return e.element.attr("style",""),n>this.browserWidth&&t>this.browserHeight?o>this.browserRatio?(s.maxWidth=this.browserWidth,s.height=i*this.browserWidth):(s.height=this.browserHeight,s.maxWidth=o*this.browserHeight):n>this.browserWidth?s.height=i*this.browserWidth:t>this.browserHeight?(s.maxWidth=o*this.browserHeight,s.height=this.browserHeight):(s.maxWidth=n,s.height=t),s},handleImageCalculations:function(){s(),this.setImageDimensions(this.image,this.calculateDimensions(this.image)),a()},setImageDimensions:function(e,t){t.maxWidth&&this.setImageMaxWidth(e,t.maxWidth),t.height&&this.setImageHeight(e,t.height)},replaceDivWithImage:function(e,t){var n=e.element;n.hasClass("image--placeholder")&&(n.replaceWith('<img src="'+n.attr("data-hq-src")+'" id="'+n.attr("id")+'" width="'+n.attr("data-width")+'" height="'+n.attr("data-height")+'" class="image">'),e.element=r(".image").eq(t))},calculateImageData:function(){this.images=r(".image").map(function(){var e=r(this),t=e.attr("data-width"),n=e.attr("data-height");return{element:e,width:t,height:n,ratio:t/n}}),this.numberOfImages=this.images.length,this.imageContainers=r(".picture")},toggleViewerVisibility:function(e){this.pictureViewer&&this.pictureViewer.length?this.pictureViewer.toggleClass("hidden"):(this.loadViewer(e),this.calculateImageData(),this.getWindowMeasurements(),this.setHeightToFillScreen())},handleResize:function(){this.getWindowMeasurements(),this.setHeightToFillScreen(),this.handleImageCalculations()},toggleViewerEvent:function(){var t=r("html"),n="picture-viewer-enable";t.hasClass(n)?(t.removeClass(n),r(this.global).off("resize",r.proxy(this.handleResize,this)),e.pubsub.emit("pictureViewer:close")):(t.addClass(n),r(this.global).on("resize",r.proxy(this.handleResize,this)),e.pubsub.emit("pictureViewer:open"))},toggleViewer:function(e){this.toggleViewerVisibility(e),this.toggleViewerEvent(),this.changeImage(),this.updatePaginationText()},handlePictureInteraction:function(){var e=r("#js-photos").attr("data-asset-id");this.pictureViewerRequested?this.toggleViewer(""):this.request(e)},createGalleryHeadline:function(e){this.pictureViewer.find(".picture__information").prepend('<h3 class="picture__headline">'+this.galleryHeadline+"</h3>")},toggleCaptionButtonText:function(){r(".picture-viewer__button--captions").find("span").toggleClass("show")},getPrevPictureNumber:function(){var e=this.numberOfImages;return 0!==this.currentPictureNumber&&(e=this.currentPictureNumber),e-1},getNextPictureNumber:function(){var e=this.currentPictureNumber+1;return this.currentPictureNumber===this.numberOfImages-1&&(e=0),e},paginate:function(e){var t="getNextPictureNumber";"left"===e&&(t="getPrevPictureNumber"),this.currentPictureNumber=this[t](),this.setHash(this.currentPictureNumber+1)},updatePaginationText:function(){r(".picture__picture-no").text(this.currentPictureNumber+1),r(".picture__picture-total").text(this.numberOfImages)},handleStats:function(t){var n=[];t.visibility&&n.push(t.visibility),r("#asset-type-pgl").length&&(n.push(-1!==t.targetClass.indexOf(t.selector)?t.position:t.defaultPosition),e.pubsub.emit(t.pubsubEvent,n))},statsBackButton:function(e){this.handleStats({position:"top",selector:"picture-viewer__button--back",defaultPosition:"bottom",pubsubEvent:"gallery:viewer:toggle",targetClass:e.target.className})},statsShowImageOnlyButton:function(){var t=this.pictureViewer.hasClass("show-image-only")?"on":"off";e.pubsub.emit("gallery:imageonly:toggle",[t])},statsCaptionButton:function(){var t=this.pictureViewer.hasClass("hide-captions")?"off":"on";e.pubsub.emit("gallery:caption:toggle",[t])},statsNavigation:function(e){this.handleStats({position:"left",selector:"picture-viewer__pagination--left",defaultPosition:"right",visibility:t.is("TouchDevice")?"off":"on",pubsubEvent:"gallery:paginate:click",targetClass:e&&e.target?e.target.className:""})},processPictureViewer:function(e,t){this.galleryHeadline=t,this.currentPictureNumber=e-1,this.handlePictureInteraction()},handlePaginateEvent:function(e,t){this.enableHiddenButtons&&(this.paginate(t),this.changeImage(),this.updatePaginationText(),this.statsNavigation(e)),this.enableHiddenButtons=!0},handleRemovalOfCoveringScreen:function(){var e=r("#js-hidegallery");e.length&&window.setTimeout(function(){e.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.remove()}),t.can("CssTransition")||e.remove(),e.addClass("hidden-content--visible")},0)},handleTurningHiddenButtonsOff:function(){this.enableHiddenButtons=!1},handleTurningHiddenButtonsOn:function(){this.enableHiddenButtons=!0},handlePictureSlidingRight:function(){this.paginate("right"),this.changeImage()},handlePictureSlidingLeft:function(){this.paginate("left"),this.changeImage()},handlePictureViewerLoaded:function(t){this.toggleViewer(t),this.createGalleryHeadline(),this.shareTools=this.pictureViewer.find(".share"),this.handleBackButtonFunctionality(),this.pictureViewer.on("click","#js-prev-picture",r.proxy(this.handleMovingToPrevPicture,this)),this.pictureViewer.on("click","#js-next-picture",r.proxy(this.handleMovingToNextPicture,this)),this.pictureViewer.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",r.proxy(this.updatePaginationText,this)),r(document).on("keydown",r.proxy(this.emitKeyEvents,this)),r(".picture-viewer__button--captions").on("click",r.proxy(this.handleTogglingCaptions,this)),r(".picture-viewer__show-image-only").on("click",r.proxy(this.handleTogglingUI,this)),r(".picture-viewer__button--grid").on("click",r.proxy(this.handleGoingBackToTheGrid,this)),r(".share__button").on("click",r.proxy(this.handleTogglingShareToolsVisibility,this)),i.find("#picture-viewer .shortenUrl").bindEvents(),e.pubsub.emit("pictureViewer:loadcomplete",[t])},emitKeyEvents:function(t){37===t.keyCode?e.pubsub.emit("key:left"):39===t.keyCode?e.pubsub.emit("key:right"):27===t.keyCode?e.pubsub.emit("key:escape"):13===t.keyCode&&e.pubsub.emit("key:enter")},handleTogglingCaptions:function(){this.shareTools.hasClass("share--visible")&&this.shareTools.hasClass("share--sliding")&&this.handleTogglingShareToolsVisibility(),this.pictureViewer.toggleClass("hide-captions"),this.toggleCaptionButtonText(),this.statsCaptionButton()},handleTogglingUI:function(){this.enableHiddenButtons&&(this.pictureViewer.toggleClass("show-image-only"),this.statsShowImageOnlyButton()),this.enableHiddenButtons=!0},handleMovingToPrevPicture:function(e){this.handlePaginateEvent(e,"left")},handleMovingToNextPicture:function(e){this.handlePaginateEvent(e,"right")},handleGoingBackToTheGrid:function(e){this.toggleViewerVisibility(),this.toggleViewerEvent(),this.setHash(""),this.statsBackButton(e)},handleBackButtonFunctionality:function(){var e=r(".picture-viewer__button--back");1===this.global.history.length?e.remove():e.on("click",r.proxy(this.goBack,this))},goBack:function(){this.global.history.back()},handleTogglingShareToolsVisibility:function(){!this.pictureViewer.hasClass("hide-captions")&&this.shareTools.hasClass("share--sliding")&&this.handleTogglingCaptions(),this.shareTools.toggleClass("share--visible")},bindEvents:function(){e.pubsub.on("gallery:picture:click",r.proxy(this.processPictureViewer,this)),e.pubsub.on("pictureViewer:open",r.proxy(this.handleRemovalOfCoveringScreen,this)),e.pubsub.on("touch:move",r.proxy(this.handleTurningHiddenButtonsOff,this)),e.pubsub.on("touch:end",r.proxy(this.handleTurningHiddenButtonsOn,this)),e.pubsub.on("touchmove:left",r.proxy(this.handlePictureSlidingRight,this)),e.pubsub.on("touchmove:right",r.proxy(this.handlePictureSlidingLeft,this)),e.pubsub.on("pictureViewer:loaded",r.proxy(this.handlePictureViewerLoaded,this)),e.pubsub.on("key:left",r.proxy(this.handleMovingToPrevPicture,this)),e.pubsub.on("key:right",r.proxy(this.handleMovingToNextPicture,this)),e.pubsub.on("key:escape",r.proxy(this.goBack,this)),e.pubsub.on("key:enter",r.proxy(this.handleTogglingCaptions,this))},setPictureClasses:function(e,t){this.imageContainers.removeClass("picture--before-current"),this.imageContainers.removeClass("picture--current"),this.imageContainers.removeClass("picture--after-current"),this.imageContainers.eq(e).addClass("picture--before-current"),this.imageContainers.eq(this.currentPictureNumber).addClass("picture--current"),this.imageContainers.eq(t).addClass("picture--after-current")},setImages:function(){var e=this.getPrevPictureNumber(),t=this.getNextPictureNumber();this.prevImage=this.images.eq(e)[0],this.image=this.images.eq(this.currentPictureNumber)[0],this.nextImage=this.images.eq(t)[0],this.setPictureClasses(e,t),this.setHash(this.currentPictureNumber+1)},changeImage:function(){this.setImages(),this.handleImageCalculations(),this.replaceDivWithImage(this.prevImage,this.getPrevPictureNumber()),this.replaceDivWithImage(this.image,this.currentPictureNumber),this.replaceDivWithImage(this.nextImage,this.getNextPictureNumber()),this.handleImageCalculations()},checkTouchSupport:function(){t.is("TouchDevice")||r("body").addClass("no-touch")},withinValidRange:function(e){return e>0&&e<=r(".photo").length},updateShareToolsUrl:function(){var e=this.stripHashCharacter();this.pictureViewer.find(".share__tool a").each(function(t,n){var o=n.href.replace(/%23$|%23\d+$|$/i,"%23"+e),i=n.getAttribute("data-target-url"),s=i?i.replace(/#$|#\d+$|$/i,"#"+e):null;n.href=o,n.setAttribute("data-target-url",s)})},stripHashCharacter:function(){return this.global.location.hash.slice(1)},checkHash:function(e){e=this.stripHashCharacter(),e=this.global.parseInt(e),this.withinValidRange(e)&&this.processPictureViewer(e,r("h1").html())},setHash:function(e){this.global.location.replace("#"+e),this.updateShareToolsUrl()},checkDevice:function(){t.is("IE10")&&r("body").addClass("ie10"),t.is("WindowsPhone")&&r("body").addClass("windows-phone")},init:function(e){this.global=e||window,this.doc=this.global.document,this.checkDevice(),this.pictureViewerRequested=!1,this.enableHiddenButtons=!0,this.currentPictureNumber=0,this.checkTouchSupport(),this.bindEvents()}};return s=n.debounce(function(){c.setImageDimensions(c.prevImage,c.calculateDimensions(c.prevImage))},100),a=n.debounce(function(){c.nextImage&&c.setImageDimensions(c.nextImage,c.calculateDimensions(c.nextImage))},100),c}),define("module/pictureGallery",["module/bootstrap","deviceInspector","vendor/lo-dash/lo-dash","module/pictureViewer"],function(e,t,n,o){var i,s=e.$,a={setConfigProperties:function(){var n=e.config.features2&&e.config.features2.rtl?"margin-right":"margin-left";this.threshold="smart"===t.getType()?150:200,this.gutter=parseInt(s(".photo").eq(0).css(n),10),this.containerWidth=s("#js-photos").width()},getImages:function(){return s(".photos img")},getListOfImageRatios:function(e){return s.map(e,function(e){return e=s(e),{element:e[0],ratio:e.attr("width")/e.attr("height")}})},addArrayElements:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},calculateRowLength:function(e){var t;return t=s.map(e,function(e){return e.ratio}),Math.ceil(this.addArrayElements(t)*this.threshold)},setRowHeight:function(e,t){s.each(e,function(e,n){s(n.element).css({height:t+"px",width:Math.floor(n.ratio*t)+"px"})})},calculateAvailableWidth:function(e){var t;return t=this.gutter*e,this.containerWidth-t},calculateRowHeight:function(e,t){return Math.floor(this.threshold/e*t)-1},processImageRowsRecursively:function(e){for(var t,n,o,i,s=1;s<=e.length;)t=this.calculateRowLength(e.slice(0,s)),n=this.calculateAvailableWidth(s),t>n&&(o=this.calculateRowHeight(t,n),i=e.splice(0,s),this.setRowHeight(i,o),this.processImageRowsRecursively(e)),s+=1;e.length&&this.setRowHeight(e,this.threshold)},calculateImages:function(){var e=this.allImages.slice(0);this.processImageRowsRecursively(e),s("#js-photos").addClass("grid-layout-complete")},storeImage:function(){a.loadedImages.push(this),e.pubsub.emit("image:stored")},processLoadedImages:function(){for(var e;e=this.loadedImages.shift();)s(e).addClass("image-loaded")},isImageCached:function(){this.complete&&s(this).trigger("load")},checkHash:function(){window.location.hash&&e.pubsub.emit("pictureGallery:hashchange",[window.location.hash])},bindEvents:function(){e.pubsub.on("image:stored",s.proxy(this.processLoadedImages,this)),e.pubsub.on("pictureGallery:hashchange",s.proxy(o.checkHash,o)),s(".photos img").one("load",a.storeImage).each(this.isImageCached),s(".photos img").on("click",function(){e.pubsub.emit("gallery:picture:click",[this.getAttribute("data-photo-no"),s("h1").html()])}),s(window).on("resize",i),e.pubsub.on("pictureViewer:open",s.proxy(function(){s(window).off("resize",i)},this)),e.pubsub.on("pictureViewer:close",s.proxy(function(){this.setConfigProperties(),this.calculateImages(this.allImages),s(window).on("resize",i)},this))},init:function(){o.init(),this.loadedImages=[],this.allImages=this.getListOfImageRatios(this.getImages()),this.imageCount=this.allImages.length,this.setConfigProperties(),this.calculateImages(),this.bindEvents(),this.checkHash()}};return i=n.debounce(function(){a.setConfigProperties(),a.calculateImages(a.allImages)},50),a}),define("module/pulseSurvey",["config"],function(e){function t(e){return 0===Math.floor(Math.random()*e)}function n(){return!!document.getElementById("bbccookies-prompt")}function o(){return 0===document.cookie.indexOf(d)||-1!==document.cookie.indexOf("; "+d)}function i(e,t){var n=document.getElementById(e);n.addEventListener?n.addEventListener("click",t,!1):n.attachEvent&&n.attachEvent("onclick",t)}function s(){var e,t=new Date;t.setDate(t.getDate()+u),e=d+"; expires="+t.toGMTString()+"; path=/"+c+"; domain=",document.cookie=e+"bbc.co.uk;",document.cookie=e+"bbc.com;"}function a(e){var t,n,o=document.createElement("div");switch(c){case"news":n=(e?p:h).replace("{siteid}",l);break;case"arabic":n=m;break;case"hausa":n=f;break;case"hindi":n=g;break;case"mundo":n=v;break;case"persian":n=b;break;case"portuguese":n=y;break;case"russian":n=w;break;case"serbian/cyr":n=_;break;case"serbian/lat":n=k;break;case"thai":n=C;break;case"turkce":n=x;break;case"zhongwen/simp":n=S;break;case"zhongwen/trad":n=T;break;case"urdu":n=P;break;default:n=E}if(t=document.getElementById("orb-pulse-tmpl").innerHTML.replace("<![CDATA[","").replace("]]>","").replace(/\{\{pulseaccepthref\}\}/g,n),o.innerHTML=t,null===document.getElementById("blq-pre-mast")){var i=document.createElement("div"),s=document.createElement("div"),a=document.getElementsByClassName("direction")[0];s.setAttribute("id","blq-global"),i.setAttribute("id","orb-pre-mast"),s.appendChild(i),a.insertBefore(s,a.firstChild),document.getElementById("orb-pre-mast").appendChild(o)}else document.getElementById("blq-pre-mast").appendChild(o)}function r(){i("pulse-reject",function(e){return e=e||window.event,s(),document.getElementById("pulse-container").style.display="none",e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1}),i("pulse-accept",function(e){return s(),!0})}var c,l=972352687,u=90,d="ckns_pulse=1",h="http://ecustomeropinions.com/survey/survey.php?sid={siteid}",p="http://www.edigitalresearch.com/test/?sid={siteid}&vault=_",m="https://www.smartsurvey.co.uk/s/YV2E7/",f="https://six.surveys.com/projects/UKC14000152M/start.asp",g="https://www.smartsurvey.co.uk/s/3I7SZ/",v="https://www.smartsurvey.co.uk/s/2Z8FY/",b="https://www.smartsurvey.co.uk/s/0KYX1/",y="https://www.smartsurvey.co.uk/s/BPRTN/",w="https://www.smartsurvey.co.uk/s/ZJO7W/",_="https://www.smartsurvey.co.uk/s/TF4PS/",k="https://www.smartsurvey.co.uk/s/F6Z37/",C="https://www.smartsurvey.co.uk/s/6BZ7X/",x="https://www.smartsurvey.co.uk/s/8NWLL/",S="https://www.smartsurvey.co.uk/s/V6G0N/",T="https://www.smartsurvey.co.uk/s/BRU7C/",P="https://www.smartsurvey.co.uk/s/2KR4X/",E="https://www.smartsurvey.co.uk/s/AERYR/";return{init:function(i,s){c="zhongwen"===i||"serbian"===i||"ukchina"===i?i+"/"+e.languageVariant:i,"getElementById"in document&&"cookie"in document&&(s.override||!o()&&!n()&&t(s.probability))&&(a(s.override),r())}}}),define("module/responsiveIframe/iframe",["module/bootstrap"],function(e){var t=e.$,n=e.pubsub;return{updateFrequency:100,createIframe:function(e){var o=location.host.match(/bbc.co.uk|bbc.com/);o&&(document.domain=o[0]);var i=t("#"+e+" a"),s=i.attr("data-iframe-src"),a=i.attr("id");this.iframe=t("<iframe>",{src:s,id:a,class:"responsive-iframe",scrolling:"no",width:"100%",height:0}).on("load",t.proxy(function(){n.emit("responsiveiframe:loaded",[a]),this.iframeBody=this.iframe.contents().find("body"),this.startWatching(),this.modifyExternalLinks()},this)),i.replaceWith(this.iframe)},startWatching:function(){window.setInterval(t.proxy(function(){this.iframe.css("height",this.iframeBody.height()+"px")},this),this.updateFrequency)},modifyExternalLinks:function(){var e=this;this.iframeBody.find("a").each(function(){var n=t(this);if(n.attr("href")){var o=decodeURIComponent(n.attr("href"));e.isExternal(o,location)&&n.attr("target","_parent")}})},isExternal:function(e,t){var n=e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/),o=!1;return("string"==typeof n[1]&&n[1].length>0&&n[1].toLowerCase()!==t.protocol||"string"==typeof n[2]&&n[2].length>0&&n[2].replace(new RegExp(":("+{"http:":80,"https:":443}[t.protocol]+")?$"),"")!==t.host)&&(o=!0),o}}}),define("module/shareTools",["module/bootstrap","deviceInspector"],function(e,t){return{init:function(){var n,o,i,s,a=e.$;"desktop"===t.getType()&&(o=a(".share"),i=this,n=a(".share__tool--facebook a",o),n.on("click",function(e){e.preventDefault(),i.openSharePopup("Facebook",n)}),s=a(".share__tool--twitter a",o),s.on("click",function(e){e.preventDefault(),i.openSharePopup("Twitter",s)}))},openSharePopup:function(e,t){"Facebook"===e?window.open(t.attr("href"),"Facebook_Share","width=650,height=280"):"Twitter"===e&&window.open(t.attr("href"),"Twitter_Share","width=550,height=420")}}}),define("module/simpleXMLHttpRequest",[],function(){return function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){n.status>=200&&n.status<400&&t(n.responseText)},n.onerror=function(){},n.send()}}),define("module/smpPreview/main",["module/components/mediaPlayer/main"],function(e){"use strict";return{init:function(t){var n=t.preview||{},o={name:"smp.plugin.preview.data",data:{numSecsToPreview:void 0===n.numSecsToPreview?6:n.numSecsToPreview,fractionInView:void 0===n.fractionInView?.5:n.fractionInView}};return e.subscribeToPlayerEvent("initialised",function(e,t){t.deviceData().device.isMobileOrTablet||t.loadPlugin({html:"name:preview.js"},o)}),!0}}}),define("module/smpPreviewAdaptor",["config","module/smpPreview/main"],function(e,t){t.init(e)}),define("module/sport/sportViewAdapter",["module/sport/sportView"],function(e){$("#comp-sport-stories").length>0&&e.init($("#comp-sport-stories"))}),define("module/stats/statsSubscriberAdapter",["module/stats/statsConfig","module/stats/statsSubscriber"],function(e,t){new t(e)}),define("module/story",["module/bootstrap","module/timestamp","module/imageenhancer","module/transclude","module/components/mediaPlayer/main","config"],function(e,t,n,o,i,s){return{init:function(){new t(new Date((new Date).toUTCString()).getTime()),new n(".story-body figure img,.story-body .HTML5figure img"),new o;e.$(".column--primary > .share--lightweight").addClass("show"),e.$(".column--primary > .share__title--lightweight").show(),i.processNewPlayers()}}}),define("module/strategiserAdaptor",["module/strategiser"],function(e){e.init()}),define("module/tableScrollAdapter",["module/tableScroll"],function(e){e.init()}),
define("module/wsojCookie",["module/cookieUtils","module/bootstrap"],function(e,t){var n={config:{cookieName:"ckpf_wsoj",expiryDays:7,defaultDataObject:{recSys:null,segment:null}},isCookieAllowed:function(){return e.cookiesEnabled()&&e.isAllowed(n.config.cookieName)},resetCookie:function(){e.removeAllFromCookie(n.config.cookieName,n.config.expiryDays)},setUserData:function(e){if(n.isValidIdentifyData(e)){var t=n.getUserData()||n.config.defaultDataObject;return n.mergeObjects(t,e),localStorage.setItem(n.getStorageId(),JSON.stringify(t))}return!1},setUserProfile:function(e){var t=n.getUserData();t&&"object"==typeof t&&(t.profile=e),n.setUserData(t)},isValidIdentifyData:function(e){return e&&"object"==typeof e&&e.hasOwnProperty("recSys")&&e.hasOwnProperty("segment")},getUserData:function(){var e=null,t=n.getStorageId();if(n.isCookieAllowed()&&n.seenBeforeTrackerExists()&&t)try{e=JSON.parse(localStorage.getItem(t))}catch(e){}return e},getStorageId:function(){return t.config.service?"wsoj."+t.config.service:null},mergeObjects:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},getCookie:function(){var t=e.readCookie(n.config.cookieName);if(""!==t&&void 0!==t&&null!==t)return Boolean(t)},setCookie:function(t){n.isCookieAllowed()&&e.setCookie(n.config.cookieName,Boolean(t),n.config.expiryDays)},seenBefore:function(){return n.getSeenBeforeStatus()},setSeenBefore:function(){var e=n.seenBeforeTrackerExists();n.setSeenBeforeStatus(e)},seenBeforeTrackerExists:function(){return!0===n.getCookie()||!1===n.getCookie()},setSeenBeforeStatus:function(e){return n.setCookie(e)},getSeenBeforeStatus:function(){if(n.seenBeforeTrackerExists())return Boolean(n.getCookie())}};return n}),define("module/components/wsoj",["module/bootstrap","module/assortedUtils","module/components/camino","module/components/caminoTracking","module/wsojCookie","module/components/optimizelyAdapter","styleguide/queryString"],function(e,t,n,o,i,s,a){var r=function(e){var t=this;this.setup(function(e){if(!e&&!n.isUserIdentified()){var s=i.getUserData();o.init(),n.setHost(t.config.caminoHost),n.setVariation(t.getVariation()),n.setSeenBefore(i.seenBefore()),n.identify(s,t.isExperiment(),function(e,o,s){if(e)return!1;o&&!s&&n.isUserIdentified()&&i.setUserData(n.user),t.fetchRecs()})}})};return r.prototype.setupDefaultConfig=function(){return this.config||(this.config={articleContainer:".story-body__inner",insertPosition:5,translations:{},variations:[],flagpoles:{mvt:!1,wsoj:!1,wsoj_service:!1},templates:{component:'<div id="comp-pattern-library" class="distinct-component-group container-parrot wsoj-component" data-variation="{{variation}}"><aside role="region" class="parrot" aria-label="{{recsTitle}}"><a class="off-screen parrot__jump-link" href="#skip-recommendations">{{skipLinkText}}</a><strong class="parrot__title">{{recsTitle}}</strong><ul role="list">{{listItems}}</ul><div class="off-screen" id="skip-recommendations" tabindex="-1">{{skipLinkFooter}}.</div></aside></div>',item:'<li role="listitem" class="parrot-item"><a class="parrot-item__link" href="{{assetUri}}"><div class="parrot-item__image-container"><img class="parrot-item__image" src="{{src}}" alt="{{shortHeadline}}"/></div><span class="parrot-item__link-text">{{shortHeadline}}</span></a></li>',css:".wsoj-component .parrot__title { margin-bottom: 0 } .wsoj-component .parrot-item { border: none; margin: 8px 0; padding: 0; } .wsoj-component .parrot-item:last-child { margin-bottom: 0; } .wsoj-component .parrot-item__link { display: flex; background: white } .wsoj-component .parrot-item__image-container { display: flex; width: 194px; flex-shrink: 0; margin: 0; align-items: flex-start; } .wsoj-component .parrot-item__image-container img { object-fit: contain } .wsoj-component .parrot-item__link-text { padding: 8px 16px; } @media (max-width: 400px) { .wsoj-component .parrot-item__image-container { width: 120px; padding: 8px; } .wsoj-component .parrot-item__link-text { padding: 8px } }"}}),this.config},r.prototype.setup=function(o){var i=this.setupDefaultConfig();try{var r=JSON.parse(e.$("meta[name=wsoj-config]").attr("data-wsoj-config"));t.deepCopy(i,r)}catch(e){return o(Error("Missing Camino configuration"))}if(s.isTestMode())s.loadFakeOptimizely(),"camino"===a.getParam("_fake")&&n.loadFakeCamino();else if(this.shouldLoadOptimizely())return s.loadOptimizely(o,this);return o?o():null},r.prototype.fetchRecs=function(){var t=this;n.fetchRecs(e.config.asset.asset_uri,function(o,s){if(o)return e.pubsub.emit("wsojcomponent:loadError"),!1;e.pubsub.emit("camino:recommendation:retrieved"),t.addRecsToPage(s),n.profileUpdated&&i.setUserProfile(n.user.profile)})},r.prototype.addRecsToPage=function(t){var o=this.generateHtmlFromRecs(t);if(o){var i="p:nth-of-type("+this.config.insertPosition+")";e.$(i,this.config.articleContainer).after(o),e.pubsub.emit("component:postloaded",{component:"wsoj",recommenderValue:n.user.recSys,userSegment:n.user.segment}),s.activateInactiveExperiments()}},r.prototype.generateHtmlFromRecs=function(e){if(!e||!Array.isArray(e)||0===e.length)return null;var t=this,n=this.generateHtmlForListItems(e);if(!n)return null;var o=this.config.templates.component;return["skipLinkLabel","skipLinkText","recsTitle","skipLinkFooter"].forEach(function(e){o=o.replace(RegExp("{{"+e+"}}","gi"),t.t(e))}.bind(this)),o=o.replace(RegExp("{{variation}}","gi"),this.getVariation()).replace(RegExp("{{listItems}}","gi"),n)},r.prototype.generateHtmlForListItems=function(e){for(var t="<style>"+this.config.templates.css+"</style>",n=this.config.templates.item,o=0;o<e.length;o++){t+=n.replace(RegExp("{{assetUri}}","gi"),e[o].assetUri).replace(RegExp("{{src}}","gi"),e[o].imageHref.replace("http://c.files.bbci.co.uk/","https://ichef.bbci.co.uk/news/270/cpsprodpb/")).replace(RegExp("{{shortHeadline}}","gi"),e[o].shortHeadline)}return t},r.prototype.t=function(e){return this.config.translations.hasOwnProperty(e)?this.config.translations[e]:null},r.prototype.shouldLoadOptimizely=function(){return!(void 0===e.config.asset||!this.config.flagpoles.mvt)&&(e.config.asset.hasOwnProperty("options")&&e.config.asset.options.allowAdvertising)},r.prototype.getVariation=function(){if(s.variationsCanBeObtained()&&"undefined"!=typeof optimizely){var t=optimizely.get("state").getExperimentStates();for(var n in t){var o=t[n]||{};if(o.hasOwnProperty("variation")&&o.variation.hasOwnProperty("name")&&("string"===e.$.type(o.variation.name)&&!o.isInExperimentHoldback)){var i=o.variation.name.toLowerCase();if(this.isValidVariation(i))return i}}}return"default-0"},r.prototype.isExperiment=function(){return"default-0"!==this.getVariation()},r.prototype.isValidVariation=function(t){return-1!==e.$.inArray(t,this.config.variations)},r.prototype.experimentIsActive=function(t){var n=optimizely.get("state").getActiveExperimentIds();return-1!==e.$.inArray(t,n)},new r}),define("vendor/locator/autoCompleteView",["module/bootstrap"],function(e){var t,n,o,i;return t=e.$,o=2,i=500,n=function(){var n=this;this.inputHasFocus=!1,this.hasMouseDown=!1,this.$searchResults=null,this.highlightedSearchResultIndex=null,this.input=document.getElementById("locator-search-input"),this.$input=t("#locator-search-input"),this.$input.attr("autocomplete","off"),this.keyCode={enter:13,escape:27,upArrow:38,downArrow:40},this.input&&(this.$input.on("focus.locatorAutoCompleteInput",function(e){n.startInteraction(),e.preventDefault()}),this.$input.on("blur.locatorAutoCompleteInput",function(e){n.hasMouseDown||n.stopInteraction(),e.preventDefault()})),e.pubsub.on("locator:autoCompleteSearchResults",function(e){n.inputHasFocus&&(n.stopWaitingForRequest(),n.renderSearchResults(e))}),e.pubsub.on("locator:renderChangePrompt",function(e){n.inputHasFocus&&(n.stopInteraction(),n.currentSearchTerm=null)}),e.pubsub.on("locator:error",function(e,t){"autocomplete"===t&&n.stopWaitingForRequest(),e&&e.flagpoles&&!e.flagpoles.autoComplete&&(n.stopInteraction(),n.$input.off("focus.locatorAutoCompleteInput"),n.$input.off("blur.locatorAutoCompleteInput"))})},n.prototype.checkInput=function(){var t,n;return t=this,n=this.prepareSearchTerm(this.input.value),this.isValidSearchTerm(n)?this.currentSearchTerm!==n&&null===this.highlightedSearchResultIndex&&(this.currentSearchTerm=n,this.clearInputChangedTimeout(),void(this.inputChangedTimeoutId=setTimeout(function(){e.pubsub.emit("locator:submitAutoCompleteSearch",[n]),t.startWaitingForRequest()},i))):(this.$searchResults&&(this.clearInputChangedTimeout(),this.clearSearchResults()),this.currentSearchTerm=n,!1)},n.prototype.prepareSearchTerm=function(e){return String(e).replace(/^\s\s*/,"").replace(/\s\s*$/,"")},n.prototype.isValidSearchTerm=function(e){var t;return"string"==typeof e&&(t=this.prepareSearchTerm(e),!!(t.length>=o))},n.prototype.renderSearchResults=function(e){var n,o,i,s;if(n=this,this.searchResultsData=e,0===(s=e.results.length))return void this.clearSearchResults();for(null===this.$searchResults&&(t("body").append('<ul id="locator-autocomplete-results"></ul>'),this.$searchResults=t("#locator-autocomplete-results"),this.$searchResults.on("mouseover","li",function(e){n.highlightSearchResultByIndex(t(this).index(),!1)}).on("mouseout","li",function(e){n.searchResultMouseOutHandler(e.target)}),this.positionSearchResults(),this.addSearchResultClickListener(),n.addSearchResultKeyHandler()),o="",i=0;i<s;i++)o+="<li>"+e.results[i].fullName+"</li>";this.$searchResults.html(o)},n.prototype.clearSearchResults=function(){this.searchResultsData=null,this.highlightedSearchResultIndex=null,this.$searchResults&&(this.$searchResults.remove(),this.$searchResults=null,this.removeSearchResultKeyHandler())},n.prototype.addSearchResultKeyHandler=function(){var e;this.removeSearchResultKeyHandler(),e=this,t(document).on("keydown.locatorAutoCompleteSearchResults",function(t){e.keyDownHandler(t)})},n.prototype.removeSearchResultKeyHandler=function(){t(document).off("keydown.locatorAutoCompleteSearchResults")},n.prototype.keyDownHandler=function(e){switch(e.keyCode){case this.keyCode.escape:this.escapeKeyHandler();break;case this.keyCode.enter:this.enterKeyHandler(e);break;case this.keyCode.upArrow:e.preventDefault(),this.highlightPrevSearchResult();break;case this.keyCode.downArrow:this.highlightNextSearchResult()}},n.prototype.escapeKeyHandler=function(){null!==this.highlightedSearchResultIndex&&this.$input.val(this.currentSearchTerm),this.clearSearchResults()},n.prototype.enterKeyHandler=function(e){null!==this.highlightedSearchResultIndex&&(e.preventDefault(),this.submitSearchResultByIndex(this.highlightedSearchResultIndex)),this.clearInputChangedTimeout(),this.clearSearchResults()},n.prototype.highlightNextSearchResult=function(){var e;if(null===(e=this.highlightedSearchResultIndex))e=0;else if(e++,this.searchResultsData.results.length<=e)return void this.removeSearchResultHighlight(!0);this.highlightSearchResultByIndex(e,!0)},n.prototype.highlightPrevSearchResult=function(){var e;if(null===(e=this.highlightedSearchResultIndex))e=this.searchResultsData.results.length-1;else if(0>--e)return void this.removeSearchResultHighlight(!0);this.highlightSearchResultByIndex(e,!0)},n.prototype.highlightSearchResultByIndex=function(e,n){var o;this.removeSearchResultHighlight(),o=this.searchResultsData.results[e],this.highlightedSearchResultIndex=e,t(this.$searchResults.find("li")[e]).addClass("active"),n&&this.$input.val(o.fullName)},n.prototype.removeSearchResultHighlight=function(e){this.highlightedSearchResultIndex=null,this.$searchResults.find("li.active").removeClass("active"),e&&this.$input.val(this.currentSearchTerm)},n.prototype.searchResultMouseOutHandler=function(e){t(e).removeClass("active")},n.prototype.addSearchResultClickListener=function(){var t;t=this,this.$searchResults.on("mousedown",function(n){t.hasMouseDown=!0,e.$("body").one("mouseup",function(e){t.bodyMouseUpHandler(e)})})},n.prototype.bodyMouseUpHandler=function(e){var n;this.hasMouseDown=!1,this.$searchResults.find(e.target).length&&(n=t(e.target).index(),this.submitSearchResultByIndex(n)),this.clearSearchResults()},n.prototype.submitSearchResultByIndex=function(t){var n;n=this.searchResultsData.results[t],this.$input.val(n.fullName),e.pubsub.emit("locator:submitAutoCompleteLocation",[n.id,n.name])},n.prototype.positionSearchResults=function(){var e;e=this.$input.offset(),this.$searchResults.css({left:parseInt(e.left,0),top:parseInt(e.top,0)+this.$input.outerHeight()})},n.prototype.startInteraction=function(){var e=this;this.inputHasFocus=!0,this.$input.on("keyup",function(){e.checkInput()})},n.prototype.stopInteraction=function(){var e;e=this.$input.val(),null!==this.highlightedSearchResultIndex&&e!==this.currentSearchTerm&&(this.currentSearchTerm=e),this.clearInputChangedTimeout(),this.clearSearchResults(),this.stopWaitingForRequest(),this.$input.off("keyup"),this.inputHasFocus=!1},n.prototype.startWaitingForRequest=function(){this.$input.addClass("waiting")},n.prototype.stopWaitingForRequest=function(){this.$input.removeClass("waiting")},n.prototype.clearInputChangedTimeout=function(){this.inputChangedTimeoutId&&(clearTimeout(this.inputChangedTimeoutId),this.inputChangedTimeoutId=null)},n}),define("vendor/locator/bootstrap",["jquery","vendor/events/pubsub"],function(e){return{pubsub:e,$:e,ajax:e.ajax}}),define("vendor/locator/locatorView",["module/bootstrap"],function(e){var t,n,o;return t="/locator/default/mobile/en-GB/confirm/",o=function(e){e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},n=function(t,n){var i=this,s='<div id="locator"><form id="locator-form" action="#">';n=n||{},void 0!==n.pubsub&&(e.pubsub=n.pubsub),this.inputPlaceholderMessage="Enter a UK town or postcode",this.autoCompleteEnabled=!1,!0===n.enableAutoComplete&&(this.autoCompleteEnabled=!0),this.supportsGeoLocation=!1,void 0!==navigator.geolocation&&!1!==n.enableReverseGeocode&&(this.geoLocationEnabled=!0,this.supportsGeoLocation=!0),this.supportsGeoLocation&&window.locator&&window.locator.disableGeoLocation&&(this.supportsGeoLocation=!1),this.supportsGeoLocation&&(s+='<a href="" id="locator-geolocation"><span class="link-text">Use my current location</span><span class="crosshair"></span></a><p id="geolocation-error"></p>'),s+='<div id="locator-search-container"><span class="locator-search-input"><label for="locator-search">Search Term</label><input id="locator-search-input" name="locator-search" type="text"/></span><input name="locator-submit" class="submit" type="submit" value="Search"/><button id="locator-submit" value="Search">Search <span class="magnifier"></span></button></div></form><p id="locator-message-search"/><ul id="locator-results"></ul><a id="locator-results-more" href="">Show More</a><a id="locator-prompt-change" href="">Change your location<span class="crosshair"></span></a></div>',e.$(t).append(s),this.elm=document.getElementById("locator"),this.form=document.getElementById("locator-form"),this.searchMessage=document.getElementById("locator-message-search"),this.changePrompt=document.getElementById("locator-prompt-change"),this.input=document.getElementById("locator-search-input"),this.results=document.getElementById("locator-results"),this.moreResults=document.getElementById("locator-results-more"),this.supportsPlaceholder=void 0!==this.input.placeholder,this.supportsPlaceholder?this.input.placeholder=this.inputPlaceholderMessage:(this.inputFocusHandler=function(e){i.inputPlaceholderMessage===i.input.value&&(i.input.value="")},this.inputBlurHandler=function(e){""===i.input.value&&(i.input.value=i.inputPlaceholderMessage)},this.createEventListener(this.input,"focus",this.inputFocusHandler,!1),this.createEventListener(this.input,"blur",this.inputBlurHandler,!1)),this.autoCompleteView=null,this.autoCompleteEnabled&&require(["locator/autoCompleteView"],function(e){i.autoCompleteView=new e}),this.geolocation=null,this.supportsGeoLocation&&(this.geolocation=e.$("#locator-geolocation")[0],this.geolocationMessage=e.$("p#geolocation-error")[0]),this.formHandler=function(e){var t=i.input.value;return 0<t.length&&(i.input.blur(),i.clearResults(),i.sendSearchData(t.toLowerCase(),0)),o(e),!1},this.createEventListener(this.form,"submit",this.formHandler,!1),this.resultsHandler=function(t){var n,s,a,r,c;return o(t),n=t.target||t.srcElement,n.blur(),s=n.href,e.$("li",this).removeClass("selected"),e.$(n).parent("li").addClass("selected"),s&&0<s.length&&(c=s.match(/confirm\/(\w{0,2}\d+)\/?(\w+)?/),3===c.length&&(r=c[2]),2<=c.length&&(a=c[1],i.sendLocationData(a,r))),!1},this.createEventListener(this.results,"click",this.resultsHandler,!1),this.moreResultsHandler=function(t){o(t),i.moreResultsEnabled&&(e.$("#locator-results-error").remove(),i.disableMoreResults(),i.sendSearchData(i.currentResults.searchTerm,i.currentResults.offset+i.currentResults.limit))},this.createEventListener(this.moreResults,"click",this.moreResultsHandler,!1),this.supportsGeoLocation&&(this.geolocationClickHandler=function(t){o(t),i.geoLocationEnabled&&(i.clearResults(),i.disableGeolocation("active"),navigator.geolocation.getCurrentPosition(function(t){e.pubsub.emit("locator:geoLocation",[t])},function(e){var t="We were unable to detect your location.";e.code===e.PERMISSION_DENIED&&(t="Please enable Location Services in your device settings or browser"),i.setMessage(i.geolocationMessage,t,"error"),i.enableGeolocation()},{enableHighAccuracy:!0,maximumAge:60,timeout:1e4}))},this.createEventListener(this.geolocation,"click",this.geolocationClickHandler,!1)),this.createEventListener(this.changePrompt,"click",function(t){e.pubsub.emit("locator:changeLocationPrompt"),i.renderForm(),o(t)},!1),e.pubsub.on("locator:searchResults",function(e){i.renderSearchResults(e)}),e.pubsub.on("locator:newsLocalRegions",function(e){i.renderNewsLocalRegions(e)}),e.pubsub.on("locator:locationOutOfContext",function(e){i.setMessage(i.searchMessage,null),i.setMessage(i.geolocationMessage,"Sorry, location setting is not available for your location","error")}),e.pubsub.on("locator:renderForm",function(){i.renderForm()}),e.pubsub.on("locator:renderChangePrompt",function(){i.renderStopWait(),i.resetForm(),i.renderChangePrompt()}),e.pubsub.on("locator:renderWait",function(){i.renderWait()}),e.pubsub.on("locator:error",function(e,t){i.renderError(e,t)})},n.prototype.sendSearchData=function(t,n){e.pubsub.emit("locator:submitSearch",[t,n])},n.prototype.sendLocationData=function(t,n){e.pubsub.emit("locator:submitLocation",[t,n])},n.prototype.close=function(){this.elm.parentNode.removeChild(this.elm)},n.prototype.clearResults=function(){this.setMessage(this.searchMessage,null),this.setMessage(this.geolocationMessage,null),this.currentResults=null,this.results.innerHTML="",this.setMoreResultsDisplay("none")},n.prototype.renderChangePrompt=function(){this.setFormIsShown(!1),this.setChangePromptIsShown(!0)},n.prototype.renderForm=function(){this.setFormIsShown(!0),this.setChangePromptIsShown(!1),this.resetForm()},n.prototype.renderGeolocationResult=function(e){var t;this.resetForm(),this.setMessage(this.searchMessage,"Your location"),t='<li class="selected"><a href="#">'+e.name+"</a></li>",this.results.innerHTML=t,this.results.display=""},n.prototype.resetForm=function(){this.input.value=this.supportsPlaceholder?"":this.inputPlaceholderMessage,this.clearResults(),this.setMessage(this.searchMessage,null),this.enableGeolocation()},n.prototype.disableForm=function(){this.destroyEventListener(this.form,"submit",this.formHandler),this.createEventListener(this.form,"submit",function(e){return o(e),!1},!1),e.$("#locator-search-container").addClass("disabled"),e.$(this.input).attr("disabled",!0)},n.prototype.setFormIsShown=function(e){var t;t=e?"block":"none",this.form.style.display=t},n.prototype.setChangePromptIsShown=function(e){this.changePrompt.style.display=e?"block":"none"},n.prototype.enableMoreResults=function(){this.moreResultsEnabled=!0,e.$(this.moreResults).removeClass("disabled")},n.prototype.disableMoreResults=function(){this.moreResultsEnabled=!1,e.$(this.moreResults).addClass("disabled")},n.prototype.enableGeolocation=function(){this.geoLocationEnabled=!0,e.$(this.geolocation).removeClass("active")},n.prototype.disableGeolocation=function(t){this.geoLocationEnabled=!1,t=t||"disabled",e.$(this.geolocation).addClass(t)},n.prototype.setMessage=function(e,t,n){e&&("string"==typeof n&&n.length>0&&(e.className=n),e.style.display=null===t||""===t?"none":"block",e.innerHTML=t)},n.prototype.setMoreResultsDisplay=function(e){e=e||"",this.moreResults.style.display=e},n.prototype.renderError=function(t,n){var o="Sorry an error has occurred, please try again";if("autocomplete"!==n&&this.renderStopWait(),t&&t.flagpoles){if(!t.flagpoles.locator)return this.clearResults(),this.disableForm(),this.disableGeolocation(),void this.setMessage(this.searchMessage,"Sorry location setting is not currently available","error");if(!t.flagpoles.reverseGeocode&&(this.disableGeolocation(),this.setMessage(this.geolocationMessage,'Sorry the "use my current location" feature is not currently available',"error"),"geolocate"===n))return}"geolocate"===n?(this.setMessage(this.geolocationMessage,"Sorry an error occurred trying to detect your location. Please try again","error"),this.enableGeolocation()):"search"===n&&this.currentResults?e.$(this.moreResults).after('<p id="locator-results-error" class="error">'+o+"</p>"):"autocomplete"!==n&&this.setMessage(this.searchMessage,o,"error")},n.prototype.renderWait=function(){this.currentResults||this.setMessage(this.searchMessage,"Please wait...")},n.prototype.renderStopWait=function(){this.currentResults||this.setMessage(this.searchMessage,null)},n.prototype.renderSearchResults=function(n){var o,i,s="",a=t,r="?ptrt="+window.location,c=!1,l="";if(this.currentResults=n,this.renderStopWait(),this.enableGeolocation(),0===n.results.length)this.setMessage(this.searchMessage,'There were no results for "'+n.searchTerm+'"');else for(this.setMessage(this.searchMessage,"Search results:"),i=0;i<n.results.length;i++)o=n.results[i],l=1===n.results.length?' class="selected"':"",s+="<li"+l+">",s+='<a href="'+a+o.id+r+'">'+o.name+"</a></li>";this.results.style.display="",0===n.offset?(this.results.innerHTML=s,this.setFocusOnFirstResult(),c=n.limit<n.total):(e.$(this.results).append(s),c=n.offset+n.limit<n.total),this.setMoreResultsDisplay(c?"block":"none"),c&&this.enableMoreResults()},n.prototype.renderNewsLocalRegions=function(e){var n,o,i="",s=t+e.location.id+"/",a="?ptrt="+window.location;for(this.renderStopWait(),this.enableGeolocation(),this.setMessage(this.searchMessage,"Your chosen location falls between two News Regions. To set your location, please select one of the regions below."),o=0;o<e.regions.length;o++)n=e.regions[o],i+='<li><a href="'+s+n.id+a+'">'+n.name+"</a></li>";this.results.style.display="",this.results.innerHTML=i,this.setFocusOnFirstResult()},n.prototype.setFocusOnFirstResult=function(){var t;t=e.$("#locator-results li a"),t.length>0&&t[0].focus()},n.prototype.createEventListener=function(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n)},n.prototype.destroyEventListener=function(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n)},n}),define("vendor/locator/stats",["istats-1"],function(e){var t,n;return t=function(e,t){n=e,"function"==typeof t&&(this.logEvent=t)},t.prototype.logEvent=function(n,o){o=o||{},o.screen=t.isMDot(document.location.hostname)?"mobile":"desktop",e.log(n,"locator",o)},t.prototype.applyEvents=function(){var e;e=this,n.on("locator:open",function(){e.logEvent("open",{supports_geolocation:void 0!==navigator.geolocation?1:0,has_locserv_cookie:t.hasLocation()})}),n.on("locator:changeLocationPrompt",function(){e.logEvent("open")}),n.on("locator:geoLocation",function(t){e.logEvent("geo_location",{latitude:t.coords.latitude,longitude:t.coords.longitude})}),n.on("locator:searchResults",function(t){var n;if(0===t.total)return void e.logEvent("no_search_results",{ns_search_term:t.searchTerm});void 0===t.offset&&(t.offset=0),void 0===t.limit&&(t.limit=10),n={ns_search_term:t.searchTerm,offset:t.offset,page_num:(t.offset+t.limit)/t.limit},n.page_num>1?e.logEvent("more_results",n):e.logEvent("search",n)}),n.on("locator:submitAutoCompleteSearch",function(t){var n;n={ns_search_term:t},e.logEvent("autocomplete_search",n)}),n.on("locator:submitAutoCompleteLocation",function(t,n){var o;o={location_id:t,location_name:n},e.logEvent("autocomplete_click",o)}),n.on("locator:error",function(){e.logEvent("http_error")}),n.on("locator:locationChanged",function(t){var n;null!==t&&(n={location_id:t.id,location_name:t.name},t.local_region&&(n.news_region=t.local_region),e.logEvent("confirm",n))}),n.on("locator:newsLocalRegions",function(t){var n,o,i;n={location_id:t.location.id,location_name:t.location.name},i=[];for(o in t.regions)t.regions.hasOwnProperty(o)&&i.push(t.regions[o].name);n.location_regions=i.join(", "),e.logEvent("news_local_regions",n)})},t.isMDot=function(e){return!!e.match(/^m\.([a-z\.]*)?bbc(\.co\.uk|\.com)$/)},t.getCookie=function(){return document.cookie},t.hasLocation=function(){var e;return!(!(e=this.getCookie().match("locserv=(.*?)(;|$)"))||e.length<2)},t});